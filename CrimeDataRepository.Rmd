---
title: "CrimeData"
author: "Steven R. Morrison"
date: "2024-07-03"
output: html_document
---

```{r setup, include=FALSE}
#Load packages
library(readxl)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(readr)
library(dplyr)
library(changepoint)
library(ggthemes)
library(stringr)
library(tibble)
library(correlation)
library(corrplot)
library(rcompanion)
library(GGally)
```

```{r}
#Generating 2022 crime counts, and then crime rates

#Import crime data: Five folders of datasets from www.icpsr.umich.edu, all entitled "National Incident-Based Reporting System 2022: Extract Files". Currently, only loading the incident-level segment (file 0003). Here, I load 2022 crime data. This data has observations for each incident in 2022, the reporting law enforcement agency, the population covered by that agency, and crime data.

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/38925-0003-Data.rda")
da2022_0003 <- da38925.0003

#Import population data from U.S. Census Bureau (https://www2.census.gov/programs-surveys/popest/datasets/), by county, with population numbers and FIPS codes. I will need to use this population data to limit my dataset to only those counties in which there is full LEA participation. I will do this by comparing the Census population with the total population calculated by adding all populations reported by LEAs. If they are within a certain range, I will assume there is full LEA participation, which means that the crime counts as reported by the LEAs are the all-county crime counts, made into crime rates with the all-county population numbers. Alternatively, I could just use the population numbers reported by NIBRS and the crime counts of participating counties. This would also be comparing apples to apples, just not getting full county coverage of data.
#Population20_22 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population20_22.xlsx")
#Population20_22 <- Population20_22 |>
  #select(-FIPScore)

#Population18_19 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population18_19.xlsx")
#Population18_19 <- Population18_19 |>
  #select(-STATE , -COUNTY)

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2022_0003_select <- da2022_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113) |>
  filter(BH040 == "12") 

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2022_0003_select$BH006 <- dmy(da2022_0003_select$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:

da2022_0003_select2 <- da2022_0003_select |>
  filter(BH006 < "2018-01-01")

da2022_0003_1 <- da2022_0003_select2 |>
  select(STATE , ORI , INCNUM , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113)

#Create new crime dataset for 2022 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )

Population <- da2022_0003_1 |>
  distinct(ORI , .keep_all = TRUE) |>
  select(ORI, BH019) |>
  rename(Population = BH019)
Incidents <- da2022_0003_1 |>
  count(ORI) |>
  rename(TotIncidents = n)
Offenses <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise(TotCrimeCount = sum(V1008))
MurderNonNegManslaughter91 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(091) Murder/Nonnegligent Manslaughter", na.rm = TRUE)) |>
  mutate(MurderNonNegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , MurderNonNegManslaughter)
NegManslaughter92 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(092) Negligent Manslaughter", na.rm = TRUE)) |>
  mutate(NegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , NegManslaughter)
JustifiableHomicide93 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(093) Justifiable Homicide", na.rm = TRUE)) |>
  mutate(JustifiableHomicide = rowSums(across(V20061:V20063))) |>
  select(ORI , JustifiableHomicide)
Kidnaping_Abduction100 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(100) Kidnaping/Abduction", na.rm = TRUE)) |>
  mutate(Kidnaping_Abduction = rowSums(across(V20061:V20063))) |>
  select(ORI , Kidnaping_Abduction)
Rape111 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(111) Rape", na.rm = TRUE)) |>
  mutate(Rape = rowSums(across(V20061:V20063))) |>
  select(ORI , Rape)
Sodomy112 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(112) Sodomy", na.rm = TRUE)) |>
  mutate(Sodomy = rowSums(across(V20061:V20063))) |>
  select(ORI , Sodomy)
SexAssaultObject113 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(113) Sexual Assault With An Object", na.rm = TRUE)) |>
  mutate(SexAssaultObject = rowSums(across(V20061:V20063))) |>
  select(ORI , SexAssaultObject)
Fondling_ChildMolest114 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(114) Fondling (Indecent Liberties/Child Molesting)", na.rm = TRUE)) |>
  mutate(Fondling_ChildMolest = rowSums(across(V20061:V20063))) |>
  select(ORI , Fondling_ChildMolest)
Robbery120 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(120) Robbery", na.rm = TRUE)) |>
  mutate(Robbery = rowSums(across(V20061:V20063))) |>
  select(ORI , Robbery)
AggAssault131 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(131) Aggravated Assault", na.rm = TRUE)) |>
  mutate(AggAssault = rowSums(across(V20061:V20063))) |>
  select(ORI , AggAssault)
SimpleAssault132 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(132) Simple Assault", na.rm = TRUE)) |>
  mutate(TotSimpleAssaults = rowSums(across(V20061:V20063))) |>
  select(ORI , TotSimpleAssaults)
Intimidation133 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(133) Intimidation", na.rm = TRUE)) |>
  mutate(Intimidation = rowSums(across(V20061:V20063))) |>
  select(ORI , Intimidation)
#Arson200 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(200) Arson", na.rm = TRUE)) |>
  #mutate(Arson = rowSums(across(V20061:V20063))) |>
  #select(ORI , Arson)
#ExtortionBlackmail210 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(210) Extortion/Blackmail", na.rm = TRUE)) |>
  #mutate(ExtortionBlackmail = rowSums(across(V20061:V20063))) |>
  #select(ORI , ExtortionBlackmail)
BurglaryBreakingEntering220 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(220) Burglary/Breaking and Entering", na.rm = TRUE)) |>
  mutate(BurglaryBreakingEntering = rowSums(across(V20061:V20063))) |>
  select(ORI , BurglaryBreakingEntering)
PocketPicking231 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(231) Pocket-picking", na.rm = TRUE)) |>
  mutate(PocketPicking = rowSums(across(V20061:V20063))) |>
  select(ORI , PocketPicking)
PurseSnatching232 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(232) Purse-snatching", na.rm = TRUE)) |>
  mutate(PurseSnatching = rowSums(across(V20061:V20063))) |>
  select(ORI , PurseSnatching)
Shoplifting233 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(233) Shoplifting", na.rm = TRUE)) |>
  mutate(Shoplifting = rowSums(across(V20061:V20063))) |>
  select(ORI , Shoplifting)
TheftFromBuilding234 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(234) Theft From Building", na.rm = TRUE)) |>
  mutate(TheftFromBuilding = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromBuilding)
TheftMachineDevice235 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(235) Theft From Coin-Operated Machine or Device", na.rm = TRUE)) |>
  mutate(TheftMachineDevice = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftMachineDevice)
TheftFromVehicle236 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(236) Theft From Motor Vehicle", na.rm = TRUE)) |>
  mutate(TheftFromVehicle = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromVehicle)
TheftOfVehicleOrParts237 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(237) Theft of Motor Vehicle Parts/Accessories", na.rm = TRUE)) |>
  mutate(TheftOfVehicleOrParts = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftOfVehicleOrParts)
AllOtherLarceny238 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(238) All Other Larceny", na.rm = TRUE)) |>
  mutate(AllOtherLarceny = rowSums(across(V20061:V20063))) |>
  select(ORI , AllOtherLarceny)
VehicleTheft240 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(240) Motor Vehicle Theft", na.rm = TRUE)) |>
  mutate(VehicleTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , VehicleTheft)
CounterfeitingForgery250 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(250) Counterfeiting/Forgery", na.rm = TRUE)) |>
  mutate(CounterfeitingForgery = rowSums(across(V20061:V20063))) |>
  select(ORI , CounterfeitingForgery)
SwindleConGame261 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(261) False Pretenses/Swindle/Confidence Game", na.rm = TRUE)) |>
  mutate(SwindleConGame = rowSums(across(V20061:V20063))) |>
  select(ORI , SwindleConGame)
CC_ATMFraud262 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(262) Credit Card/Automatic Teller Machine Fraud", na.rm = TRUE)) |>
  mutate(CC_ATMFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , CC_ATMFraud)
Impersonation263 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(263) Impersonation", na.rm = TRUE)) |>
  mutate(Impersonation = rowSums(across(V20061:V20063))) |>
  select(ORI , Impersonation)
WelfareFraud264 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(264) Welfare Fraud", na.rm = TRUE)) |>
  mutate(WelfareFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , WelfareFraud)
#WireFraud265 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(265) Wire Fraud", na.rm = TRUE)) |>
  #mutate(WireFraud = rowSums(across(V20061:V20063))) |>
  #select(ORI , WireFraud)
IdentityTheft266 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(266) Identity Theft", na.rm = TRUE)) |>
  mutate(IdentityTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , IdentityTheft)
HackingComputerInvasion267 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(267) Hacking/Computer Invasion", na.rm = TRUE)) |>
  mutate(HackingComputerInvasion = rowSums(across(V20061:V20063))) |>
  select(ORI , HackingComputerInvasion)
Embezzlement270 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(270) Embezzlement", na.rm = TRUE)) |>
  mutate(Embezzlement = rowSums(across(V20061:V20063))) |>
  select(ORI , Embezzlement)
StolenPropertyOffenses280 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(280) Stolen Property Offenses", na.rm = TRUE)) |>
  mutate(StolenPropertyOffenses = rowSums(across(V20061:V20063))) |>
  select(ORI , StolenPropertyOffenses)
DamageVandalismOfProperty290 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(290) Destruction/Damage/Vandalism of Property", na.rm = TRUE)) |>
  mutate(DamageVandalismOfProperty = rowSums(across(V20061:V20063))) |>
  select(ORI , DamageVandalismOfProperty)
DrugViolations351 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(351) Drug/Narcotic Violations", na.rm = TRUE)) |>
  mutate(DrugViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugViolations)
DrugEquipmentViolations352 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(352) Drug Equipment Violations", na.rm = TRUE)) |>
  mutate(DrugEquipmentViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugEquipmentViolations)
#Incest361 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(361) Incest", na.rm = TRUE)) |>
  #mutate(Incest = rowSums(across(V20061:V20063))) |>
  #select(ORI , Incest)
#StatRape362 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(362) Statutory Rape", na.rm = TRUE)) |>
  #mutate(StatRape = rowSums(across(V20061:V20063))) |>
  #select(ORI , StatRape)
#Pornography370 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(370) Pornography/Obscene Material", na.rm = TRUE)) |>
  #mutate(Pornography = rowSums(across(V20061:V20063))) |>
  #select(ORI , Pornography)
#BettingWagering391 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(391) Betting/Wagering", na.rm = TRUE)) |>
  #mutate(BettingWagering = rowSums(across(V20061:V20063))) |>
  #select(ORI , BettingWagering)
#AssistingGambling392 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(392) Operating/Promoting/Assisting Gambling", na.rm = TRUE)) |>
  #mutate(AssistingGambling = rowSums(across(V20061:V20063))) |>
  #select(ORI , AssistingGambling)
#GamblingEquipmentViols393 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(393) Gambling Equipment Violations", na.rm = TRUE)) |>
  #mutate(GamblingEquipmentViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , GamblingEquipmentViols)
#SportsTampering394 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(394) Sports Tampering", na.rm = TRUE)) |>
  #mutate(SportsTampering = rowSums(across(V20061:V20063))) |>
  #select(ORI , SportsTampering)
Prostitution401 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(401) Prostitution", na.rm = TRUE)) |>
  mutate(Prostitution = rowSums(across(V20061:V20063))) |>
  select(ORI , Prostitution)
AssistPromoteProstitution402 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(402) Assisting or Promoting Prostitution", na.rm = TRUE)) |>
  mutate(AssistPromoteProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , AssistPromoteProstitution)
PurchaseProstitution403 <- da2022_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(403) Purchasing Prostitution", na.rm = TRUE)) |>
  mutate(PurchaseProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , PurchaseProstitution)
#Bribery510 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(510) Bribery", na.rm = TRUE)) |>
  #mutate(Bribery = rowSums(across(V20061:V20063))) |>
  #select(ORI , Bribery)
#WeaponViols520 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(520) Weapon Law Violations", na.rm = TRUE)) |>
  #mutate(WeaponViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , WeaponViols)
#HumanSexTrafficking641 <- da2022_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(641) Human Trafficking- Commercial Sex Acts", na.rm = TRUE)) |>
  #mutate(HumanSexTrafficking = rowSums(across(V20061:V20063))) |>
  #select(ORI , HumanSexTrafficking)

#Create a data.frame that is a collection of all crime counts:
CrimeSummary2022 <- 
  cbind(Population, Incidents , Offenses , MurderNonNegManslaughter91 , NegManslaughter92 , JustifiableHomicide93 , Kidnaping_Abduction100 , Rape111 , Sodomy112 , SexAssaultObject113  , Fondling_ChildMolest114 , Robbery120 , AggAssault131 , SimpleAssault132 , Intimidation133, BurglaryBreakingEntering220, PocketPicking231 , PurseSnatching232, Shoplifting233 , TheftFromBuilding234 , TheftMachineDevice235 , TheftFromVehicle236 , TheftOfVehicleOrParts237 , AllOtherLarceny238 , VehicleTheft240 , CounterfeitingForgery250 , SwindleConGame261 , CC_ATMFraud262 , Impersonation263 , WelfareFraud264 , IdentityTheft266 , HackingComputerInvasion267, Embezzlement270 , StolenPropertyOffenses280, DamageVandalismOfProperty290 , DrugViolations351 , DrugEquipmentViolations352 , Prostitution401 , AssistPromoteProstitution402, PurchaseProstitution403)

#Save this data.frame
save(CrimeSummary2022 , file = load())

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeSummary2022_1 <- CrimeSummary2022 |>
  select(Population, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeSummary2022_2 <- CrimeSummary2022_1 |>
  cbind(Incidents)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeSummary2022_3 <- CrimeSummary2022_2 |>
  relocate(TotIncidents , .before = TotCrimeCount) |>
  relocate(ORI , .before = TotIncidents)

#Save this data.frame
save(CrimeSummary2022_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/CrimeSummary2022_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2019_crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001
 
#Insert FIPS value and place it at the front of the data.frame
CrimeSummary2022_4 <-
  left_join(CrimeSummary2022_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeSummary2022_5 <- CrimeSummary2022_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeSummary2022_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/CrimeSummary2022_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total populations and crime counts for all law enforcement agencies reporting in any particular county. So, assuming the data is accurate, if all LEAs in a county reported, I would get a count of all crimes in that county and the county's population. If not all LEAs in a county reported, I would get a count of all crimes and the population within the coverage area of the reporting LEAs.
CrimeCount2022 <- CrimeSummary2022_5 |>
  group_by(FIPS) |>
  summarise_at(vars(Population , TotIncidents:PurchaseProstitution) , list(sum))

save(CrimeCount2022 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/CrimeCount2022.Rda")

#Load and view 2022 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/CrimeCount2022.Rda")
View(CrimeCount2022)

#Transform Crime2022, which has crime counts, into Crime2022, which will have crime rates (i.e. crime counts / population):
Crime2022 <- CrimeCount2022 |>
  transform(TotIncidents, TotIncidents = TotIncidents / Population) |>
  transform(TotCrimeCount, TotCrimeCount = TotCrimeCount / Population) |>
  transform(MurderNonNegManslaughter, MurderNonNegManslaughter = MurderNonNegManslaughter / Population) |>
  transform(NegManslaughter , NegManslaughter = NegManslaughter / Population) |>
  transform(JustifiableHomicide , JustifiableHomicide = JustifiableHomicide / Population) |>
  transform(Kidnaping_Abduction , Kidnaping_Abduction = Kidnaping_Abduction / Population) |>
  transform(Rape , Rape = Rape / Population) |>
  transform(Sodomy , Sodomy = Sodomy / Population) |>
  transform(SexAssaultObject , SexAssaultObject = SexAssaultObject / Population) |>
  transform(Fondling_ChildMolest , Fondling_ChildMolest = Fondling_ChildMolest / Population) |>
  transform(Robbery , Robbery = Robbery / Population) |>
  transform(AggAssault , AggAssault = AggAssault / Population) |>
  transform(TotSimpleAssaults , TotSimpleAssaults = TotSimpleAssaults / Population) |>
  transform(Intimidation , Intimidation = Intimidation / Population) |>
  transform(BurglaryBreakingEntering , BurglaryBreakingEntering = BurglaryBreakingEntering / Population) |>
  transform(PocketPicking , PocketPicking = PocketPicking / Population) |>
  transform(PurseSnatching , PurseSnatching = PurseSnatching / Population) |>
  transform(Shoplifting , Shoplifting = Shoplifting / Population) |>
  transform(TheftFromBuilding , TheftFromBuilding = TheftFromBuilding / Population) |>
  transform(TheftMachineDevice , TheftMachineDevice = TheftMachineDevice / Population) |>
  transform(TheftFromVehicle , TheftFromVehicle = TheftFromVehicle / Population) |>
  transform(TheftOfVehicleOrParts , TheftOfVehicleOrParts = TheftOfVehicleOrParts / Population) |>
  transform(AllOtherLarceny , AllOtherLarceny = AllOtherLarceny / Population) |>
  transform(VehicleTheft , VehicleTheft = VehicleTheft / Population) |>
  transform(CounterfeitingForgery , CounterfeitingForgery = CounterfeitingForgery / Population) |>
  transform(SwindleConGame , SwindleConGame = SwindleConGame / Population) |>
  transform(CC_ATMFraud , CC_ATMFraud = CC_ATMFraud / Population) |>
  transform(Impersonation , Impersonation = Impersonation / Population) |>
  transform(WelfareFraud , WelfareFraud = WelfareFraud / Population) |>
  transform(IdentityTheft , IdentityTheft = IdentityTheft / Population) |>
  transform(HackingComputerInvasion , HackingComputerInvasion = HackingComputerInvasion / Population) |>
  transform(Embezzlement , Embezzlement = Embezzlement / Population) |>
  transform(StolenPropertyOffenses , StolenPropertyOffenses = StolenPropertyOffenses / Population) |>
  transform(DamageVandalismOfProperty , DamageVandalismOfProperty = DamageVandalismOfProperty / Population) |>
  transform(DrugViolations , DrugViolations = DrugViolations / Population) |>
  transform(DrugEquipmentViolations , DrugEquipmentViolations = DrugEquipmentViolations / Population) |>
  transform(Prostitution , Prostitution = Prostitution / Population) |>
  transform(AssistPromoteProstitution , AssistPromoteProstitution = AssistPromoteProstitution / Population) |>
  transform(PurchaseProstitution , PurchaseProstitution = PurchaseProstitution / Population)

Crime2022 <- Crime2022 |>
  select(FIPS, Population, TotIncidents, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution) |>
  filter(Population != "0")

save(Crime2022 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/Crime2022.Rda")

#The resulting Crime2022 dataset contains crime rates at the "pseudo-county" level, which means this: I took all LEAs that adopted NIBRS prior to 2018 and reported to NIBRS in all 12 months of 2022, summed their absolute crime counts in various categories of crime, summed those sums by county, and had as a result one number as an absolute crime count for various crime types which is the number of those crimes/incidents that were reported by all LEAs that reported to NIBRS in a particular county. I then took "Current Population 1" as the population reported by the reporting LEAs. I assume that this population number is the population covered by the reporting LEA; I am trying to confirm this, but haven't been able to do so yet. I then divided the crime counts by population to get a crime rate: for example, 10 incidents in a population of 100 would yield an incident rate of .10. These crime rates are the rates of crime within the jurisdiction of all reporting LEAs, gathered at the county level. Some counties have all of their LEAs reporting, so that my crime rates = the crime rate for the entire county. Other counties only have some of their LEAs reporting, so that my crime rates are a subset of county crime rates--thus my data is at the "pseudo-county" level. Does this data gathering imply bias? If LEAs are more or less likely to report to NIBRS based on whether they have a high or low crime rate, then the answer may be yes. The remedy is to consider data only from counties in which all LEAs reported, making my crime rate = the county's crime rate. But the same bias would exist here, the question just wouldn't be whether *LEAs* are more or less likely to report based on whether they have a high or low crime rate, but whether *counties* as a whole are similarly more or less likely to report.
```

```{r}
#Generating 2021 crime counts, and then crime rates

#Import crime data: Five folders of datasets from www.icpsr.umich.edu, all entitled "National Incident-Based Reporting System [YEAR]: Extract Files". Currently, only loading the incident-level segment (file 0003). Here, I load 2021 crime data. This data has observations for each incident in 2021, the reporting law enforcement agency, the population covered by that agency, and crime data.

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/38807-0003-Data.rda")
da2021_0003 <- da38807.0003

#Import population data from U.S. Census Bureau (https://www2.census.gov/programs-surveys/popest/datasets/), by county, with population numbers and FIPS codes. I will need to use this population data to limit my dataset to only those counties in which there is full LEA participation. I will do this by comparing the Census population with the total population calculated by adding all populations reported by LEAs. If they are within a certain range, I will assume there is full LEA participation, which means that the crime counts as reported by the LEAs are the all-county crime counts, made into crime rates with the all-county population numbers. Alternatively, I could just use the population numbers reported by NIBRS and the crime counts of participating counties. This would also be comparing apples to apples, just not getting full county coverage of data.
#Population20_22 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population20_22.xlsx")
#Population20_22 <- Population20_22 |>
  #select(-FIPScore)

#Population18_19 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population18_19.xlsx")
#Population18_19 <- Population18_19 |>
  #select(-STATE , -COUNTY)

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2021_0003_select <- da2021_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113) |>
  filter(BH040 == "12")

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2021_0003_select$BH006 <- dmy(da2021_0003_select$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:
da2021_0003_select2 <- da2021_0003_select |>
  filter(BH006 < "2018-01-01")

da2021_0003_1 <- da2021_0003_select2 |>
  select(STATE , ORI , INCNUM , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113)

#Create new crime dataset for 2021 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )

Population <- da2021_0003_1 |>
  distinct(ORI , .keep_all = TRUE) |>
  select(ORI, BH019) |>
  rename(Population = BH019)
Incidents <- da2021_0003_1 |>
  count(ORI) |>
  rename(TotIncidents = n)
Offenses <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise(TotCrimeCount = sum(V1008))
MurderNonNegManslaughter91 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(091) Murder/Nonnegligent Manslaughter", na.rm = TRUE)) |>
  mutate(MurderNonNegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , MurderNonNegManslaughter)
NegManslaughter92 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(092) Negligent Manslaughter", na.rm = TRUE)) |>
  mutate(NegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , NegManslaughter)
JustifiableHomicide93 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(093) Justifiable Homicide", na.rm = TRUE)) |>
  mutate(JustifiableHomicide = rowSums(across(V20061:V20063))) |>
  select(ORI , JustifiableHomicide)
Kidnaping_Abduction100 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(100) Kidnaping/Abduction", na.rm = TRUE)) |>
  mutate(Kidnaping_Abduction = rowSums(across(V20061:V20063))) |>
  select(ORI , Kidnaping_Abduction)
Rape111 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(111) Rape", na.rm = TRUE)) |>
  mutate(Rape = rowSums(across(V20061:V20063))) |>
  select(ORI , Rape)
Sodomy112 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(112) Sodomy", na.rm = TRUE)) |>
  mutate(Sodomy = rowSums(across(V20061:V20063))) |>
  select(ORI , Sodomy)
SexAssaultObject113 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(113) Sexual Assault With An Object", na.rm = TRUE)) |>
  mutate(SexAssaultObject = rowSums(across(V20061:V20063))) |>
  select(ORI , SexAssaultObject)
Fondling_ChildMolest114 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(114) Fondling (Indecent Liberties/Child Molesting)", na.rm = TRUE)) |>
  mutate(Fondling_ChildMolest = rowSums(across(V20061:V20063))) |>
  select(ORI , Fondling_ChildMolest)
Robbery120 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(120) Robbery", na.rm = TRUE)) |>
  mutate(Robbery = rowSums(across(V20061:V20063))) |>
  select(ORI , Robbery)
AggAssault131 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(131) Aggravated Assault", na.rm = TRUE)) |>
  mutate(AggAssault = rowSums(across(V20061:V20063))) |>
  select(ORI , AggAssault)
SimpleAssault132 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(132) Simple Assault", na.rm = TRUE)) |>
  mutate(TotSimpleAssaults = rowSums(across(V20061:V20063))) |>
  select(ORI , TotSimpleAssaults)
Intimidation133 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(133) Intimidation", na.rm = TRUE)) |>
  mutate(Intimidation = rowSums(across(V20061:V20063))) |>
  select(ORI , Intimidation)
#Arson200 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(200) Arson", na.rm = TRUE)) |>
  #mutate(Arson = rowSums(across(V20061:V20063))) |>
  #select(ORI , Arson)
#ExtortionBlackmail210 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(210) Extortion/Blackmail", na.rm = TRUE)) |>
  #mutate(ExtortionBlackmail = rowSums(across(V20061:V20063))) |>
  #select(ORI , ExtortionBlackmail)
BurglaryBreakingEntering220 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(220) Burglary/Breaking and Entering", na.rm = TRUE)) |>
  mutate(BurglaryBreakingEntering = rowSums(across(V20061:V20063))) |>
  select(ORI , BurglaryBreakingEntering)
PocketPicking231 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(231) Pocket-picking", na.rm = TRUE)) |>
  mutate(PocketPicking = rowSums(across(V20061:V20063))) |>
  select(ORI , PocketPicking)
PurseSnatching232 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(232) Purse-snatching", na.rm = TRUE)) |>
  mutate(PurseSnatching = rowSums(across(V20061:V20063))) |>
  select(ORI , PurseSnatching)
Shoplifting233 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(233) Shoplifting", na.rm = TRUE)) |>
  mutate(Shoplifting = rowSums(across(V20061:V20063))) |>
  select(ORI , Shoplifting)
TheftFromBuilding234 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(234) Theft From Building", na.rm = TRUE)) |>
  mutate(TheftFromBuilding = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromBuilding)
TheftMachineDevice235 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(235) Theft From Coin-Operated Machine or Device", na.rm = TRUE)) |>
  mutate(TheftMachineDevice = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftMachineDevice)
TheftFromVehicle236 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(236) Theft From Motor Vehicle", na.rm = TRUE)) |>
  mutate(TheftFromVehicle = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromVehicle)
TheftOfVehicleOrParts237 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(237) Theft of Motor Vehicle Parts/Accessories", na.rm = TRUE)) |>
  mutate(TheftOfVehicleOrParts = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftOfVehicleOrParts)
AllOtherLarceny238 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(238) All Other Larceny", na.rm = TRUE)) |>
  mutate(AllOtherLarceny = rowSums(across(V20061:V20063))) |>
  select(ORI , AllOtherLarceny)
VehicleTheft240 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(240) Motor Vehicle Theft", na.rm = TRUE)) |>
  mutate(VehicleTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , VehicleTheft)
CounterfeitingForgery250 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(250) Counterfeiting/Forgery", na.rm = TRUE)) |>
  mutate(CounterfeitingForgery = rowSums(across(V20061:V20063))) |>
  select(ORI , CounterfeitingForgery)
SwindleConGame261 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(261) False Pretenses/Swindle/Confidence Game", na.rm = TRUE)) |>
  mutate(SwindleConGame = rowSums(across(V20061:V20063))) |>
  select(ORI , SwindleConGame)
CC_ATMFraud262 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(262) Credit Card/Automatic Teller Machine Fraud", na.rm = TRUE)) |>
  mutate(CC_ATMFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , CC_ATMFraud)
Impersonation263 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(263) Impersonation", na.rm = TRUE)) |>
  mutate(Impersonation = rowSums(across(V20061:V20063))) |>
  select(ORI , Impersonation)
WelfareFraud264 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(264) Welfare Fraud", na.rm = TRUE)) |>
  mutate(WelfareFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , WelfareFraud)
#WireFraud265 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(265) Wire Fraud", na.rm = TRUE)) |>
  #mutate(WireFraud = rowSums(across(V20061:V20063))) |>
  #select(ORI , WireFraud)
IdentityTheft266 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(266) Identity Theft", na.rm = TRUE)) |>
  mutate(IdentityTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , IdentityTheft)
HackingComputerInvasion267 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(267) Hacking/Computer Invasion", na.rm = TRUE)) |>
  mutate(HackingComputerInvasion = rowSums(across(V20061:V20063))) |>
  select(ORI , HackingComputerInvasion)
Embezzlement270 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(270) Embezzlement", na.rm = TRUE)) |>
  mutate(Embezzlement = rowSums(across(V20061:V20063))) |>
  select(ORI , Embezzlement)
StolenPropertyOffenses280 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(280) Stolen Property Offenses", na.rm = TRUE)) |>
  mutate(StolenPropertyOffenses = rowSums(across(V20061:V20063))) |>
  select(ORI , StolenPropertyOffenses)
DamageVandalismOfProperty290 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(290) Destruction/Damage/Vandalism of Property", na.rm = TRUE)) |>
  mutate(DamageVandalismOfProperty = rowSums(across(V20061:V20063))) |>
  select(ORI , DamageVandalismOfProperty)
DrugViolations351 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(351) Drug/Narcotic Violations", na.rm = TRUE)) |>
  mutate(DrugViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugViolations)
DrugEquipmentViolations352 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(352) Drug Equipment Violations", na.rm = TRUE)) |>
  mutate(DrugEquipmentViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugEquipmentViolations)
#Incest361 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(361) Incest", na.rm = TRUE)) |>
  #mutate(Incest = rowSums(across(V20061:V20063))) |>
  #select(ORI , Incest)
#StatRape362 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(362) Statutory Rape", na.rm = TRUE)) |>
  #mutate(StatRape = rowSums(across(V20061:V20063))) |>
  #select(ORI , StatRape)
#Pornography370 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(370) Pornography/Obscene Material", na.rm = TRUE)) |>
  #mutate(Pornography = rowSums(across(V20061:V20063))) |>
  #select(ORI , Pornography)
#BettingWagering391 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(391) Betting/Wagering", na.rm = TRUE)) |>
  #mutate(BettingWagering = rowSums(across(V20061:V20063))) |>
  #select(ORI , BettingWagering)
#AssistingGambling392 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(392) Operating/Promoting/Assisting Gambling", na.rm = TRUE)) |>
  #mutate(AssistingGambling = rowSums(across(V20061:V20063))) |>
  #select(ORI , AssistingGambling)
#GamblingEquipmentViols393 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(393) Gambling Equipment Violations", na.rm = TRUE)) |>
  #mutate(GamblingEquipmentViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , GamblingEquipmentViols)
#SportsTampering394 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(394) Sports Tampering", na.rm = TRUE)) |>
  #mutate(SportsTampering = rowSums(across(V20061:V20063))) |>
  #select(ORI , SportsTampering)
Prostitution401 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(401) Prostitution", na.rm = TRUE)) |>
  mutate(Prostitution = rowSums(across(V20061:V20063))) |>
  select(ORI , Prostitution)
AssistPromoteProstitution402 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(402) Assisting or Promoting Prostitution", na.rm = TRUE)) |>
  mutate(AssistPromoteProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , AssistPromoteProstitution)
PurchaseProstitution403 <- da2021_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(403) Purchasing Prostitution", na.rm = TRUE)) |>
  mutate(PurchaseProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , PurchaseProstitution)
#Bribery510 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(510) Bribery", na.rm = TRUE)) |>
  #mutate(Bribery = rowSums(across(V20061:V20063))) |>
  #select(ORI , Bribery)
#WeaponViols520 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(520) Weapon Law Violations", na.rm = TRUE)) |>
  #mutate(WeaponViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , WeaponViols)
#HumanSexTrafficking641 <- da2021_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(641) Human Trafficking- Commercial Sex Acts", na.rm = TRUE)) |>
  #mutate(HumanSexTrafficking = rowSums(across(V20061:V20063))) |>
  #select(ORI , HumanSexTrafficking)

#Create a data.frame that is a collection of all crime counts:
CrimeSummary2021 <- 
  cbind(Population, Incidents , Offenses , MurderNonNegManslaughter91 , NegManslaughter92 , JustifiableHomicide93 , Kidnaping_Abduction100 , Rape111 , Sodomy112 , SexAssaultObject113  , Fondling_ChildMolest114 , Robbery120 , AggAssault131 , SimpleAssault132 , Intimidation133, BurglaryBreakingEntering220, PocketPicking231 , PurseSnatching232, Shoplifting233 , TheftFromBuilding234 , TheftMachineDevice235 , TheftFromVehicle236 , TheftOfVehicleOrParts237 , AllOtherLarceny238 , VehicleTheft240 , CounterfeitingForgery250 , SwindleConGame261 , CC_ATMFraud262 , Impersonation263 , WelfareFraud264 , IdentityTheft266 , HackingComputerInvasion267, Embezzlement270 , StolenPropertyOffenses280, DamageVandalismOfProperty290 , DrugViolations351 , DrugEquipmentViolations352 , Prostitution401 , AssistPromoteProstitution402, PurchaseProstitution403)

#Save this data.frame
save(CrimeSummary2021 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeSummary2021.Rda")

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeSummary2021_1 <- CrimeSummary2021 |>
  select(Population, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeSummary2021_2 <- CrimeSummary2021_1 |>
  cbind(Incidents)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeSummary2021_3 <- CrimeSummary2021_2 |>
  relocate(TotIncidents , .before = TotCrimeCount) |>
  relocate(ORI , .before = TotIncidents)

#Save this data.frame
save(CrimeSummary2021_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeSummary2021_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2019_crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001
 
#Insert FIPS value and place it at the front of the data.frame
CrimeSummary2021_4 <-
  left_join(CrimeSummary2021_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeSummary2021_5 <- CrimeSummary2021_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeSummary2021_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeSummary2021_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total populations and crime counts for all law enforcement agencies reporting in any particular county. So, assuming the data is accurate, if all LEAs in a county reported, I would get a count of all crimes in that county and the county's population. If not all LEAs in a county reported, I would get a count of all crimes and the population within the coverage area of the reporting LEAs.
CrimeCount2021 <- CrimeSummary2021_5 |>
  group_by(FIPS) |>
  summarise_at(vars(Population , TotIncidents:PurchaseProstitution) , list(sum))

save(CrimeCount2021 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeCount2021.Rda")

#Load and view 2021 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeCount2021.Rda")
View(CrimeCount2021)

#Transform Crime2021, which has crime counts, into Crime2021, which will have crime rates (i.e. crime counts / population):
Crime2021 <- CrimeCount2021 |>
  transform(TotIncidents, TotIncidents = TotIncidents / Population) |>
  transform(TotCrimeCount, TotCrimeCount = TotCrimeCount / Population) |>
  transform(MurderNonNegManslaughter, MurderNonNegManslaughter = MurderNonNegManslaughter / Population) |>
  transform(NegManslaughter , NegManslaughter = NegManslaughter / Population) |>
  transform(JustifiableHomicide , JustifiableHomicide = JustifiableHomicide / Population) |>
  transform(Kidnaping_Abduction , Kidnaping_Abduction = Kidnaping_Abduction / Population) |>
  transform(Rape , Rape = Rape / Population) |>
  transform(Sodomy , Sodomy = Sodomy / Population) |>
  transform(SexAssaultObject , SexAssaultObject = SexAssaultObject / Population) |>
  transform(Fondling_ChildMolest , Fondling_ChildMolest = Fondling_ChildMolest / Population) |>
  transform(Robbery , Robbery = Robbery / Population) |>
  transform(AggAssault , AggAssault = AggAssault / Population) |>
  transform(TotSimpleAssaults , TotSimpleAssaults = TotSimpleAssaults / Population) |>
  transform(Intimidation , Intimidation = Intimidation / Population) |>
  transform(BurglaryBreakingEntering , BurglaryBreakingEntering = BurglaryBreakingEntering / Population) |>
  transform(PocketPicking , PocketPicking = PocketPicking / Population) |>
  transform(PurseSnatching , PurseSnatching = PurseSnatching / Population) |>
  transform(Shoplifting , Shoplifting = Shoplifting / Population) |>
  transform(TheftFromBuilding , TheftFromBuilding = TheftFromBuilding / Population) |>
  transform(TheftMachineDevice , TheftMachineDevice = TheftMachineDevice / Population) |>
  transform(TheftFromVehicle , TheftFromVehicle = TheftFromVehicle / Population) |>
  transform(TheftOfVehicleOrParts , TheftOfVehicleOrParts = TheftOfVehicleOrParts / Population) |>
  transform(AllOtherLarceny , AllOtherLarceny = AllOtherLarceny / Population) |>
  transform(VehicleTheft , VehicleTheft = VehicleTheft / Population) |>
  transform(CounterfeitingForgery , CounterfeitingForgery = CounterfeitingForgery / Population) |>
  transform(SwindleConGame , SwindleConGame = SwindleConGame / Population) |>
  transform(CC_ATMFraud , CC_ATMFraud = CC_ATMFraud / Population) |>
  transform(Impersonation , Impersonation = Impersonation / Population) |>
  transform(WelfareFraud , WelfareFraud = WelfareFraud / Population) |>
  transform(IdentityTheft , IdentityTheft = IdentityTheft / Population) |>
  transform(HackingComputerInvasion , HackingComputerInvasion = HackingComputerInvasion / Population) |>
  transform(Embezzlement , Embezzlement = Embezzlement / Population) |>
  transform(StolenPropertyOffenses , StolenPropertyOffenses = StolenPropertyOffenses / Population) |>
  transform(DamageVandalismOfProperty , DamageVandalismOfProperty = DamageVandalismOfProperty / Population) |>
  transform(DrugViolations , DrugViolations = DrugViolations / Population) |>
  transform(DrugEquipmentViolations , DrugEquipmentViolations = DrugEquipmentViolations / Population) |>
  transform(Prostitution , Prostitution = Prostitution / Population) |>
  transform(AssistPromoteProstitution , AssistPromoteProstitution = AssistPromoteProstitution / Population) |>
  transform(PurchaseProstitution , PurchaseProstitution = PurchaseProstitution / Population)

Crime2021 <- Crime2021 |>
  select(FIPS, Population, TotIncidents, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution) |>
  filter(Population != "0")

save(Crime2021 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/Crime2021.Rda")

#The resulting Crime2021 dataset contains crime rates at the "pseudo-county" level, which means this: I took all LEAs that adopted NIBRS prior to 2018 and reported to NIBRS in all 12 months of 2021, summed their absolute crime counts in various categories of crime, summed those sums by county, and had as a result one number as an absolute crime count for various crime types which is the number of those crimes/incidents that were reported by all LEAs that reported to NIBRS in a particular county. I then took "Current Population 1" as the population reported by the reporting LEAs. I assume that this population number is the population covered by the reporting LEA; I am trying to confirm this, but haven't been able to do so yet. I then divided the crime counts by population to get a crime rate: for example, 10 incidents in a population of 100 would yield an incident rate of .10. These crime rates are the rates of crime within the jurisdiction of all reporting LEAs, gathered at the county level. Some counties have all of their LEAs reporting, so that my crime rates = the crime rate for the entire county. Other counties only have some of their LEAs reporting, so that my crime rates are a subset of county crime rates--thus my data is at the "pseudo-county" level. Does this data gathering imply bias? If LEAs are more or less likely to report to NIBRS based on whether they have a high or low crime rate, then the answer may be yes. The remedy is to consider data only from counties in which all LEAs reported, making my crime rate = the county's crime rate. But the same bias would exist here, the question just wouldn't be whether *LEAs* are more or less likely to report based on whether they have a high or low crime rate, but whether *counties* as a whole are similarly more or less likely to report.
```

```{r}
#Generating 2020 crime counts, and then crime rates

#Import crime data: Five folders of datasets from www.icpsr.umich.edu, all entitled "National Incident-Based Reporting System 2020: Extract Files". Currently, only loading the incident-level segment (file 0003). Here, I load 2020 crime data. This data has observations for each incident in 2020, the reporting law enforcement agency, the population covered by that agency, and crime data.

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/38566-0003-Data.rda")
da2020_0003 <- da38566.0003

#Import population data from U.S. Census Bureau (https://www2.census.gov/programs-surveys/popest/datasets/), by county, with population numbers and FIPS codes. I will need to use this population data to limit my dataset to only those counties in which there is full LEA participation. I will do this by comparing the Census population with the total population calculated by adding all populations reported by LEAs. If they are within a certain range, I will assume there is full LEA participation, which means that the crime counts as reported by the LEAs are the all-county crime counts, made into crime rates with the all-county population numbers. Alternatively, I could just use the population numbers reported by NIBRS and the crime counts of participating counties. This would also be comparing apples to apples, just not getting full county coverage of data.
#Population20_22 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population20_22.xlsx")
#Population20_22 <- Population20_22 |>
  #select(-FIPScore)

#Population18_19 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population18_19.xlsx")
#Population18_19 <- Population18_19 |>
  #select(-STATE , -COUNTY)

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2020_0003_select <- da2020_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113) |>
  filter(BH040 == "12")

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2020_0003_select$BH006 <- dmy(da2020_0003_select$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:
da2020_0003_select2 <- da2020_0003_select |>
  filter(BH006 < "2018-01-01")

da2020_0003_1 <- da2020_0003_select2 |>
  select(STATE , ORI , INCNUM , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113)

#Create new crime dataset for 2020 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )

Population <- da2020_0003_1 |>
  distinct(ORI , .keep_all = TRUE) |>
  select(ORI, BH019) |>
  rename(Population = BH019)
Incidents <- da2020_0003_1 |>
  count(ORI) |>
  rename(TotIncidents = n)
Offenses <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise(TotCrimeCount = sum(V1008))
MurderNonNegManslaughter91 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(091) Murder/Nonnegligent Manslaughter", na.rm = TRUE)) |>
  mutate(MurderNonNegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , MurderNonNegManslaughter)
NegManslaughter92 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(092) Negligent Manslaughter", na.rm = TRUE)) |>
  mutate(NegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , NegManslaughter)
JustifiableHomicide93 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(093) Justifiable Homicide", na.rm = TRUE)) |>
  mutate(JustifiableHomicide = rowSums(across(V20061:V20063))) |>
  select(ORI , JustifiableHomicide)
Kidnaping_Abduction100 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(100) Kidnaping/Abduction", na.rm = TRUE)) |>
  mutate(Kidnaping_Abduction = rowSums(across(V20061:V20063))) |>
  select(ORI , Kidnaping_Abduction)
Rape111 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(111) Rape", na.rm = TRUE)) |>
  mutate(Rape = rowSums(across(V20061:V20063))) |>
  select(ORI , Rape)
Sodomy112 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(112) Sodomy", na.rm = TRUE)) |>
  mutate(Sodomy = rowSums(across(V20061:V20063))) |>
  select(ORI , Sodomy)
SexAssaultObject113 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(113) Sexual Assault With An Object", na.rm = TRUE)) |>
  mutate(SexAssaultObject = rowSums(across(V20061:V20063))) |>
  select(ORI , SexAssaultObject)
Fondling_ChildMolest114 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(114) Fondling (Indecent Liberties/Child Molesting)", na.rm = TRUE)) |>
  mutate(Fondling_ChildMolest = rowSums(across(V20061:V20063))) |>
  select(ORI , Fondling_ChildMolest)
Robbery120 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(120) Robbery", na.rm = TRUE)) |>
  mutate(Robbery = rowSums(across(V20061:V20063))) |>
  select(ORI , Robbery)
AggAssault131 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(131) Aggravated Assault", na.rm = TRUE)) |>
  mutate(AggAssault = rowSums(across(V20061:V20063))) |>
  select(ORI , AggAssault)
SimpleAssault132 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(132) Simple Assault", na.rm = TRUE)) |>
  mutate(TotSimpleAssaults = rowSums(across(V20061:V20063))) |>
  select(ORI , TotSimpleAssaults)
Intimidation133 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(133) Intimidation", na.rm = TRUE)) |>
  mutate(Intimidation = rowSums(across(V20061:V20063))) |>
  select(ORI , Intimidation)
#Arson200 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(200) Arson", na.rm = TRUE)) |>
  #mutate(Arson = rowSums(across(V20061:V20063))) |>
  #select(ORI , Arson)
#ExtortionBlackmail210 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(210) Extortion/Blackmail", na.rm = TRUE)) |>
  #mutate(ExtortionBlackmail = rowSums(across(V20061:V20063))) |>
  #select(ORI , ExtortionBlackmail)
BurglaryBreakingEntering220 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(220) Burglary/Breaking and Entering", na.rm = TRUE)) |>
  mutate(BurglaryBreakingEntering = rowSums(across(V20061:V20063))) |>
  select(ORI , BurglaryBreakingEntering)
PocketPicking231 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(231) Pocket-picking", na.rm = TRUE)) |>
  mutate(PocketPicking = rowSums(across(V20061:V20063))) |>
  select(ORI , PocketPicking)
PurseSnatching232 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(232) Purse-snatching", na.rm = TRUE)) |>
  mutate(PurseSnatching = rowSums(across(V20061:V20063))) |>
  select(ORI , PurseSnatching)
Shoplifting233 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(233) Shoplifting", na.rm = TRUE)) |>
  mutate(Shoplifting = rowSums(across(V20061:V20063))) |>
  select(ORI , Shoplifting)
TheftFromBuilding234 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(234) Theft From Building", na.rm = TRUE)) |>
  mutate(TheftFromBuilding = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromBuilding)
TheftMachineDevice235 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(235) Theft From Coin-Operated Machine or Device", na.rm = TRUE)) |>
  mutate(TheftMachineDevice = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftMachineDevice)
TheftFromVehicle236 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(236) Theft From Motor Vehicle", na.rm = TRUE)) |>
  mutate(TheftFromVehicle = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromVehicle)
TheftOfVehicleOrParts237 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(237) Theft of Motor Vehicle Parts/Accessories", na.rm = TRUE)) |>
  mutate(TheftOfVehicleOrParts = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftOfVehicleOrParts)
AllOtherLarceny238 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(238) All Other Larceny", na.rm = TRUE)) |>
  mutate(AllOtherLarceny = rowSums(across(V20061:V20063))) |>
  select(ORI , AllOtherLarceny)
VehicleTheft240 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(240) Motor Vehicle Theft", na.rm = TRUE)) |>
  mutate(VehicleTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , VehicleTheft)
CounterfeitingForgery250 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(250) Counterfeiting/Forgery", na.rm = TRUE)) |>
  mutate(CounterfeitingForgery = rowSums(across(V20061:V20063))) |>
  select(ORI , CounterfeitingForgery)
SwindleConGame261 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(261) False Pretenses/Swindle/Confidence Game", na.rm = TRUE)) |>
  mutate(SwindleConGame = rowSums(across(V20061:V20063))) |>
  select(ORI , SwindleConGame)
CC_ATMFraud262 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(262) Credit Card/Automatic Teller Machine Fraud", na.rm = TRUE)) |>
  mutate(CC_ATMFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , CC_ATMFraud)
Impersonation263 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(263) Impersonation", na.rm = TRUE)) |>
  mutate(Impersonation = rowSums(across(V20061:V20063))) |>
  select(ORI , Impersonation)
WelfareFraud264 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(264) Welfare Fraud", na.rm = TRUE)) |>
  mutate(WelfareFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , WelfareFraud)
#WireFraud265 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(265) Wire Fraud", na.rm = TRUE)) |>
  #mutate(WireFraud = rowSums(across(V20061:V20063))) |>
  #select(ORI , WireFraud)
IdentityTheft266 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(266) Identity Theft", na.rm = TRUE)) |>
  mutate(IdentityTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , IdentityTheft)
HackingComputerInvasion267 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(267) Hacking/Computer Invasion", na.rm = TRUE)) |>
  mutate(HackingComputerInvasion = rowSums(across(V20061:V20063))) |>
  select(ORI , HackingComputerInvasion)
Embezzlement270 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(270) Embezzlement", na.rm = TRUE)) |>
  mutate(Embezzlement = rowSums(across(V20061:V20063))) |>
  select(ORI , Embezzlement)
StolenPropertyOffenses280 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(280) Stolen Property Offenses", na.rm = TRUE)) |>
  mutate(StolenPropertyOffenses = rowSums(across(V20061:V20063))) |>
  select(ORI , StolenPropertyOffenses)
DamageVandalismOfProperty290 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(290) Destruction/Damage/Vandalism of Property", na.rm = TRUE)) |>
  mutate(DamageVandalismOfProperty = rowSums(across(V20061:V20063))) |>
  select(ORI , DamageVandalismOfProperty)
DrugViolations351 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(351) Drug/Narcotic Violations", na.rm = TRUE)) |>
  mutate(DrugViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugViolations)
DrugEquipmentViolations352 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(352) Drug Equipment Violations", na.rm = TRUE)) |>
  mutate(DrugEquipmentViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugEquipmentViolations)
#Incest361 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(361) Incest", na.rm = TRUE)) |>
  #mutate(Incest = rowSums(across(V20061:V20063))) |>
  #select(ORI , Incest)
#StatRape362 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(362) Statutory Rape", na.rm = TRUE)) |>
  #mutate(StatRape = rowSums(across(V20061:V20063))) |>
  #select(ORI , StatRape)
#Pornography370 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(370) Pornography/Obscene Material", na.rm = TRUE)) |>
  #mutate(Pornography = rowSums(across(V20061:V20063))) |>
  #select(ORI , Pornography)
#BettingWagering391 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(391) Betting/Wagering", na.rm = TRUE)) |>
  #mutate(BettingWagering = rowSums(across(V20061:V20063))) |>
  #select(ORI , BettingWagering)
#AssistingGambling392 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(392) Operating/Promoting/Assisting Gambling", na.rm = TRUE)) |>
  #mutate(AssistingGambling = rowSums(across(V20061:V20063))) |>
  #select(ORI , AssistingGambling)
#GamblingEquipmentViols393 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(393) Gambling Equipment Violations", na.rm = TRUE)) |>
  #mutate(GamblingEquipmentViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , GamblingEquipmentViols)
#SportsTampering394 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(394) Sports Tampering", na.rm = TRUE)) |>
  #mutate(SportsTampering = rowSums(across(V20061:V20063))) |>
  #select(ORI , SportsTampering)
Prostitution401 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(401) Prostitution", na.rm = TRUE)) |>
  mutate(Prostitution = rowSums(across(V20061:V20063))) |>
  select(ORI , Prostitution)
AssistPromoteProstitution402 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(402) Assisting or Promoting Prostitution", na.rm = TRUE)) |>
  mutate(AssistPromoteProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , AssistPromoteProstitution)
PurchaseProstitution403 <- da2020_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(403) Purchasing Prostitution", na.rm = TRUE)) |>
  mutate(PurchaseProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , PurchaseProstitution)
#Bribery510 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(510) Bribery", na.rm = TRUE)) |>
  #mutate(Bribery = rowSums(across(V20061:V20063))) |>
  #select(ORI , Bribery)
#WeaponViols520 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(520) Weapon Law Violations", na.rm = TRUE)) |>
  #mutate(WeaponViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , WeaponViols)
#HumanSexTrafficking641 <- da2020_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(641) Human Trafficking- Commercial Sex Acts", na.rm = TRUE)) |>
  #mutate(HumanSexTrafficking = rowSums(across(V20061:V20063))) |>
  #select(ORI , HumanSexTrafficking)

#Create a data.frame that is a collection of all crime counts:
CrimeSummary2020 <- 
  cbind(Population, Incidents , Offenses , MurderNonNegManslaughter91 , NegManslaughter92 , JustifiableHomicide93 , Kidnaping_Abduction100 , Rape111 , Sodomy112 , SexAssaultObject113  , Fondling_ChildMolest114 , Robbery120 , AggAssault131 , SimpleAssault132 , Intimidation133, BurglaryBreakingEntering220, PocketPicking231 , PurseSnatching232, Shoplifting233 , TheftFromBuilding234 , TheftMachineDevice235 , TheftFromVehicle236 , TheftOfVehicleOrParts237 , AllOtherLarceny238 , VehicleTheft240 , CounterfeitingForgery250 , SwindleConGame261 , CC_ATMFraud262 , Impersonation263 , WelfareFraud264 , IdentityTheft266 , HackingComputerInvasion267, Embezzlement270 , StolenPropertyOffenses280, DamageVandalismOfProperty290 , DrugViolations351 , DrugEquipmentViolations352 , Prostitution401 , AssistPromoteProstitution402, PurchaseProstitution403)

#Save this data.frame
save(CrimeSummary2020 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeSummary2020.Rda")

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeSummary2020_1 <- CrimeSummary2020 |>
  select(Population, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeSummary2020_2 <- CrimeSummary2020_1 |>
  cbind(Incidents)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeSummary2020_3 <- CrimeSummary2020_2 |>
  relocate(TotIncidents , .before = TotCrimeCount) |>
  relocate(ORI , .before = TotIncidents)

#Save this data.frame
save(CrimeSummary2020_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeSummary2020_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2019_crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001
 
#Insert FIPS value and place it at the front of the data.frame
CrimeSummary2020_4 <-
  left_join(CrimeSummary2020_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeSummary2020_5 <- CrimeSummary2020_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeSummary2020_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeSummary2020_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total populations and crime counts for all law enforcement agencies reporting in any particular county. So, assuming the data is accurate, if all LEAs in a county reported, I would get a count of all crimes in that county and the county's population. If not all LEAs in a county reported, I would get a count of all crimes and the population within the coverage area of the reporting LEAs.
CrimeCount2020 <- CrimeSummary2020_5 |>
  group_by(FIPS) |>
  summarise_at(vars(Population , TotIncidents:PurchaseProstitution) , list(sum))

save(CrimeCount2020 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeCount2020.Rda")

#Load and view 2020 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeCount2020.Rda")
View(CrimeCount2020)

#Transform Crime2020, which has crime counts, into Crime2020, which will have crime rates (i.e. crime counts / population):
Crime2020 <- CrimeCount2020 |>
  transform(TotIncidents, TotIncidents = TotIncidents / Population) |>
  transform(TotCrimeCount, TotCrimeCount = TotCrimeCount / Population) |>
  transform(MurderNonNegManslaughter, MurderNonNegManslaughter = MurderNonNegManslaughter / Population) |>
  transform(NegManslaughter , NegManslaughter = NegManslaughter / Population) |>
  transform(JustifiableHomicide , JustifiableHomicide = JustifiableHomicide / Population) |>
  transform(Kidnaping_Abduction , Kidnaping_Abduction = Kidnaping_Abduction / Population) |>
  transform(Rape , Rape = Rape / Population) |>
  transform(Sodomy , Sodomy = Sodomy / Population) |>
  transform(SexAssaultObject , SexAssaultObject = SexAssaultObject / Population) |>
  transform(Fondling_ChildMolest , Fondling_ChildMolest = Fondling_ChildMolest / Population) |>
  transform(Robbery , Robbery = Robbery / Population) |>
  transform(AggAssault , AggAssault = AggAssault / Population) |>
  transform(TotSimpleAssaults , TotSimpleAssaults = TotSimpleAssaults / Population) |>
  transform(Intimidation , Intimidation = Intimidation / Population) |>
  transform(BurglaryBreakingEntering , BurglaryBreakingEntering = BurglaryBreakingEntering / Population) |>
  transform(PocketPicking , PocketPicking = PocketPicking / Population) |>
  transform(PurseSnatching , PurseSnatching = PurseSnatching / Population) |>
  transform(Shoplifting , Shoplifting = Shoplifting / Population) |>
  transform(TheftFromBuilding , TheftFromBuilding = TheftFromBuilding / Population) |>
  transform(TheftMachineDevice , TheftMachineDevice = TheftMachineDevice / Population) |>
  transform(TheftFromVehicle , TheftFromVehicle = TheftFromVehicle / Population) |>
  transform(TheftOfVehicleOrParts , TheftOfVehicleOrParts = TheftOfVehicleOrParts / Population) |>
  transform(AllOtherLarceny , AllOtherLarceny = AllOtherLarceny / Population) |>
  transform(VehicleTheft , VehicleTheft = VehicleTheft / Population) |>
  transform(CounterfeitingForgery , CounterfeitingForgery = CounterfeitingForgery / Population) |>
  transform(SwindleConGame , SwindleConGame = SwindleConGame / Population) |>
  transform(CC_ATMFraud , CC_ATMFraud = CC_ATMFraud / Population) |>
  transform(Impersonation , Impersonation = Impersonation / Population) |>
  transform(WelfareFraud , WelfareFraud = WelfareFraud / Population) |>
  transform(IdentityTheft , IdentityTheft = IdentityTheft / Population) |>
  transform(HackingComputerInvasion , HackingComputerInvasion = HackingComputerInvasion / Population) |>
  transform(Embezzlement , Embezzlement = Embezzlement / Population) |>
  transform(StolenPropertyOffenses , StolenPropertyOffenses = StolenPropertyOffenses / Population) |>
  transform(DamageVandalismOfProperty , DamageVandalismOfProperty = DamageVandalismOfProperty / Population) |>
  transform(DrugViolations , DrugViolations = DrugViolations / Population) |>
  transform(DrugEquipmentViolations , DrugEquipmentViolations = DrugEquipmentViolations / Population) |>
  transform(Prostitution , Prostitution = Prostitution / Population) |>
  transform(AssistPromoteProstitution , AssistPromoteProstitution = AssistPromoteProstitution / Population) |>
  transform(PurchaseProstitution , PurchaseProstitution = PurchaseProstitution / Population)

Crime2020 <- Crime2020 |>
  select(FIPS, Population, TotIncidents, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution) |>
  filter(Population != "0")

save(Crime2020 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/Crime2020.Rda")

#The resulting Crime2020 dataset contains crime rates at the "pseudo-county" level, which means this: I took all LEAs that adopted NIBRS prior to 2018 and reported to NIBRS in all 12 months of 2020, summed their absolute crime counts in various categories of crime, summed those sums by county, and had as a result one number as an absolute crime count for various crime types which is the number of those crimes/incidents that were reported by all LEAs that reported to NIBRS in a particular county. I then took "Current Population 1" as the population reported by the reporting LEAs. I assume that this population number is the population covered by the reporting LEA; I am trying to confirm this, but haven't been able to do so yet. I then divided the crime counts by population to get a crime rate: for example, 10 incidents in a population of 100 would yield an incident rate of .10. These crime rates are the rates of crime within the jurisdiction of all reporting LEAs, gathered at the county level. Some counties have all of their LEAs reporting, so that my crime rates = the crime rate for the entire county. Other counties only have some of their LEAs reporting, so that my crime rates are a subset of county crime rates--thus my data is at the "pseudo-county" level. Does this data gathering imply bias? If LEAs are more or less likely to report to NIBRS based on whether they have a high or low crime rate, then the answer may be yes. The remedy is to consider data only from counties in which all LEAs reported, making my crime rate = the county's crime rate. But the same bias would exist here, the question just wouldn't be whether *LEAs* are more or less likely to report based on whether they have a high or low crime rate, but whether *counties* as a whole are similarly more or less likely to report.
```

```{r}
#Generating 2019 crime counts, and then crime rates

#Import crime data: Five folders of datasets from www.icpsr.umich.edu, all entitled "National Incident-Based Reporting System 2019: Extract Files". Currently, only loading the incident-level segment (file 0003). Here, I load 2019 crime data. This data has observations for each incident in 2019, the reporting law enforcement agency, the population covered by that agency, and crime data.

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/38565-0003-Data.rda")
da2019_0003 <- da38565.0003

#Import population data from U.S. Census Bureau (https://www2.census.gov/programs-surveys/popest/datasets/), by county, with population numbers and FIPS codes. I will need to use this population data to limit my dataset to only those counties in which there is full LEA participation. I will do this by comparing the Census population with the total population calculated by adding all populations reported by LEAs. If they are within a certain range, I will assume there is full LEA participation, which means that the crime counts as reported by the LEAs are the all-county crime counts, made into crime rates with the all-county population numbers. Alternatively, I could just use the population numbers reported by NIBRS and the crime counts of participating counties. This would also be comparing apples to apples, just not getting full county coverage of data.
#Population20_22 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population20_22.xlsx")
#Population20_22 <- Population20_22 |>
  #select(-FIPScore)

#Population18_19 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population18_19.xlsx")
#Population18_19 <- Population18_19 |>
  #select(-STATE , -COUNTY)

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2019_0003_select <- da2019_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113) |>
  filter(BH040 == "12")

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2019_0003_select$BH006 <- dmy(da2019_0003_select$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:
da2019_0003_select2 <- da2019_0003_select |>
  filter(BH006 < "2018-01-01")

da2019_0003_1 <- da2019_0003_select2 |>
  select(STATE , ORI , INCNUM , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113)

#Create new crime dataset for 2019 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )

Population <- da2019_0003_1 |>
  distinct(ORI , .keep_all = TRUE) |>
  select(ORI, BH019) |>
  rename(Population = BH019)
Incidents <- da2019_0003_1 |>
  count(ORI) |>
  rename(TotIncidents = n)
Offenses <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise(TotCrimeCount = sum(V1008))
MurderNonNegManslaughter91 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(091) Murder/Nonnegligent Manslaughter", na.rm = TRUE)) |>
  mutate(MurderNonNegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , MurderNonNegManslaughter)
NegManslaughter92 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(092) Negligent Manslaughter", na.rm = TRUE)) |>
  mutate(NegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , NegManslaughter)
JustifiableHomicide93 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(093) Justifiable Homicide", na.rm = TRUE)) |>
  mutate(JustifiableHomicide = rowSums(across(V20061:V20063))) |>
  select(ORI , JustifiableHomicide)
Kidnaping_Abduction100 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(100) Kidnaping/Abduction", na.rm = TRUE)) |>
  mutate(Kidnaping_Abduction = rowSums(across(V20061:V20063))) |>
  select(ORI , Kidnaping_Abduction)
Rape111 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(111) Rape", na.rm = TRUE)) |>
  mutate(Rape = rowSums(across(V20061:V20063))) |>
  select(ORI , Rape)
Sodomy112 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(112) Sodomy", na.rm = TRUE)) |>
  mutate(Sodomy = rowSums(across(V20061:V20063))) |>
  select(ORI , Sodomy)
SexAssaultObject113 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(113) Sexual Assault With An Object", na.rm = TRUE)) |>
  mutate(SexAssaultObject = rowSums(across(V20061:V20063))) |>
  select(ORI , SexAssaultObject)
Fondling_ChildMolest114 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(114) Fondling (Indecent Liberties/Child Molesting)", na.rm = TRUE)) |>
  mutate(Fondling_ChildMolest = rowSums(across(V20061:V20063))) |>
  select(ORI , Fondling_ChildMolest)
Robbery120 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(120) Robbery", na.rm = TRUE)) |>
  mutate(Robbery = rowSums(across(V20061:V20063))) |>
  select(ORI , Robbery)
AggAssault131 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(131) Aggravated Assault", na.rm = TRUE)) |>
  mutate(AggAssault = rowSums(across(V20061:V20063))) |>
  select(ORI , AggAssault)
SimpleAssault132 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(132) Simple Assault", na.rm = TRUE)) |>
  mutate(TotSimpleAssaults = rowSums(across(V20061:V20063))) |>
  select(ORI , TotSimpleAssaults)
Intimidation133 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(133) Intimidation", na.rm = TRUE)) |>
  mutate(Intimidation = rowSums(across(V20061:V20063))) |>
  select(ORI , Intimidation)
#Arson200 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(200) Arson", na.rm = TRUE)) |>
  #mutate(Arson = rowSums(across(V20061:V20063))) |>
  #select(ORI , Arson)
#ExtortionBlackmail210 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(210) Extortion/Blackmail", na.rm = TRUE)) |>
  #mutate(ExtortionBlackmail = rowSums(across(V20061:V20063))) |>
  #select(ORI , ExtortionBlackmail)
BurglaryBreakingEntering220 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(220) Burglary/Breaking and Entering", na.rm = TRUE)) |>
  mutate(BurglaryBreakingEntering = rowSums(across(V20061:V20063))) |>
  select(ORI , BurglaryBreakingEntering)
PocketPicking231 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(231) Pocket-picking", na.rm = TRUE)) |>
  mutate(PocketPicking = rowSums(across(V20061:V20063))) |>
  select(ORI , PocketPicking)
PurseSnatching232 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(232) Purse-snatching", na.rm = TRUE)) |>
  mutate(PurseSnatching = rowSums(across(V20061:V20063))) |>
  select(ORI , PurseSnatching)
Shoplifting233 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(233) Shoplifting", na.rm = TRUE)) |>
  mutate(Shoplifting = rowSums(across(V20061:V20063))) |>
  select(ORI , Shoplifting)
TheftFromBuilding234 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(234) Theft From Building", na.rm = TRUE)) |>
  mutate(TheftFromBuilding = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromBuilding)
TheftMachineDevice235 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(235) Theft From Coin-Operated Machine or Device", na.rm = TRUE)) |>
  mutate(TheftMachineDevice = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftMachineDevice)
TheftFromVehicle236 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(236) Theft From Motor Vehicle", na.rm = TRUE)) |>
  mutate(TheftFromVehicle = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromVehicle)
TheftOfVehicleOrParts237 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(237) Theft of Motor Vehicle Parts/Accessories", na.rm = TRUE)) |>
  mutate(TheftOfVehicleOrParts = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftOfVehicleOrParts)
AllOtherLarceny238 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(238) All Other Larceny", na.rm = TRUE)) |>
  mutate(AllOtherLarceny = rowSums(across(V20061:V20063))) |>
  select(ORI , AllOtherLarceny)
VehicleTheft240 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(240) Motor Vehicle Theft", na.rm = TRUE)) |>
  mutate(VehicleTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , VehicleTheft)
CounterfeitingForgery250 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(250) Counterfeiting/Forgery", na.rm = TRUE)) |>
  mutate(CounterfeitingForgery = rowSums(across(V20061:V20063))) |>
  select(ORI , CounterfeitingForgery)
SwindleConGame261 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(261) False Pretenses/Swindle/Confidence Game", na.rm = TRUE)) |>
  mutate(SwindleConGame = rowSums(across(V20061:V20063))) |>
  select(ORI , SwindleConGame)
CC_ATMFraud262 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(262) Credit Card/Automatic Teller Machine Fraud", na.rm = TRUE)) |>
  mutate(CC_ATMFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , CC_ATMFraud)
Impersonation263 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(263) Impersonation", na.rm = TRUE)) |>
  mutate(Impersonation = rowSums(across(V20061:V20063))) |>
  select(ORI , Impersonation)
WelfareFraud264 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(264) Welfare Fraud", na.rm = TRUE)) |>
  mutate(WelfareFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , WelfareFraud)
#WireFraud265 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(265) Wire Fraud", na.rm = TRUE)) |>
  #mutate(WireFraud = rowSums(across(V20061:V20063))) |>
  #select(ORI , WireFraud)
IdentityTheft266 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(266) Identity Theft", na.rm = TRUE)) |>
  mutate(IdentityTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , IdentityTheft)
HackingComputerInvasion267 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(267) Hacking/Computer Invasion", na.rm = TRUE)) |>
  mutate(HackingComputerInvasion = rowSums(across(V20061:V20063))) |>
  select(ORI , HackingComputerInvasion)
Embezzlement270 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(270) Embezzlement", na.rm = TRUE)) |>
  mutate(Embezzlement = rowSums(across(V20061:V20063))) |>
  select(ORI , Embezzlement)
StolenPropertyOffenses280 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(280) Stolen Property Offenses", na.rm = TRUE)) |>
  mutate(StolenPropertyOffenses = rowSums(across(V20061:V20063))) |>
  select(ORI , StolenPropertyOffenses)
DamageVandalismOfProperty290 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(290) Destruction/Damage/Vandalism of Property", na.rm = TRUE)) |>
  mutate(DamageVandalismOfProperty = rowSums(across(V20061:V20063))) |>
  select(ORI , DamageVandalismOfProperty)
DrugViolations351 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(351) Drug/Narcotic Violations", na.rm = TRUE)) |>
  mutate(DrugViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugViolations)
DrugEquipmentViolations352 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(352) Drug Equipment Violations", na.rm = TRUE)) |>
  mutate(DrugEquipmentViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugEquipmentViolations)
#Incest361 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(361) Incest", na.rm = TRUE)) |>
  #mutate(Incest = rowSums(across(V20061:V20063))) |>
  #select(ORI , Incest)
#StatRape362 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(362) Statutory Rape", na.rm = TRUE)) |>
  #mutate(StatRape = rowSums(across(V20061:V20063))) |>
  #select(ORI , StatRape)
#Pornography370 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(370) Pornography/Obscene Material", na.rm = TRUE)) |>
  #mutate(Pornography = rowSums(across(V20061:V20063))) |>
  #select(ORI , Pornography)
#BettingWagering391 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(391) Betting/Wagering", na.rm = TRUE)) |>
  #mutate(BettingWagering = rowSums(across(V20061:V20063))) |>
  #select(ORI , BettingWagering)
#AssistingGambling392 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(392) Operating/Promoting/Assisting Gambling", na.rm = TRUE)) |>
  #mutate(AssistingGambling = rowSums(across(V20061:V20063))) |>
  #select(ORI , AssistingGambling)
#GamblingEquipmentViols393 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(393) Gambling Equipment Violations", na.rm = TRUE)) |>
  #mutate(GamblingEquipmentViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , GamblingEquipmentViols)
#SportsTampering394 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(394) Sports Tampering", na.rm = TRUE)) |>
  #mutate(SportsTampering = rowSums(across(V20061:V20063))) |>
  #select(ORI , SportsTampering)
Prostitution401 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(401) Prostitution", na.rm = TRUE)) |>
  mutate(Prostitution = rowSums(across(V20061:V20063))) |>
  select(ORI , Prostitution)
AssistPromoteProstitution402 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(402) Assisting or Promoting Prostitution", na.rm = TRUE)) |>
  mutate(AssistPromoteProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , AssistPromoteProstitution)
PurchaseProstitution403 <- da2019_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(403) Purchasing Prostitution", na.rm = TRUE)) |>
  mutate(PurchaseProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , PurchaseProstitution)
#Bribery510 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(510) Bribery", na.rm = TRUE)) |>
  #mutate(Bribery = rowSums(across(V20061:V20063))) |>
  #select(ORI , Bribery)
#WeaponViols520 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(520) Weapon Law Violations", na.rm = TRUE)) |>
  #mutate(WeaponViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , WeaponViols)
#HumanSexTrafficking641 <- da2019_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(641) Human Trafficking- Commercial Sex Acts", na.rm = TRUE)) |>
  #mutate(HumanSexTrafficking = rowSums(across(V20061:V20063))) |>
  #select(ORI , HumanSexTrafficking)

#Create a data.frame that is a collection of all crime counts:
CrimeSummary2019 <- 
  cbind(Population, Incidents , Offenses , MurderNonNegManslaughter91 , NegManslaughter92 , JustifiableHomicide93 , Kidnaping_Abduction100 , Rape111 , Sodomy112 , SexAssaultObject113  , Fondling_ChildMolest114 , Robbery120 , AggAssault131 , SimpleAssault132 , Intimidation133, BurglaryBreakingEntering220, PocketPicking231 , PurseSnatching232, Shoplifting233 , TheftFromBuilding234 , TheftMachineDevice235 , TheftFromVehicle236 , TheftOfVehicleOrParts237 , AllOtherLarceny238 , VehicleTheft240 , CounterfeitingForgery250 , SwindleConGame261 , CC_ATMFraud262 , Impersonation263 , WelfareFraud264 , IdentityTheft266 , HackingComputerInvasion267, Embezzlement270 , StolenPropertyOffenses280, DamageVandalismOfProperty290 , DrugViolations351 , DrugEquipmentViolations352 , Prostitution401 , AssistPromoteProstitution402, PurchaseProstitution403)

#Save this data.frame
save(CrimeSummary2019 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeSummary2019.Rda")

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeSummary2019_1 <- CrimeSummary2019 |>
  select(Population, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeSummary2019_2 <- CrimeSummary2019_1 |>
  cbind(Incidents)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeSummary2019_3 <- CrimeSummary2019_2 |>
  relocate(TotIncidents , .before = TotCrimeCount) |>
  relocate(ORI , .before = TotIncidents)

#Save this data.frame
save(CrimeSummary2019_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeSummary2019_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2019_crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001
 
#Insert FIPS value and place it at the front of the data.frame
CrimeSummary2019_4 <-
  left_join(CrimeSummary2019_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeSummary2019_5 <- CrimeSummary2019_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeSummary2019_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeSummary2019_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total populations and crime counts for all law enforcement agencies reporting in any particular county. So, assuming the data is accurate, if all LEAs in a county reported, I would get a count of all crimes in that county and the county's population. If not all LEAs in a county reported, I would get a count of all crimes and the population within the coverage area of the reporting LEAs.
CrimeCount2019 <- CrimeSummary2019_5 |>
  group_by(FIPS) |>
  summarise_at(vars(Population , TotIncidents:PurchaseProstitution) , list(sum))

save(CrimeCount2019 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeCount2019.Rda")

#Load and view 2019 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeCount2019.Rda")
View(CrimeCount2019)

#Transform Crime2019, which has crime counts, into Crime2019, which will have crime rates (i.e. crime counts / population):
Crime2019 <- CrimeCount2019 |>
  transform(TotIncidents, TotIncidents = TotIncidents / Population) |>
  transform(TotCrimeCount, TotCrimeCount = TotCrimeCount / Population) |>
  transform(MurderNonNegManslaughter, MurderNonNegManslaughter = MurderNonNegManslaughter / Population) |>
  transform(NegManslaughter , NegManslaughter = NegManslaughter / Population) |>
  transform(JustifiableHomicide , JustifiableHomicide = JustifiableHomicide / Population) |>
  transform(Kidnaping_Abduction , Kidnaping_Abduction = Kidnaping_Abduction / Population) |>
  transform(Rape , Rape = Rape / Population) |>
  transform(Sodomy , Sodomy = Sodomy / Population) |>
  transform(SexAssaultObject , SexAssaultObject = SexAssaultObject / Population) |>
  transform(Fondling_ChildMolest , Fondling_ChildMolest = Fondling_ChildMolest / Population) |>
  transform(Robbery , Robbery = Robbery / Population) |>
  transform(AggAssault , AggAssault = AggAssault / Population) |>
  transform(TotSimpleAssaults , TotSimpleAssaults = TotSimpleAssaults / Population) |>
  transform(Intimidation , Intimidation = Intimidation / Population) |>
  transform(BurglaryBreakingEntering , BurglaryBreakingEntering = BurglaryBreakingEntering / Population) |>
  transform(PocketPicking , PocketPicking = PocketPicking / Population) |>
  transform(PurseSnatching , PurseSnatching = PurseSnatching / Population) |>
  transform(Shoplifting , Shoplifting = Shoplifting / Population) |>
  transform(TheftFromBuilding , TheftFromBuilding = TheftFromBuilding / Population) |>
  transform(TheftMachineDevice , TheftMachineDevice = TheftMachineDevice / Population) |>
  transform(TheftFromVehicle , TheftFromVehicle = TheftFromVehicle / Population) |>
  transform(TheftOfVehicleOrParts , TheftOfVehicleOrParts = TheftOfVehicleOrParts / Population) |>
  transform(AllOtherLarceny , AllOtherLarceny = AllOtherLarceny / Population) |>
  transform(VehicleTheft , VehicleTheft = VehicleTheft / Population) |>
  transform(CounterfeitingForgery , CounterfeitingForgery = CounterfeitingForgery / Population) |>
  transform(SwindleConGame , SwindleConGame = SwindleConGame / Population) |>
  transform(CC_ATMFraud , CC_ATMFraud = CC_ATMFraud / Population) |>
  transform(Impersonation , Impersonation = Impersonation / Population) |>
  transform(WelfareFraud , WelfareFraud = WelfareFraud / Population) |>
  transform(IdentityTheft , IdentityTheft = IdentityTheft / Population) |>
  transform(HackingComputerInvasion , HackingComputerInvasion = HackingComputerInvasion / Population) |>
  transform(Embezzlement , Embezzlement = Embezzlement / Population) |>
  transform(StolenPropertyOffenses , StolenPropertyOffenses = StolenPropertyOffenses / Population) |>
  transform(DamageVandalismOfProperty , DamageVandalismOfProperty = DamageVandalismOfProperty / Population) |>
  transform(DrugViolations , DrugViolations = DrugViolations / Population) |>
  transform(DrugEquipmentViolations , DrugEquipmentViolations = DrugEquipmentViolations / Population) |>
  transform(Prostitution , Prostitution = Prostitution / Population) |>
  transform(AssistPromoteProstitution , AssistPromoteProstitution = AssistPromoteProstitution / Population) |>
  transform(PurchaseProstitution , PurchaseProstitution = PurchaseProstitution / Population)

Crime2019 <- Crime2019 |>
  select(FIPS, Population, TotIncidents, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution) |>
  filter(Population != "0")

save(Crime2019 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/Crime2019.Rda")

#The resulting Crime2019 dataset contains crime rates at the "pseudo-county" level, which means this: I took all LEAs that adopted NIBRS prior to 2018 and reported to NIBRS in all 12 months of 2019, summed their absolute crime counts in various categories of crime, summed those sums by county, and had as a result one number as an absolute crime count for various crime types which is the number of those crimes/incidents that were reported by all LEAs that reported to NIBRS in a particular county. I then took "Current Population 1" as the population reported by the reporting LEAs. I assume that this population number is the population covered by the reporting LEA; I am trying to confirm this, but haven't been able to do so yet. I then divided the crime counts by population to get a crime rate: for example, 10 incidents in a population of 100 would yield an incident rate of .10. These crime rates are the rates of crime within the jurisdiction of all reporting LEAs, gathered at the county level. Some counties have all of their LEAs reporting, so that my crime rates = the crime rate for the entire county. Other counties only have some of their LEAs reporting, so that my crime rates are a subset of county crime rates--thus my data is at the "pseudo-county" level. Does this data gathering imply bias? If LEAs are more or less likely to report to NIBRS based on whether they have a high or low crime rate, then the answer may be yes. The remedy is to consider data only from counties in which all LEAs reported, making my crime rate = the county's crime rate. But the same bias would exist here, the question just wouldn't be whether *LEAs* are more or less likely to report based on whether they have a high or low crime rate, but whether *counties* as a whole are similarly more or less likely to report.
```

```{r}
#Generating 2018 crime counts, and then crime rates

#Import crime data: Five folders of datasets from www.icpsr.umich.edu, all entitled "National Incident-Based Reporting System 2018: Extract Files". Currently, only loading the incident-level segment (file 0003). Here, I load 2018 crime data. This data has observations for each incident in 2018, the reporting law enforcement agency, the population covered by that agency, and crime data.

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/37649-0003-Data.rda")
da2018_0003 <- da37649.0003

#Import population data from U.S. Census Bureau (https://www2.census.gov/programs-surveys/popest/datasets/), by county, with population numbers and FIPS codes. I will need to use this population data to limit my dataset to only those counties in which there is full LEA participation. I will do this by comparing the Census population with the total population calculated by adding all populations reported by LEAs. If they are within a certain range, I will assume there is full LEA participation, which means that the crime counts as reported by the LEAs are the all-county crime counts, made into crime rates with the all-county population numbers. Alternatively, I could just use the population numbers reported by NIBRS and the crime counts of participating counties. This would also be comparing apples to apples, just not getting full county coverage of data.
#Population20_22 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population20_22.xlsx")
#Population20_22 <- Population20_22 |>
  #select(-FIPScore)

#Population18_19 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Population18_19.xlsx")
#Population18_19 <- Population18_19 |>
  #select(-STATE , -COUNTY)

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2018_0003_select <- da2018_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113) |>
  filter(BH040 == "12")

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2018_0003_select$BH006 <- dmy(da2018_0003_select$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:
da2018_0003_select2 <- da2018_0003_select |>
  filter(BH006 < "2018-01-01")

da2018_0003_1 <- da2018_0003_select2 |>
  select(STATE , ORI , INCNUM , BH019 , BH040 , V1008 , V1010 , V20061 , V20062 , V20063 , V50071 , V50072 , V50073 , V50081 , V50082 , V50083 , V50091 , V50092 , V50093 , V50111 , V50112 , V50113)

#Create new crime dataset for 2018 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )

Population <- da2018_0003_1 |>
  distinct(ORI , .keep_all = TRUE) |>
  select(ORI, BH019) |>
  rename(Population = BH019)
Incidents <- da2018_0003_1 |>
  count(ORI) |>
  rename(TotIncidents = n)
Offenses <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise(TotCrimeCount = sum(V1008))
MurderNonNegManslaughter91 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(091) Murder/Nonnegligent Manslaughter", na.rm = TRUE)) |>
  mutate(MurderNonNegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , MurderNonNegManslaughter)
NegManslaughter92 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(092) Negligent Manslaughter", na.rm = TRUE)) |>
  mutate(NegManslaughter = rowSums(across(V20061:V20063))) |>
  select(ORI , NegManslaughter)
JustifiableHomicide93 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(093) Justifiable Homicide", na.rm = TRUE)) |>
  mutate(JustifiableHomicide = rowSums(across(V20061:V20063))) |>
  select(ORI , JustifiableHomicide)
Kidnaping_Abduction100 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(100) Kidnaping/Abduction", na.rm = TRUE)) |>
  mutate(Kidnaping_Abduction = rowSums(across(V20061:V20063))) |>
  select(ORI , Kidnaping_Abduction)
Rape111 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(111) Rape", na.rm = TRUE)) |>
  mutate(Rape = rowSums(across(V20061:V20063))) |>
  select(ORI , Rape)
Sodomy112 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(112) Sodomy", na.rm = TRUE)) |>
  mutate(Sodomy = rowSums(across(V20061:V20063))) |>
  select(ORI , Sodomy)
SexAssaultObject113 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(113) Sexual Assault With An Object", na.rm = TRUE)) |>
  mutate(SexAssaultObject = rowSums(across(V20061:V20063))) |>
  select(ORI , SexAssaultObject)
Fondling_ChildMolest114 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(114) Fondling (Indecent Liberties/Child Molesting)", na.rm = TRUE)) |>
  mutate(Fondling_ChildMolest = rowSums(across(V20061:V20063))) |>
  select(ORI , Fondling_ChildMolest)
Robbery120 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(120) Robbery", na.rm = TRUE)) |>
  mutate(Robbery = rowSums(across(V20061:V20063))) |>
  select(ORI , Robbery)
AggAssault131 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(131) Aggravated Assault", na.rm = TRUE)) |>
  mutate(AggAssault = rowSums(across(V20061:V20063))) |>
  select(ORI , AggAssault)
SimpleAssault132 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(132) Simple Assault", na.rm = TRUE)) |>
  mutate(TotSimpleAssaults = rowSums(across(V20061:V20063))) |>
  select(ORI , TotSimpleAssaults)
Intimidation133 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(133) Intimidation", na.rm = TRUE)) |>
  mutate(Intimidation = rowSums(across(V20061:V20063))) |>
  select(ORI , Intimidation)
#Arson200 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(200) Arson", na.rm = TRUE)) |>
  #mutate(Arson = rowSums(across(V20061:V20063))) |>
  #select(ORI , Arson)
#ExtortionBlackmail210 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(210) Extortion/Blackmail", na.rm = TRUE)) |>
  #mutate(ExtortionBlackmail = rowSums(across(V20061:V20063))) |>
  #select(ORI , ExtortionBlackmail)
BurglaryBreakingEntering220 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(220) Burglary/Breaking and Entering", na.rm = TRUE)) |>
  mutate(BurglaryBreakingEntering = rowSums(across(V20061:V20063))) |>
  select(ORI , BurglaryBreakingEntering)
PocketPicking231 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(231) Pocket-picking", na.rm = TRUE)) |>
  mutate(PocketPicking = rowSums(across(V20061:V20063))) |>
  select(ORI , PocketPicking)
PurseSnatching232 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(232) Purse-snatching", na.rm = TRUE)) |>
  mutate(PurseSnatching = rowSums(across(V20061:V20063))) |>
  select(ORI , PurseSnatching)
Shoplifting233 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(233) Shoplifting", na.rm = TRUE)) |>
  mutate(Shoplifting = rowSums(across(V20061:V20063))) |>
  select(ORI , Shoplifting)
TheftFromBuilding234 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(234) Theft From Building", na.rm = TRUE)) |>
  mutate(TheftFromBuilding = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromBuilding)
TheftMachineDevice235 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(235) Theft From Coin-Operated Machine or Device", na.rm = TRUE)) |>
  mutate(TheftMachineDevice = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftMachineDevice)
TheftFromVehicle236 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(236) Theft From Motor Vehicle", na.rm = TRUE)) |>
  mutate(TheftFromVehicle = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftFromVehicle)
TheftOfVehicleOrParts237 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(237) Theft of Motor Vehicle Parts/Accessories", na.rm = TRUE)) |>
  mutate(TheftOfVehicleOrParts = rowSums(across(V20061:V20063))) |>
  select(ORI , TheftOfVehicleOrParts)
AllOtherLarceny238 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(238) All Other Larceny", na.rm = TRUE)) |>
  mutate(AllOtherLarceny = rowSums(across(V20061:V20063))) |>
  select(ORI , AllOtherLarceny)
VehicleTheft240 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(240) Motor Vehicle Theft", na.rm = TRUE)) |>
  mutate(VehicleTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , VehicleTheft)
CounterfeitingForgery250 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(250) Counterfeiting/Forgery", na.rm = TRUE)) |>
  mutate(CounterfeitingForgery = rowSums(across(V20061:V20063))) |>
  select(ORI , CounterfeitingForgery)
SwindleConGame261 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(261) False Pretenses/Swindle/Confidence Game", na.rm = TRUE)) |>
  mutate(SwindleConGame = rowSums(across(V20061:V20063))) |>
  select(ORI , SwindleConGame)
CC_ATMFraud262 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(262) Credit Card/Automatic Teller Machine Fraud", na.rm = TRUE)) |>
  mutate(CC_ATMFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , CC_ATMFraud)
Impersonation263 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(263) Impersonation", na.rm = TRUE)) |>
  mutate(Impersonation = rowSums(across(V20061:V20063))) |>
  select(ORI , Impersonation)
WelfareFraud264 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(264) Welfare Fraud", na.rm = TRUE)) |>
  mutate(WelfareFraud = rowSums(across(V20061:V20063))) |>
  select(ORI , WelfareFraud)
#WireFraud265 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(265) Wire Fraud", na.rm = TRUE)) |>
  #mutate(WireFraud = rowSums(across(V20061:V20063))) |>
  #select(ORI , WireFraud)
IdentityTheft266 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(266) Identity Theft", na.rm = TRUE)) |>
  mutate(IdentityTheft = rowSums(across(V20061:V20063))) |>
  select(ORI , IdentityTheft)
HackingComputerInvasion267 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(267) Hacking/Computer Invasion", na.rm = TRUE)) |>
  mutate(HackingComputerInvasion = rowSums(across(V20061:V20063))) |>
  select(ORI , HackingComputerInvasion)
Embezzlement270 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(270) Embezzlement", na.rm = TRUE)) |>
  mutate(Embezzlement = rowSums(across(V20061:V20063))) |>
  select(ORI , Embezzlement)
StolenPropertyOffenses280 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(280) Stolen Property Offenses", na.rm = TRUE)) |>
  mutate(StolenPropertyOffenses = rowSums(across(V20061:V20063))) |>
  select(ORI , StolenPropertyOffenses)
DamageVandalismOfProperty290 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(290) Destruction/Damage/Vandalism of Property", na.rm = TRUE)) |>
  mutate(DamageVandalismOfProperty = rowSums(across(V20061:V20063))) |>
  select(ORI , DamageVandalismOfProperty)
DrugViolations351 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(351) Drug/Narcotic Violations", na.rm = TRUE)) |>
  mutate(DrugViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugViolations)
DrugEquipmentViolations352 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(352) Drug Equipment Violations", na.rm = TRUE)) |>
  mutate(DrugEquipmentViolations = rowSums(across(V20061:V20063))) |>
  select(ORI , DrugEquipmentViolations)
#Incest361 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(361) Incest", na.rm = TRUE)) |>
  #mutate(Incest = rowSums(across(V20061:V20063))) |>
  #select(ORI , Incest)
#StatRape362 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(362) Statutory Rape", na.rm = TRUE)) |>
  #mutate(StatRape = rowSums(across(V20061:V20063))) |>
  #select(ORI , StatRape)
#Pornography370 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(370) Pornography/Obscene Material", na.rm = TRUE)) |>
  #mutate(Pornography = rowSums(across(V20061:V20063))) |>
  #select(ORI , Pornography)
#BettingWagering391 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(391) Betting/Wagering", na.rm = TRUE)) |>
  #mutate(BettingWagering = rowSums(across(V20061:V20063))) |>
  #select(ORI , BettingWagering)
#AssistingGambling392 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(392) Operating/Promoting/Assisting Gambling", na.rm = TRUE)) |>
  #mutate(AssistingGambling = rowSums(across(V20061:V20063))) |>
  #select(ORI , AssistingGambling)
#GamblingEquipmentViols393 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(393) Gambling Equipment Violations", na.rm = TRUE)) |>
  #mutate(GamblingEquipmentViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , GamblingEquipmentViols)
#SportsTampering394 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(394) Sports Tampering", na.rm = TRUE)) |>
  #mutate(SportsTampering = rowSums(across(V20061:V20063))) |>
  #select(ORI , SportsTampering)
Prostitution401 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(401) Prostitution", na.rm = TRUE)) |>
  mutate(Prostitution = rowSums(across(V20061:V20063))) |>
  select(ORI , Prostitution)
AssistPromoteProstitution402 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(402) Assisting or Promoting Prostitution", na.rm = TRUE)) |>
  mutate(AssistPromoteProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , AssistPromoteProstitution)
PurchaseProstitution403 <- da2018_0003_1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(403) Purchasing Prostitution", na.rm = TRUE)) |>
  mutate(PurchaseProstitution = rowSums(across(V20061:V20063))) |>
  select(ORI , PurchaseProstitution)
#Bribery510 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(510) Bribery", na.rm = TRUE)) |>
  #mutate(Bribery = rowSums(across(V20061:V20063))) |>
  #select(ORI , Bribery)
#WeaponViols520 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(520) Weapon Law Violations", na.rm = TRUE)) |>
  #mutate(WeaponViols = rowSums(across(V20061:V20063))) |>
  #select(ORI , WeaponViols)
#HumanSexTrafficking641 <- da2018_0003_1 |>
  #group_by(ORI) |>
  #summarise_all(~ sum(.=="(641) Human Trafficking- Commercial Sex Acts", na.rm = TRUE)) |>
  #mutate(HumanSexTrafficking = rowSums(across(V20061:V20063))) |>
  #select(ORI , HumanSexTrafficking)

#Create a data.frame that is a collection of all crime counts:
CrimeSummary2018 <- 
  cbind(Population, Incidents , Offenses , MurderNonNegManslaughter91 , NegManslaughter92 , JustifiableHomicide93 , Kidnaping_Abduction100 , Rape111 , Sodomy112 , SexAssaultObject113  , Fondling_ChildMolest114 , Robbery120 , AggAssault131 , SimpleAssault132 , Intimidation133, BurglaryBreakingEntering220, PocketPicking231 , PurseSnatching232, Shoplifting233 , TheftFromBuilding234 , TheftMachineDevice235 , TheftFromVehicle236 , TheftOfVehicleOrParts237 , AllOtherLarceny238 , VehicleTheft240 , CounterfeitingForgery250 , SwindleConGame261 , CC_ATMFraud262 , Impersonation263 , WelfareFraud264 , IdentityTheft266 , HackingComputerInvasion267, Embezzlement270 , StolenPropertyOffenses280, DamageVandalismOfProperty290 , DrugViolations351 , DrugEquipmentViolations352 , Prostitution401 , AssistPromoteProstitution402, PurchaseProstitution403)

#Save this data.frame
save(CrimeSummary2018 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeSummary2018.Rda")

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeSummary2018_1 <- CrimeSummary2018 |>
  select(Population, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeSummary2018_2 <- CrimeSummary2018_1 |>
  cbind(Incidents)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeSummary2018_3 <- CrimeSummary2018_2 |>
  relocate(TotIncidents , .before = TotCrimeCount) |>
  relocate(ORI , .before = TotIncidents)

#Save this data.frame
save(CrimeSummary2018_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeSummary2018_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2019_crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001
 
#Insert FIPS value and place it at the front of the data.frame
CrimeSummary2018_4 <-
  left_join(CrimeSummary2018_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeSummary2018_5 <- CrimeSummary2018_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeSummary2018_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeSummary2018_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total populations and crime counts for all law enforcement agencies reporting in any particular county. So, assuming the data is accurate, if all LEAs in a county reported, I would get a count of all crimes in that county and the county's population. If not all LEAs in a county reported, I would get a count of all crimes and the population within the coverage area of the reporting LEAs.
CrimeCount2018 <- CrimeSummary2018_5 |>
  group_by(FIPS) |>
  summarise_at(vars(Population , TotIncidents:PurchaseProstitution) , list(sum))

save(CrimeCount2018 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeCount2018.Rda")

#Load and view 2018 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeCount2018.Rda")
View(CrimeCount2018)

#Transform Crime2018, which has crime counts, into Crime2018, which will have crime rates (i.e. crime counts / population):
Crime2018 <- CrimeCount2018 |>
  transform(TotIncidents, TotIncidents = TotIncidents / Population) |>
  transform(TotCrimeCount, TotCrimeCount = TotCrimeCount / Population) |>
  transform(MurderNonNegManslaughter, MurderNonNegManslaughter = MurderNonNegManslaughter / Population) |>
  transform(NegManslaughter , NegManslaughter = NegManslaughter / Population) |>
  transform(JustifiableHomicide , JustifiableHomicide = JustifiableHomicide / Population) |>
  transform(Kidnaping_Abduction , Kidnaping_Abduction = Kidnaping_Abduction / Population) |>
  transform(Rape , Rape = Rape / Population) |>
  transform(Sodomy , Sodomy = Sodomy / Population) |>
  transform(SexAssaultObject , SexAssaultObject = SexAssaultObject / Population) |>
  transform(Fondling_ChildMolest , Fondling_ChildMolest = Fondling_ChildMolest / Population) |>
  transform(Robbery , Robbery = Robbery / Population) |>
  transform(AggAssault , AggAssault = AggAssault / Population) |>
  transform(TotSimpleAssaults , TotSimpleAssaults = TotSimpleAssaults / Population) |>
  transform(Intimidation , Intimidation = Intimidation / Population) |>
  transform(BurglaryBreakingEntering , BurglaryBreakingEntering = BurglaryBreakingEntering / Population) |>
  transform(PocketPicking , PocketPicking = PocketPicking / Population) |>
  transform(PurseSnatching , PurseSnatching = PurseSnatching / Population) |>
  transform(Shoplifting , Shoplifting = Shoplifting / Population) |>
  transform(TheftFromBuilding , TheftFromBuilding = TheftFromBuilding / Population) |>
  transform(TheftMachineDevice , TheftMachineDevice = TheftMachineDevice / Population) |>
  transform(TheftFromVehicle , TheftFromVehicle = TheftFromVehicle / Population) |>
  transform(TheftOfVehicleOrParts , TheftOfVehicleOrParts = TheftOfVehicleOrParts / Population) |>
  transform(AllOtherLarceny , AllOtherLarceny = AllOtherLarceny / Population) |>
  transform(VehicleTheft , VehicleTheft = VehicleTheft / Population) |>
  transform(CounterfeitingForgery , CounterfeitingForgery = CounterfeitingForgery / Population) |>
  transform(SwindleConGame , SwindleConGame = SwindleConGame / Population) |>
  transform(CC_ATMFraud , CC_ATMFraud = CC_ATMFraud / Population) |>
  transform(Impersonation , Impersonation = Impersonation / Population) |>
  transform(WelfareFraud , WelfareFraud = WelfareFraud / Population) |>
  transform(IdentityTheft , IdentityTheft = IdentityTheft / Population) |>
  transform(HackingComputerInvasion , HackingComputerInvasion = HackingComputerInvasion / Population) |>
  transform(Embezzlement , Embezzlement = Embezzlement / Population) |>
  transform(StolenPropertyOffenses , StolenPropertyOffenses = StolenPropertyOffenses / Population) |>
  transform(DamageVandalismOfProperty , DamageVandalismOfProperty = DamageVandalismOfProperty / Population) |>
  transform(DrugViolations , DrugViolations = DrugViolations / Population) |>
  transform(DrugEquipmentViolations , DrugEquipmentViolations = DrugEquipmentViolations / Population) |>
  transform(Prostitution , Prostitution = Prostitution / Population) |>
  transform(AssistPromoteProstitution , AssistPromoteProstitution = AssistPromoteProstitution / Population) |>
  transform(PurchaseProstitution , PurchaseProstitution = PurchaseProstitution / Population)

Crime2018 <- Crime2018 |>
  select(FIPS, Population, TotIncidents, TotCrimeCount , MurderNonNegManslaughter , NegManslaughter , JustifiableHomicide , Kidnaping_Abduction , Rape , Sodomy , SexAssaultObject  , Fondling_ChildMolest , Robbery , AggAssault , TotSimpleAssaults , Intimidation, BurglaryBreakingEntering, PocketPicking , PurseSnatching, Shoplifting , TheftFromBuilding , TheftMachineDevice , TheftFromVehicle , TheftOfVehicleOrParts , AllOtherLarceny , VehicleTheft , CounterfeitingForgery , SwindleConGame , CC_ATMFraud , Impersonation , WelfareFraud , IdentityTheft , HackingComputerInvasion, Embezzlement , StolenPropertyOffenses, DamageVandalismOfProperty , DrugViolations , DrugEquipmentViolations , Prostitution , AssistPromoteProstitution, PurchaseProstitution) |>
  filter(Population != "0")

save(Crime2018 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/Crime2018.Rda")

#The resulting Crime2018 dataset contains crime rates at the "pseudo-county" level, which means this: I took all LEAs that adopted NIBRS prior to 2018 and reported to NIBRS in all 12 months of 2018, summed their absolute crime counts in various categories of crime, summed those sums by county, and had as a result one number as an absolute crime count for various crime types which is the number of those crimes/incidents that were reported by all LEAs that reported to NIBRS in a particular county. I then took "Current Population 1" as the population reported by the reporting LEAs. I assume that this population number is the population covered by the reporting LEA; I am trying to confirm this, but haven't been able to do so yet. I then divided the crime counts by population to get a crime rate: for example, 10 incidents in a population of 100 would yield an incident rate of .10. These crime rates are the rates of crime within the jurisdiction of all reporting LEAs, gathered at the county level. Some counties have all of their LEAs reporting, so that my crime rates = the crime rate for the entire county. Other counties only have some of their LEAs reporting, so that my crime rates are a subset of county crime rates--thus my data is at the "pseudo-county" level. Does this data gathering imply bias? If LEAs are more or less likely to report to NIBRS based on whether they have a high or low crime rate, then the answer may be yes. The remedy is to consider data only from counties in which all LEAs reported, making my crime rate = the county's crime rate. But the same bias would exist here, the question just wouldn't be whether *LEAs* are more or less likely to report based on whether they have a high or low crime rate, but whether *counties* as a whole are similarly more or less likely to report.
```

```{r message=FALSE, warning=FALSE}
#Each of the five crime datasets are of different lengths, with different numbers of FIPS/observations. Here, I reduce them all to their common observations.
#Compile all year data frames
CrimeAll <- do.call(
  rbind,
  lapply(
    2018:2022, \(yr)
      within(get(paste0("Crime", yr)), { year <- yr })
  )
)

#Assign and subset counties in all 5 years
CrimeAll <- within(
  CrimeAll, { county_n <- ave(year, FIPS, FUN=length) }
) |> subset(
  subset = county_n == 5, select = -county_n
)

# BUILD LIST OF YEAR SPLIT DATA FRAMES
CrimeList <- split(CrimeAll, CrimeAll$year)

CrimeList$`2018`
CrimeList$`2019`
CrimeList$`2020`
CrimeList$`2021`
CrimeList$`2022`

#Now, I have a list of Crime counts by year, each of which having 1,484 observations, all appearing to be identical. I can access each year like a data frame by using <<CrimeList[["YEAR"]]>>. But I don't like this, so I changed that name to something more palatable:

Crime2022 <- CrimeList[["2022"]]
Crime2021 <- CrimeList[["2021"]]
Crime2020 <- CrimeList[["2020"]]
Crime2019 <- CrimeList[["2019"]]
Crime2018 <- CrimeList[["2018"]]
```

```{r message=FALSE, warning=FALSE}
#Import Gini data, 2018-2022
Gini <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/Gini.xlsx")
Gini$FIPS = formatC(Gini$FIPS, digits = 4, format = "d", flag = "0")
View(Gini)
```

```{r message=FALSE, warning=FALSE}
#Import S1901 income data, 2018-2022
S1901Income2018 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1901Income2018.xlsx")
S1901Income2018$FIPS = formatC(S1901Income2018$FIPS, digits = 4, format = "d", flag = "0")

S1901Income2019 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1901Income2019.xlsx")
S1901Income2019$FIPS = formatC(S1901Income2019$FIPS, digits = 4, format = "d", flag = "0")

S1901Income2020 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1901Income2020.xlsx")
S1901Income2020$FIPS = formatC(S1901Income2020$FIPS, digits = 4, format = "d", flag = "0")

S1901Income2021 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1901Income2021.xlsx")
S1901Income2021$FIPS = formatC(S1901Income2021$FIPS, digits = 4, format = "d", flag = "0")

S1901Income2022 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1901Income2022.xlsx")
S1901Income2022$FIPS = formatC(S1901Income2022$FIPS, digits = 4, format = "d", flag = "0")

#Each of the five income datasets are of different lengths, with different numbers of FIPS/observations. Here, I reduce them all to their common observations.
#Compile all year data frames
S1901IncomeAll <- do.call(
  rbind,
  lapply(
    2018:2022, \(yr)
      within(get(paste0("S1901Income", yr)), { year <- yr })
  )
)

#Assign and subset counties in all 5 years
S1901IncomeAll <- within(
  S1901IncomeAll, { county_n <- ave(year, FIPS, FUN=length) }
) |> subset(
  subset = county_n == 5, select = -county_n
)

# BUILD LIST OF YEAR SPLIT DATA FRAMES
S1901IncomeList <- split(S1901IncomeAll, S1901IncomeAll$year)

S1901IncomeList$`2018`
S1901IncomeList$`2019`
S1901IncomeList$`2020`
S1901IncomeList$`2021`
S1901IncomeList$`2022`

S1901Income2022 <- S1901IncomeList[["2022"]]
S1901Income2021 <- S1901IncomeList[["2021"]]
S1901Income2020 <- S1901IncomeList[["2020"]]
S1901Income2019 <- S1901IncomeList[["2019"]]
S1901Income2018 <- S1901IncomeList[["2018"]]
```

```{r}
#Import S1903 income data, 2018-2022
S1903Income2018 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1903Income2018.xlsx")
S1903Income2018$FIPS = formatC(S1903Income2018$FIPS, digits = 4, format = "d", flag = "0")

S1903Income2019 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1903Income2019.xlsx")
S1903Income2019$FIPS = formatC(S1903Income2019$FIPS, digits = 4, format = "d", flag = "0")

S1903Income2020 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1903Income2020.xlsx")
S1903Income2020$FIPS = formatC(S1903Income2020$FIPS, digits = 4, format = "d", flag = "0")

S1903Income2021 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1903Income2021.xlsx")
S1903Income2021$FIPS = formatC(S1903Income2021$FIPS, digits = 4, format = "d", flag = "0")

S1903Income2022 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/S1903Income2022.xlsx")
S1903Income2022$FIPS = formatC(S1903Income2022$FIPS, digits = 4, format = "d", flag = "0")

#Each of the five income datasets are of different lengths, with different numbers of FIPS/observations. Here, I reduce them all to their common observations.
#Compile all year data frames
S1903IncomeAll <- do.call(
  rbind,
  lapply(
    2018:2022, \(yr)
      within(get(paste0("S1903Income", yr)), { year <- yr })
  )
)

#Assign and subset counties in all 5 years
S1903IncomeAll <- within(
  S1903IncomeAll, { county_n <- ave(year, FIPS, FUN=length) }
) |> subset(
  subset = county_n == 5, select = -county_n
)

# BUILD LIST OF YEAR SPLIT DATA FRAMES
S1903IncomeList <- split(S1903IncomeAll, S1903IncomeAll$year)

S1903IncomeList$`2018`
S1903IncomeList$`2019`
S1903IncomeList$`2020`
S1903IncomeList$`2021`
S1903IncomeList$`2022`

S1903Income2022 <- S1903IncomeList[["2022"]]
S1903Income2021 <- S1903IncomeList[["2021"]]
S1903Income2020 <- S1903IncomeList[["2020"]]
S1903Income2019 <- S1903IncomeList[["2019"]]
S1903Income2018 <- S1903IncomeList[["2018"]]
```

```{r}
#Create data frame with race info re victims and offenders, 2022:

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/38925-0003-Data.rda")
da2022_0003 <- da38925.0003

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2022_0003_race <- da2022_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH040 , V40201 , V40202 , V40203 , V50091 , V50092 , V50093) |>
  filter(BH040 == "12")

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2022_0003_race$BH006 <- dmy(da2022_0003_race$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:
da2022_0003_race2 <- da2022_0003_race |>
  filter(BH006 < "2018-01-01")

da2022_0003_race1 <- da2022_0003_race2 |>
  select(STATE , ORI , INCNUM , V40201 , V40202 , V40203 , V50091 , V50092 , V50093)

#Create new crime dataset for 2022 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )
WhiteVictim <- da2022_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , WhiteVictim)
BlackVictim <- da2022_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , BlackVictim)
WhiteOffender <- da2022_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , WhiteOffender)
BlackOffender <- da2022_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , BlackOffender)

#Create a data.frame that is a collection of all crime counts:
CrimeRaceSummary2022 <- 
  cbind(WhiteVictim , BlackVictim , WhiteOffender , BlackOffender)

#Save this data.frame
save(CrimeRaceSummary2022 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/CrimeRaceSummary2022.Rda")

#CONTINUE HERE

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeRaceSummary2022_1 <- CrimeRaceSummary2022 |>
  select(BlackVictim , WhiteOffender , BlackOffender)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeRaceSummary2022_2 <- CrimeRaceSummary2022_1 |>
  cbind(WhiteVictim)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeRaceSummary2022_3 <- CrimeRaceSummary2022_2 |>
  relocate(WhiteVictim , .before = BlackVictim) |>
  relocate(ORI , .before = WhiteVictim)

#Save this data.frame
save(CrimeRaceSummary2022_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/CrimeRaceSummary2022_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2022_crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001

#Insert FIPS value and place it at the front of the data.frame
CrimeRaceSummary2022_4 <-
  left_join(CrimeRaceSummary2022_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeRaceSummary2022_5 <- CrimeRaceSummary2022_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeRaceSummary2022_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/CrimeRaceSummary2022_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total crime counts for 2022 for each county as defined by FIPS
CrimeRace2022 <- CrimeRaceSummary2022_5 |>
  group_by(FIPS) |>
  summarise_at(vars(WhiteVictim:BlackOffender) , list(sum))

save(CrimeRace2022 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/CrimeRace2022.Rda")

#Load and view 2022 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38925_2022/DS0003/CrimeRace2022.Rda")
View(CrimeRace2022)

```

```{r}
#Create data frame with race info re victims and offenders, 2021:

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/38807-0003-Data.rda")
da2021_0003 <- da38807.0003

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2021_0003_race <- da2021_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH040 , V40201 , V40202 , V40203 , V50091 , V50092 , V50093) |>
  filter(BH040 == "12")

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2021_0003_race$BH006 <- dmy(da2021_0003_race$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:
da2021_0003_race2 <- da2021_0003_race |>
  filter(BH006 < "2018-01-01")

da2021_0003_race1 <- da2021_0003_race2 |>
  select(STATE , ORI , INCNUM , V40201 , V40202 , V40203 , V50091 , V50092 , V50093)

#Create new crime dataset for 2021 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )
WhiteVictim <- da2021_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , WhiteVictim)
BlackVictim <- da2021_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , BlackVictim)
WhiteOffender <- da2021_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , WhiteOffender)
BlackOffender <- da2021_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , BlackOffender)

#Create a data.frame that is a collection of all crime counts:
CrimeRaceSummary2021 <- 
  cbind(WhiteVictim , BlackVictim , WhiteOffender , BlackOffender)

#Save this data.frame
save(CrimeRaceSummary2021 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeRaceSummary2021.Rda")

#CONTINUE HERE

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeRaceSummary2021_1 <- CrimeRaceSummary2021 |>
  select(BlackVictim , WhiteOffender , BlackOffender)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeRaceSummary2021_2 <- CrimeRaceSummary2021_1 |>
  cbind(WhiteVictim)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeRaceSummary2021_3 <- CrimeRaceSummary2021_2 |>
  relocate(WhiteVictim , .before = BlackVictim) |>
  relocate(ORI , .before = WhiteVictim)

#Save this data.frame
save(CrimeRaceSummary2021_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeRaceSummary2021_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2019_crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001

#Insert FIPS value and place it at the front of the data.frame
CrimeRaceSummary2021_4 <-
  left_join(CrimeRaceSummary2021_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeRaceSummary2021_5 <- CrimeRaceSummary2021_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeRaceSummary2021_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeRaceSummary2021_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total crime counts for 2021 for each county as defined by FIPS
CrimeRace2021 <- CrimeRaceSummary2021_5 |>
  group_by(FIPS) |>
  summarise_at(vars(WhiteVictim:BlackOffender) , list(sum))

save(CrimeRace2021 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeRace2021.Rda")

#Load and view 2021 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38807_2021/DS0003/CrimeRace2021.Rda")
View(CrimeRace2021)

```

```{r}
#Create data frame with race info re victims and offenders, 2020:

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/38566-0003-Data.rda")
da2020_0003 <- da38566.0003

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2020_0003_race <- da2020_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH040 , V40201 , V40202 , V40203 , V50091 , V50092 , V50093) |>
  filter(BH040 == "12")

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2020_0003_race$BH006 <- dmy(da2020_0003_race$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:
da2020_0003_race2 <- da2020_0003_race |>
  filter(BH006 < "2018-01-01")

da2020_0003_race1 <- da2020_0003_race2 |>
  select(STATE , ORI , INCNUM , V40201 , V40202 , V40203 , V50091 , V50092 , V50093)

#Create new crime dataset for 2020 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )
WhiteVictim <- da2020_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , WhiteVictim)
BlackVictim <- da2020_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , BlackVictim)
WhiteOffender <- da2020_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , WhiteOffender)
BlackOffender <- da2020_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , BlackOffender)

#Create a data.frame that is a collection of all crime counts:
CrimeRaceSummary2020 <- 
  cbind(WhiteVictim , BlackVictim , WhiteOffender , BlackOffender)

#Save this data.frame
save(CrimeRaceSummary2020 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeRaceSummary2020.Rda")

#CONTINUE HERE

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeRaceSummary2020_1 <- CrimeRaceSummary2020 |>
  select(BlackVictim , WhiteOffender , BlackOffender)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeRaceSummary2020_2 <- CrimeRaceSummary2020_1 |>
  cbind(WhiteVictim)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeRaceSummary2020_3 <- CrimeRaceSummary2020_2 |>
  relocate(WhiteVictim , .before = BlackVictim) |>
  relocate(ORI , .before = WhiteVictim)

#Save this data.frame
save(CrimeRaceSummary2020_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeRaceSummary2020_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2019_crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001

#Insert FIPS value and place it at the front of the data.frame
CrimeRaceSummary2020_4 <-
  left_join(CrimeRaceSummary2020_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeRaceSummary2020_5 <- CrimeRaceSummary2020_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeRaceSummary2020_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeRaceSummary2020_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total crime counts for 2020 for each county as defined by FIPS
CrimeRace2020 <- CrimeRaceSummary2020_5 |>
  group_by(FIPS) |>
  summarise_at(vars(WhiteVictim:BlackOffender) , list(sum))

save(CrimeRace2020 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeRace2020.Rda")

#Load and view 2020 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38566_2020/DS0003/CrimeRace2020.Rda")
View(CrimeRace2020)

```


```{r}
#Create data frame with race info re victims and offenders, 2019:

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/38565-0003-Data.rda")
da2019_0003 <- da38565.0003

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2019_0003_race <- da2019_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH040 , V40201 , V40202 , V40203 , V50091 , V50092 , V50093) |>
  filter(BH040 == "12")

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2019_0003_race$BH006 <- dmy(da2019_0003_race$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:
da2019_0003_race2 <- da2019_0003_race |>
  filter(BH006 < "2018-01-01")

da2019_0003_race1 <- da2019_0003_race2 |>
  select(STATE , ORI , INCNUM , V40201 , V40202 , V40203 , V50091 , V50092 , V50093)

#Create new crime dataset for 2019 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )
WhiteVictim <- da2019_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , WhiteVictim)
BlackVictim <- da2019_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , BlackVictim)
WhiteOffender <- da2019_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , WhiteOffender)
BlackOffender <- da2019_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , BlackOffender)

#Create a data.frame that is a collection of all crime counts:
CrimeRaceSummary2019 <- 
  cbind(WhiteVictim , BlackVictim , WhiteOffender , BlackOffender)

#Save this data.frame
save(CrimeRaceSummary2019 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeRaceSummary2019.Rda")

#CONTINUE HERE

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeRaceSummary2019_1 <- CrimeRaceSummary2019 |>
  select(BlackVictim , WhiteOffender , BlackOffender)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeRaceSummary2019_2 <- CrimeRaceSummary2019_1 |>
  cbind(WhiteVictim)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeRaceSummary2019_3 <- CrimeRaceSummary2019_2 |>
  relocate(WhiteVictim , .before = BlackVictim) |>
  relocate(ORI , .before = WhiteVictim)

#Save this data.frame
save(CrimeRaceSummary2019_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeRaceSummary2019_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2019_crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001

#Insert FIPS value and place it at the front of the data.frame
CrimeRaceSummary2019_4 <-
  left_join(CrimeRaceSummary2019_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeRaceSummary2019_5 <- CrimeRaceSummary2019_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeRaceSummary2019_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeRaceSummary2019_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total crime counts for 2019 for each county as defined by FIPS
CrimeRace2019 <- CrimeRaceSummary2019_5 |>
  group_by(FIPS) |>
  summarise_at(vars(WhiteVictim:BlackOffender) , list(sum))

save(CrimeRace2019 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeRace2019.Rda")

#Load and view 2019 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_38565_2019/DS0003/CrimeRace2019.Rda")
View(CrimeRace2019)

```


```{r}
#Create data frame with race info re victims and offenders, 2018:

load(file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/37649-0003-Data.rda")
da2018_0003 <- da37649.0003

#Select relevant variables
#Include only observations with 12 months of reporting (to maximize change of full participation in NIBRS)
da2018_0003_race <- da2018_0003 |>
  select(STATE , ORI , INCNUM , BH006 , BH040 , V40201 , V40202 , V40203 , V50091 , V50092 , V50093) |>
  filter(BH040 == "12")

#Change BH006, the date ORI went NIBRS, from a factor to a date
da2018_0003_race$BH006 <- dmy(da2018_0003_race$BH006)

#Select all incidents/observations that came from agencies that began to submit data to NIBRS prior to Jan. 1, 2028, and exclude all others:
da2018_0003_race2 <- da2018_0003_race |>
  filter(BH006 < "2018-01-01")

da2018_0003_race1 <- da2018_0003_race2 |>
  select(STATE , ORI , INCNUM , V40201 , V40202 , V40203 , V50091 , V50092 , V50093)

#Create new crime dataset for 2018 with crime counts per ORI: 
  #total incidents (regardless of number of crimes per incident) = Incidents; 
  #total crime counts (counting all crimes across all incidents) = Offenses; 
  #crime counts by specific crime and NIBRS number (rape, for example), ex. = "SimpleAssault132) (I exclude crimes that are unlikely to be affected by inequality, that have been reported to be unreliable with NIBRS extract data, and that usually take place across counties, like wire fraud )
WhiteVictim <- da2018_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , WhiteVictim)
BlackVictim <- da2018_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackVictim = rowSums(across(V40201:V40203))) |>
  select(ORI , BlackVictim)
WhiteOffender <- da2018_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(1) White", na.rm = TRUE)) |>
  mutate(WhiteOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , WhiteOffender)
BlackOffender <- da2018_0003_race1 |>
  group_by(ORI) |>
  summarise_all(~ sum(.=="(2) Black or African American", na.rm = TRUE)) |>
  mutate(BlackOffender = rowSums(across(V50091:V50093))) |>
  select(ORI , BlackOffender)

#Create a data.frame that is a collection of all crime counts:
CrimeRaceSummary2018 <- 
  cbind(WhiteVictim , BlackVictim , WhiteOffender , BlackOffender)

#Save this data.frame
save(CrimeRaceSummary2018 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeRaceSummary2018.Rda")

#CONTINUE HERE

#Create a data.frame that is a collection of all crime counts with the redundant ORI columns eliminated (I had to eliminate the Incidents dataset, which contained an ORI value and TotIncidents value)
CrimeRaceSummary2018_1 <- CrimeRaceSummary2018 |>
  select(BlackVictim , WhiteOffender , BlackOffender)

#Reinsert the Incidents dataset, which has an ORI value and TotIncidents value:
CrimeRaceSummary2018_2 <- CrimeRaceSummary2018_1 |>
  cbind(WhiteVictim)

#Put the ORI and TotIncidents values first in the data.frame:
CrimeRaceSummary2018_3 <- CrimeRaceSummary2018_2 |>
  relocate(WhiteVictim , .before = BlackVictim) |>
  relocate(ORI , .before = WhiteVictim)

#Save this data.frame
save(CrimeRaceSummary2018_3 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeRaceSummary2018_3.Rda")

#Load Crosswalk to obtain FIPS values per ORI values
load(file = "/Users/steve/OneDrive/Desktop/2019 _crime_datasets/crosswalk_data.rda")
crosswalk <- da35158.0001

#Insert FIPS value and place it at the front of the data.frame
CrimeRaceSummary2018_4 <-
  left_join(CrimeRaceSummary2018_3,
            crosswalk |> select(ORI9, FIPS),
            by = c("ORI" = "ORI9"))
CrimeRaceSummary2018_5 <- CrimeRaceSummary2018_4 |>
            relocate(FIPS , .before = ORI)

#Save this data.frame
save(CrimeRaceSummary2018_5 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeRaceSummary2018_5.Rda")

#Sum all crime values to the aggregated county level using FIPS. This gets me total crime counts for 2018 for each county as defined by FIPS
CrimeRace2018 <- CrimeRaceSummary2018_5 |>
  group_by(FIPS) |>
  summarise_at(vars(WhiteVictim:BlackOffender) , list(sum))

save(CrimeRace2018 , file = "/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeRace2018.Rda")

#Load and view 2018 crime dataset, with FIPS included
load("/Users/steve/OneDrive/Desktop/crime_data/ICPSR_37649_2018/DS0003/CrimeRace2018.Rda")
View(CrimeRace2018)

```

```{r}
save(CrimeRace2018 , file = ("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2018.Rda"))

save(CrimeRace2019 , file = ("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2019.Rda"))

save(CrimeRace2020 , file = ("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2020.Rda"))

save(CrimeRace2021 , file = ("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2021.Rda"))

save(CrimeRace2022 , file = ("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2022.Rda"))
```

``` {r}
#Each of the five crime race datasets are of different lengths, with different numbers of FIPS/observations. Here, I reduce them all to their common observations.
#Compile all year data frames
CrimeRaceAll <- do.call(
  rbind,
  lapply(
    2018:2022, \(yr)
      within(get(paste0("CrimeRace", yr)), { year <- yr })
  )
)

#Assign and subset counties in all 5 years
CrimeRaceAll <- within(
  CrimeRaceAll, { county_n <- ave(year, FIPS, FUN=length) }
) |> subset(
  subset = county_n == 5, select = -county_n
)

# BUILD LIST OF YEAR SPLIT DATA FRAMES
CrimeRaceList <- split(CrimeRaceAll, CrimeRaceAll$year)

CrimeRaceList$`2018`
CrimeRaceList$`2019`
CrimeRaceList$`2020`
CrimeRaceList$`2021`
CrimeRaceList$`2022`

#Now, I have a list of Crime counts by year, each of which having 1,484 observations, all appearing to be identical. I can access each year like a data frame by using <<CrimeList[["YEAR"]]>>. But I don't like this, so I changed that name to something more palatable:

CrimeRace2018 <- CrimeRaceList[["2018"]]
CrimeRace2019 <- CrimeRaceList[["2019"]]
CrimeRace2020 <- CrimeRaceList[["2020"]]
CrimeRace2021 <- CrimeRaceList[["2021"]]
CrimeRace2022 <- CrimeRaceList[["2022"]]
```

```{r}
#Create a vector of data frame names
DatasetNames <- c("Crime2018" , "Crime2019" , "Crime2020" , "Crime2021" , "Crime2022" , "Gini" , "S1901Income2018" , "S1901Income2019" , "S1901Income2020" , "S1901Income2021" , "S1901Income2022" , "S1903Income2018" , "S1903Income2019" , "S1903Income2020" , "S1903Income2021" , "S1903Income2019" , "CrimeRace2018" , "CrimeRace2019" , "CrimeRace2020" , "CrimeRace2021" , "CrimeRace2022")
#Use this to create a named list of data frames
DataList <- setNames(
  lapply(DatasetNames , get),
  DatasetNames
)
#Create a vector with the common values of FIPS
common_fips <- Reduce(
  intersect,
  lapply(DataList, \(x) x$FIPS)
)
#Create subset of only the common rows of each data frame in the list
NewDataList <- lapply(DataList, function(x) x[x$FIPS %in% common_fips, ])

#Rename data frames in datalist
Crime2018 <- NewDataList[["Crime2018"]]
Crime2019 <- NewDataList[["Crime2019"]]
Crime2020 <- NewDataList[["Crime2020"]]
Crime2021 <- NewDataList[["Crime2021"]]
Crime2022 <- NewDataList[["Crime2022"]]
Gini <- NewDataList[["Gini"]]
S1901Income2018 <- NewDataList[["S1901Income2018"]]
S1901Income2019 <- NewDataList[["S1901Income2019"]]
S1901Income2020 <- NewDataList[["S1901Income2020"]]
S1901Income2021 <- NewDataList[["S1901Income2021"]]
S1901Income2022 <- NewDataList[["S1901Income2022"]]
S1903Income2018 <- NewDataList[["S1903Income2018"]]
S1903Income2019 <- NewDataList[["S1903Income2019"]]
S1903Income2020 <- NewDataList[["S1903Income2020"]]
S1903Income2021 <- NewDataList[["S1903Income2021"]]
S1903Income2022 <- NewDataList[["S1903Income2022"]]
CrimeRace2018 <- NewDataList[["CrimeRace2018"]]
CrimeRace2019 <- NewDataList[["CrimeRace2019"]]
CrimeRace2020 <- NewDataList[["CrimeRace2020"]]
CrimeRace2021 <- NewDataList[["CrimeRace2021"]]
CrimeRace2022 <- NewDataList[["CrimeRace2022"]]
```

```{r}
save(Crime2018 , file = "/Users/steve/OneDrive/Desktop/DataMaster/Crime2018.Rda")

save(Crime2019 , file = "/Users/steve/OneDrive/Desktop/DataMaster/Crime2019.Rda")

save(Crime2020 , file = "/Users/steve/OneDrive/Desktop/DataMaster/Crime2020.Rda")

save(Crime2021 , file = "/Users/steve/OneDrive/Desktop/DataMaster/Crime2021.Rda")

save(Crime2022 , file = "/Users/steve/OneDrive/Desktop/DataMaster/Crime2022.Rda")

save(Gini , file = "/Users/steve/OneDrive/Desktop/DataMaster/Gini.Rda")

save(S1901Income2018 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2018.Rda")

save(S1901Income2019 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2019.Rda")

save(S1901Income2020 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2020.Rda")

save(S1901Income2021 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2021.Rda")

save(S1901Income2022 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2022.Rda")

save(S1903Income2018 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2018.Rda")

save(S1903Income2019 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2019.Rda")

save(S1903Income2020 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2020.Rda")

save(S1903Income2021 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2021.Rda")

save(S1903Income2022 , file = "/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2022.Rda")
```

Here, I determine the association between the various crime rates and the Gini coefficient from 2018-2021, using Pearson's moment, Kendall's tau, and Spearman's rho. I then compile them into three spreadsheets, converted to Word, and printed out:

```{r}
#Correlation values: Gini versus crime rates by county, 2022:
Gini2022 <- Gini |>
  select(FIPS , Gini2022)

Crime2022_Gini <- merge(Crime2022 , Gini2022)
Crime2022_Gini <- Crime2022_Gini |>
  select(-FIPS , -year)

#get correlation (Pearson for when variables are normally distributed, but crime rates are not normal, so I use Kendall's Tau):
cor_crime2022_pearson <- cor_mat(Crime2022_Gini , method = "pearson" , conf.level = 0.95)

cor_crime2022_kendall <- cor_mat(Crime2022_Gini , method = "kendall" , conf.level = 0.95)

cor_crime2022_spearman <- cor_mat(Crime2022_Gini , method = "spearman" , conf.level = 0.95)

#get p-value
pval_pearson <- cor_get_pval(cor_crime2022_pearson)
pval_kendall <- cor_get_pval(cor_crime2022_kendall)
pval_spearman <- cor_get_pval(cor_crime2022_spearman)

#Extract Gini and p-value lines from data frames
cor_pearson_2022 <- cor_crime2022_pearson |>
  select(Gini2022) |>
  rename(c_p_22 = Gini2022)

pval_pearson_2022 <- pval_pearson |>
  select(Gini2022) |>
  rename(p_p_22 = Gini2022)

cor_kendall_2022 <- cor_crime2022_kendall |>
  select(Gini2022) |>
  rename(c_k_22 = Gini2022)
  
pval_kendall_2022 <- pval_kendall |>
  select(Gini2022) |>
  rename(p_k_22 = Gini2022)

cor_spearman_2022 <- cor_crime2022_spearman |>
  select(Gini2022) |>
  rename(c_s_22 = Gini2022)

pval_spearman_2022 <- pval_spearman |>
  select(Gini2022) |>
  rename(p_s_2022 = Gini2022)

#join Gini and p-value lines together
Gini_data_2022 <- cbind(cor_pearson_2022 , pval_pearson_2022 , cor_kendall_2022 , pval_kendall_2022 , cor_spearman_2022 , pval_spearman_2022)

```

```{r}
#Correlation values: Gini versus crime rates by county, 2021:
Gini2021 <- Gini |>
  select(FIPS , Gini2021)

Crime2021_Gini <- merge(Crime2021 , Gini2021)
Crime2021_Gini <- Crime2021_Gini |>
  select(-FIPS , -year)

#get correlation (Pearson for when variables are normally distributed, but crime rates are not normal, so I use Kendall's Tau):
cor_crime2021_pearson <- cor_mat(Crime2021_Gini , method = "pearson" , conf.level = 0.95)

cor_crime2021_kendall <- cor_mat(Crime2021_Gini , method = "kendall" , conf.level = 0.95)

cor_crime2021_spearman <- cor_mat(Crime2021_Gini , method = "spearman" , conf.level = 0.95)

#get p-value
pval_pearson <- cor_get_pval(cor_crime2021_pearson)
pval_kendall <- cor_get_pval(cor_crime2021_kendall)
pval_spearman <- cor_get_pval(cor_crime2021_spearman)

#Extract Gini and p-value lines from data frames
cor_pearson_2021 <- cor_crime2021_pearson |>
  select(Gini2021) |>
  rename(c_p_21 = Gini2021)

pval_pearson_2021 <- pval_pearson |>
  select(Gini2021) |>
  rename(p_p_21 = Gini2021)

cor_kendall_2021 <- cor_crime2021_kendall |>
  select(Gini2021) |>
  rename(c_k_21 = Gini2021)
  
pval_kendall_2021 <- pval_kendall |>
  select(Gini2021) |>
  rename(p_k_21 = Gini2021)

cor_spearman_2021 <- cor_crime2021_spearman |>
  select(Gini2021) |>
  rename(c_s_21 = Gini2021)

pval_spearman_2021 <- pval_spearman |>
  select(Gini2021) |>
  rename(p_s_21 = Gini2021)

#join Gini and p-value lines together
Gini_data_2021 <- cbind(cor_pearson_2021 , pval_pearson_2021 , cor_kendall_2021 , pval_kendall_2021 , cor_spearman_2021 , pval_spearman_2021)
```

```{r}
#Correlation values: Gini versus crime rates by county, 2020:
Gini2020 <- Gini |>
  select(FIPS , Gini2020)

Crime2020_Gini <- merge(Crime2020 , Gini2020)
Crime2020_Gini <- Crime2020_Gini |>
  select(-FIPS , -year)

#get correlation (Pearson for when variables are normally distributed, but crime rates are not normal, so I use Kendall's Tau):
cor_crime2020_pearson <- cor_mat(Crime2020_Gini , method = "pearson" , conf.level = 0.95)

cor_crime2020_kendall <- cor_mat(Crime2020_Gini , method = "kendall" , conf.level = 0.95)

cor_crime2020_spearman <- cor_mat(Crime2020_Gini , method = "spearman" , conf.level = 0.95)

#get p-value
pval_pearson <- cor_get_pval(cor_crime2020_pearson)
pval_kendall <- cor_get_pval(cor_crime2020_kendall)
pval_spearman <- cor_get_pval(cor_crime2020_spearman)

#Extract Gini and p-value lines from data frames
cor_pearson_2020 <- cor_crime2020_pearson |>
  select(Gini2020) |>
  rename(c_p_20 = Gini2020)

pval_pearson_2020 <- pval_pearson |>
  select(Gini2020) |>
  rename(p_p_20 = Gini2020)

cor_kendall_2020 <- cor_crime2020_kendall |>
  select(Gini2020) |>
  rename(c_k_20 = Gini2020)
  
pval_kendall_2020 <- pval_kendall |>
  select(Gini2020) |>
  rename(p_k_20 = Gini2020)

cor_spearman_2020 <- cor_crime2020_spearman |>
  select(Gini2020) |>
  rename(c_s_20 = Gini2020)

pval_spearman_2020 <- pval_spearman |>
  select(Gini2020) |>
  rename(p_s_20 = Gini2020)

#join Gini and p-value lines together
Gini_data_2020 <- cbind(cor_pearson_2020 , pval_pearson_2020 , cor_kendall_2020 , pval_kendall_2020 , cor_spearman_2020 , pval_spearman_2020)
```

```{r}
#Correlation values: Gini versus crime rates by county, 2019:
Gini2019 <- Gini |>
  select(FIPS , Gini2019)

Crime2019_Gini <- merge(Crime2019 , Gini2019)
Crime2019_Gini <- Crime2019_Gini |>
  select(-FIPS , -year)

#get correlation (Pearson for when variables are normally distributed, but crime rates are not normal, so I use Kendall's Tau):
cor_crime2019_pearson <- cor_mat(Crime2019_Gini , method = "pearson" , conf.level = 0.95)

cor_crime2019_kendall <- cor_mat(Crime2019_Gini , method = "kendall" , conf.level = 0.95)

cor_crime2019_spearman <- cor_mat(Crime2019_Gini , method = "spearman" , conf.level = 0.95)

#get p-value
pval_pearson <- cor_get_pval(cor_crime2019_pearson)
pval_kendall <- cor_get_pval(cor_crime2019_kendall)
pval_spearman <- cor_get_pval(cor_crime2019_spearman)

#Extract Gini and p-value lines from data frames
cor_pearson_2019 <- cor_crime2019_pearson |>
  select(Gini2019) |>
  rename(c_p_19 = Gini2019)

pval_pearson_2019 <- pval_pearson |>
  select(Gini2019) |>
  rename(p_p_19 = Gini2019)

cor_kendall_2019 <- cor_crime2019_kendall |>
  select(Gini2019) |>
  rename(c_k_19 = Gini2019)
  
pval_kendall_2019 <- pval_kendall |>
  select(Gini2019) |>
  rename(p_k_19 = Gini2019)

cor_spearman_2019 <- cor_crime2019_spearman |>
  select(Gini2019) |>
  rename(c_s_19 = Gini2019)

pval_spearman_2019 <- pval_spearman |>
  select(Gini2019) |>
  rename(p_s_19 = Gini2019)

#join Gini and p-value lines together
Gini_data_2019 <- cbind(cor_pearson_2019 , pval_pearson_2019 , cor_kendall_2019 , pval_kendall_2019 , cor_spearman_2019 , pval_spearman_2019)
```

```{r}
#Correlation values: Gini versus crime rates by county, 2018:
Gini2018 <- Gini |>
  select(FIPS , Gini2018)

Crime2018_Gini <- merge(Crime2018 , Gini2018)
Crime2018_Gini <- Crime2018_Gini |>
  select(-FIPS , -year)

#get correlation (Pearson for when variables are normally distributed, but crime rates are not normal, so I use Kendall's Tau):
cor_crime2018_pearson <- cor_mat(Crime2018_Gini , method = "pearson" , conf.level = 0.95)

cor_crime2018_kendall <- cor_mat(Crime2018_Gini , method = "kendall" , conf.level = 0.95)

cor_crime2018_spearman <- cor_mat(Crime2018_Gini , method = "spearman" , conf.level = 0.95)

#get p-value
pval_pearson <- cor_get_pval(cor_crime2018_pearson)
pval_kendall <- cor_get_pval(cor_crime2018_kendall)
pval_spearman <- cor_get_pval(cor_crime2018_spearman)

#Extract Gini and p-value lines from data frames
rownames <- cor_crime2018_pearson |>
  select(rowname) |>
  rename(crime_type = rowname)

cor_pearson_2018 <- cor_crime2018_pearson |>
  select(Gini2018) |>
  rename(c_p_18 = Gini2018)

pval_pearson_2018 <- pval_pearson |>
  select(Gini2018) |>
  rename(p_p_18 = Gini2018)

cor_kendall_2018 <- cor_crime2018_kendall |>
  select(Gini2018) |>
  rename(c_k_18 = Gini2018)
  
pval_kendall_2018 <- pval_kendall |>
  select(Gini2018) |>
  rename(p_k_18 = Gini2018)

cor_spearman_2018 <- cor_crime2018_spearman |>
  select(Gini2018) |>
  rename(c_s_18 = Gini2018)

pval_spearman_2018 <- pval_spearman |>
  select(Gini2018) |>
  rename(p_s_18 = Gini2018)

#join Gini and p-value lines together
Gini_data_2018 <- cbind(cor_pearson_2018 , pval_pearson_2018 , cor_kendall_2018 , pval_kendall_2018 , cor_spearman_2018 , pval_spearman_2018)
```

```{r}
 Gini_pearson_allyears <- cbind(rownames , cor_pearson_2022 , pval_pearson_2022 , cor_pearson_2021 , pval_pearson_2021 , cor_pearson_2020 , pval_pearson_2020 , cor_pearson_2019 , pval_pearson_2019 , cor_pearson_2018 , pval_pearson_2018)

Gini_kendall_allyears <- cbind(rownames , cor_kendall_2022 , pval_kendall_2022 , cor_kendall_2021 , pval_kendall_2021 , cor_kendall_2020 , pval_kendall_2020 , cor_kendall_2019 , pval_kendall_2019, cor_kendall_2018 , pval_kendall_2018)

Gini_spearman_allyears <- cbind(rownames, cor_spearman_2022 , pval_spearman_2022 , cor_spearman_2021 , pval_spearman_2021 , cor_spearman_2020 , pval_spearman_2020 , cor_spearman_2019 , pval_spearman_2019  , cor_spearman_2018 , pval_spearman_2018)

Gini_pearson_table <- nice_table(Gini_pearson_allyears , highlight = TRUE)
print(Gini_pearson_table , preview = "docx") 

Gini_kendall_table <- nice_table(Gini_kendall_allyears , highlight = TRUE)
print(Gini_kendall_table , preview = "docx") 

Gini_spearman_table <- nice_table(Gini_spearman_allyears , highlight = TRUE)
print(Gini_spearman_table , preview = "docx") 

```

```{r}
#Create correlation tables for crime rates and S1901 Income ratios, 2022:
S1901_2022 <- S1901Income2022 |>
  select(HouseholdsTotal , Pct0to10k , Pct10kto14999 , Pct15kto24999...8 , Pct25kto34999 , Pct35kto49999 , Pct50kto74999 , Pct75kto99999 , Pct100kto149999 , Pct150kto199999 , Pct200korMore...22 , HouseholdMedianIncome)

Crime2022_1 <- Crime2022 |>
  select(-FIPS, -year)

#Create ratios of income levels:
#r200_10: ratio of Incomes over 200k to Incomes 0 to 10k
#r2_2: ratio of two top income brackets to two bottom brackets (see, similarly r3_3 and r4_4)
#r_half: ratio of top half of income brackets to bottom half
r200_10 <- ((S1901_2022$Pct200korMore...22) / (S1901_2022$Pct0to10k))

r2_2 <- ((S1901_2022$Pct200korMore...22 + S1901_2022$Pct150kto199999) / (S1901_2022$Pct0to10k + S1901_2022$Pct10kto14999))

r3_3 <- ((S1901_2022$Pct200korMore...22 + S1901_2022$Pct150kto199999 + S1901_2022$Pct100kto149999) / (S1901_2022$Pct0to10k + S1901_2022$Pct10kto14999 + S1901_2022$Pct15kto24999...8))

r4_4 <- ((S1901_2022$Pct200korMore...22 + S1901_2022$Pct150kto199999 + S1901_2022$Pct100kto149999 + S1901_2022$Pct75kto99999) / (S1901_2022$Pct0to10k + S1901_2022$Pct10kto14999 + S1901_2022$Pct15kto24999...8 + S1901_2022$Pct25kto34999))

r_half <- ((S1901_2022$Pct200korMore...22 + S1901_2022$Pct150kto199999 + S1901_2022$Pct100kto149999 + S1901_2022$Pct75kto99999 + S1901_2022$Pct50kto74999) / (S1901_2022$Pct0to10k + S1901_2022$Pct10kto14999 + S1901_2022$Pct15kto24999...8 + S1901_2022$Pct25kto34999 + S1901_2022$Pct35kto49999))

#Join data frames (IC2022: data frame with crime, S1901 income, and ratio numbers)
IC2022 <- cbind(Crime2022_1 , S1901_2022 , r200_10 , r2_2 , r3_3, r4_4 , r_half)

#With ratiohighlow, there is one zero value, resulting in infinity, so I have to use this code for correlations:
indx <- which(is.infinite(r200_10))

#Make correlation tables (with the command to ignore infinite values, only 1 observation is eliminated; IC2022cp: correlation, pearson ; IC2022ck: correlation, kendall; IC2022cs: correlation, spearman):
IC2022cp <- cor_mat(IC2022[-indx , ] , method = "pearson" , alternative = "two.sided" , conf.level = 0.95)

IC2022ck <- cor_mat(IC2022[-indx , ] , method = "kendall" , alternative = "two.sided" , conf.level = 0.95)

IC2022cs <- cor_mat(IC2022[-indx , ] , method = "spearman" , alternative = "two.sided" , conf.level = 0.95)

#Make p-value tables (pp: p-value, pearson; pk: p-value, kendall; ps: p-value, spearman)
IC2022pp <- cor_get_pval(IC2022cp)

IC2022pk <- cor_get_pval(IC2022ck)

IC2022ps <- cor_get_pval(IC2022cs)
```

```{r}
#Create correlation tables for crime rates and S1901 Income ratios, 2021:
S1901_2021 <- S1901Income2021 |>
  select(HouseholdsTotal , Pct0to10k , Pct10kto14999 , Pct15kto24999...8 , Pct25kto34999 , Pct35kto49999 , Pct50kto74999 , Pct75kto99999 , Pct100kto149999 , Pct150kto199999 , Pct200korMore...22 , HouseholdMedianIncome)

Crime2021_1 <- Crime2021 |>
  select(-FIPS, -year)

#Create ratios of income levels:
#r200_10: ratio of Incomes over 200k to Incomes 0 to 10k
#r2_2: ratio of two top income brackets to two bottom brackets (see, similarly r3_3 and r4_4)
#r_half: ratio of top half of income brackets to bottom half
r200_10 <- ((S1901_2021$Pct200korMore...22) / (S1901_2021$Pct0to10k))

r2_2 <- ((S1901_2021$Pct200korMore...22 + S1901_2021$Pct150kto199999) / (S1901_2021$Pct0to10k + S1901_2021$Pct10kto14999))

r3_3 <- ((S1901_2021$Pct200korMore...22 + S1901_2021$Pct150kto199999 + S1901_2021$Pct100kto149999) / (S1901_2021$Pct0to10k + S1901_2021$Pct10kto14999 + S1901_2021$Pct15kto24999...8))

r4_4 <- ((S1901_2021$Pct200korMore...22 + S1901_2021$Pct150kto199999 + S1901_2021$Pct100kto149999 + S1901_2021$Pct75kto99999) / (S1901_2021$Pct0to10k + S1901_2021$Pct10kto14999 + S1901_2021$Pct15kto24999...8 + S1901_2021$Pct25kto34999))

r_half <- ((S1901_2021$Pct200korMore...22 + S1901_2021$Pct150kto199999 + S1901_2021$Pct100kto149999 + S1901_2021$Pct75kto99999 + S1901_2021$Pct50kto74999) / (S1901_2021$Pct0to10k + S1901_2021$Pct10kto14999 + S1901_2021$Pct15kto24999...8 + S1901_2021$Pct25kto34999 + S1901_2021$Pct35kto49999))

#Join data frames (IC2021: data frame with crime, S1901 income, and ratio numbers)
IC2021 <- cbind(Crime2021_1 , S1901_2021 , r200_10 , r2_2 , r3_3, r4_4 , r_half)

#Make correlation tables (with the command to ignore infinite values, only 1 observation is eliminated; IC2021cp: correlation, pearson ; IC2021ck: correlation, kendall; IC2021cs: correlation, spearman):
IC2021cp <- cor_mat(IC2021, method = "pearson" , alternative = "two.sided" , conf.level = 0.95)

IC2021ck <- cor_mat(IC2021, method = "kendall" , alternative = "two.sided" , conf.level = 0.95)

IC2021cs <- cor_mat(IC2021, method = "spearman" , alternative = "two.sided" , conf.level = 0.95)

#Make p-value tables (pp: p-value, pearson; pk: p-value, kendall; ps: p-value, spearman)
IC2021pp <- cor_get_pval(IC2021cp)

IC2021pk <- cor_get_pval(IC2021ck)

IC2021ps <- cor_get_pval(IC2021cs)
```

```{r}
#Create correlation tables for crime rates and S1901 Income ratios, 2020:
S1901_2020 <- S1901Income2020 |>
  select(HouseholdsTotal , Pct0to10k , Pct10kto14999 , Pct15kto24999...8 , Pct25kto34999 , Pct35kto49999 , Pct50kto74999 , Pct75kto99999 , Pct100kto149999 , Pct150kto199999 , Pct200korMore...22 , HouseholdMedianIncome)

Crime2020_1 <- Crime2020 |>
  select(-FIPS, -year)

#Create ratios of income levels:
#r200_10: ratio of Incomes over 200k to Incomes 0 to 10k
#r2_2: ratio of two top income brackets to two bottom brackets (see, similarly r3_3 and r4_4)
#r_half: ratio of top half of income brackets to bottom half
r200_10 <- ((S1901_2020$Pct200korMore...22) / (S1901_2020$Pct0to10k))

r2_2 <- ((S1901_2020$Pct200korMore...22 + S1901_2020$Pct150kto199999) / (S1901_2020$Pct0to10k + S1901_2020$Pct10kto14999))

r3_3 <- ((S1901_2020$Pct200korMore...22 + S1901_2020$Pct150kto199999 + S1901_2020$Pct100kto149999) / (S1901_2020$Pct0to10k + S1901_2020$Pct10kto14999 + S1901_2020$Pct15kto24999...8))

r4_4 <- ((S1901_2020$Pct200korMore...22 + S1901_2020$Pct150kto199999 + S1901_2020$Pct100kto149999 + S1901_2020$Pct75kto99999) / (S1901_2020$Pct0to10k + S1901_2020$Pct10kto14999 + S1901_2020$Pct15kto24999...8 + S1901_2020$Pct25kto34999))

r_half <- ((S1901_2020$Pct200korMore...22 + S1901_2020$Pct150kto199999 + S1901_2020$Pct100kto149999 + S1901_2020$Pct75kto99999 + S1901_2020$Pct50kto74999) / (S1901_2020$Pct0to10k + S1901_2020$Pct10kto14999 + S1901_2020$Pct15kto24999...8 + S1901_2020$Pct25kto34999 + S1901_2020$Pct35kto49999))

#Join data frames (IC2020: data frame with crime, S1901 income, and ratio numbers)
IC2020 <- cbind(Crime2020_1 , S1901_2020 , r200_10 , r2_2 , r3_3, r4_4 , r_half)

#Make correlation tables (with the command to ignore infinite values, only 1 observation is eliminated; IC2020cp: correlation, pearson ; IC2020ck: correlation, kendall; IC2020cs: correlation, spearman):
IC2020cp <- cor_mat(IC2020, method = "pearson" , alternative = "two.sided" , conf.level = 0.95)

IC2020ck <- cor_mat(IC2020, method = "kendall" , alternative = "two.sided" , conf.level = 0.95)

IC2020cs <- cor_mat(IC2020, method = "spearman" , alternative = "two.sided" , conf.level = 0.95)

#Make p-value tables (pp: p-value, pearson; pk: p-value, kendall; ps: p-value, spearman)
IC2020pp <- cor_get_pval(IC2020cp)

IC2020pk <- cor_get_pval(IC2020ck)

IC2020ps <- cor_get_pval(IC2020cs)
```

```{r}
#Create correlation tables for crime rates and S1901 Income ratios, 2019:
S1901_2019 <- S1901Income2019 |>
  select(HouseholdsTotal , Pct0to10k , Pct10kto14999 , Pct15kto24999...8 , Pct25kto34999 , Pct35kto49999 , Pct50kto74999 , Pct75kto99999 , Pct100kto149999 , Pct150kto199999 , Pct200korMore...22 , HouseholdMedianIncome)

Crime2019_1 <- Crime2019 |>
  select(-FIPS, -year)

#Create ratios of income levels:
#r200_10: ratio of Incomes over 200k to Incomes 0 to 10k
#r2_2: ratio of two top income brackets to two bottom brackets (see, similarly r3_3 and r4_4)
#r_half: ratio of top half of income brackets to bottom half
r200_10 <- ((S1901_2019$Pct200korMore...22) / (S1901_2019$Pct0to10k))

r2_2 <- ((S1901_2019$Pct200korMore...22 + S1901_2019$Pct150kto199999) / (S1901_2019$Pct0to10k + S1901_2019$Pct10kto14999))

r3_3 <- ((S1901_2019$Pct200korMore...22 + S1901_2019$Pct150kto199999 + S1901_2019$Pct100kto149999) / (S1901_2019$Pct0to10k + S1901_2019$Pct10kto14999 + S1901_2019$Pct15kto24999...8))

r4_4 <- ((S1901_2019$Pct200korMore...22 + S1901_2019$Pct150kto199999 + S1901_2019$Pct100kto149999 + S1901_2019$Pct75kto99999) / (S1901_2019$Pct0to10k + S1901_2019$Pct10kto14999 + S1901_2019$Pct15kto24999...8 + S1901_2019$Pct25kto34999))

r_half <- ((S1901_2019$Pct200korMore...22 + S1901_2019$Pct150kto199999 + S1901_2019$Pct100kto149999 + S1901_2019$Pct75kto99999 + S1901_2019$Pct50kto74999) / (S1901_2019$Pct0to10k + S1901_2019$Pct10kto14999 + S1901_2019$Pct15kto24999...8 + S1901_2019$Pct25kto34999 + S1901_2019$Pct35kto49999))

#Join data frames (IC2019: data frame with crime, S1901 income, and ratio numbers)
IC2019 <- cbind(Crime2019_1 , S1901_2019 , r200_10 , r2_2 , r3_3, r4_4 , r_half)

#Make correlation tables (with the command to ignore infinite values, only 1 observation is eliminated; IC2019cp: correlation, pearson ; IC2019ck: correlation, kendall; IC2019cs: correlation, spearman):
IC2019cp <- cor_mat(IC2019, method = "pearson" , alternative = "two.sided" , conf.level = 0.95)

IC2019ck <- cor_mat(IC2019, method = "kendall" , alternative = "two.sided" , conf.level = 0.95)

IC2019cs <- cor_mat(IC2019, method = "spearman" , alternative = "two.sided" , conf.level = 0.95)

#Make p-value tables (pp: p-value, pearson; pk: p-value, kendall; ps: p-value, spearman)
IC2019pp <- cor_get_pval(IC2019cp)

IC2019pk <- cor_get_pval(IC2019ck)

IC2019ps <- cor_get_pval(IC2019cs)
```

```{r}
#Create correlation tables for crime rates and S1901 Income ratios, 2018:
S1901_2018 <- S1901Income2018 |>
  select(HouseholdsTotal , Pct0to10k , Pct10kto14999 , Pct15kto24999...8 , Pct25kto34999 , Pct35kto49999 , Pct50kto74999 , Pct75kto99999 , Pct100kto149999 , Pct150kto199999 , Pct200korMore...22 , HouseholdMedianIncome)

Crime2018_1 <- Crime2018 |>
  select(-FIPS, -year)

#Create ratios of income levels:
#r200_10: ratio of Incomes over 200k to Incomes 0 to 10k
#r2_2: ratio of two top income brackets to two bottom brackets (see, similarly r3_3 and r4_4)
#r_half: ratio of top half of income brackets to bottom half
r200_10 <- ((S1901_2018$Pct200korMore...22) / (S1901_2018$Pct0to10k))

r2_2 <- ((S1901_2018$Pct200korMore...22 + S1901_2018$Pct150kto199999) / (S1901_2018$Pct0to10k + S1901_2018$Pct10kto14999))

r3_3 <- ((S1901_2018$Pct200korMore...22 + S1901_2018$Pct150kto199999 + S1901_2018$Pct100kto149999) / (S1901_2018$Pct0to10k + S1901_2018$Pct10kto14999 + S1901_2018$Pct15kto24999...8))

r4_4 <- ((S1901_2018$Pct200korMore...22 + S1901_2018$Pct150kto199999 + S1901_2018$Pct100kto149999 + S1901_2018$Pct75kto99999) / (S1901_2018$Pct0to10k + S1901_2018$Pct10kto14999 + S1901_2018$Pct15kto24999...8 + S1901_2018$Pct25kto34999))

r_half <- ((S1901_2018$Pct200korMore...22 + S1901_2018$Pct150kto199999 + S1901_2018$Pct100kto149999 + S1901_2018$Pct75kto99999 + S1901_2018$Pct50kto74999) / (S1901_2018$Pct0to10k + S1901_2018$Pct10kto14999 + S1901_2018$Pct15kto24999...8 + S1901_2018$Pct25kto34999 + S1901_2018$Pct35kto49999))

#Join data frames (IC2018: data frame with crime, S1901 income, and ratio numbers)
IC2018 <- cbind(Crime2018_1 , S1901_2018 , r200_10 , r2_2 , r3_3, r4_4 , r_half)

#Make correlation tables (with the command to ignore infinite values, only 1 observation is eliminated; IC2018cp: correlation, pearson ; IC2018ck: correlation, kendall; IC2018cs: correlation, spearman):
IC2018cp <- cor_mat(IC2018, method = "pearson" , alternative = "two.sided" , conf.level = 0.95)

IC2018ck <- cor_mat(IC2018, method = "kendall" , alternative = "two.sided" , conf.level = 0.95)

IC2018cs <- cor_mat(IC2018, method = "spearman" , alternative = "two.sided" , conf.level = 0.95)

#Make p-value tables (pp: p-value, pearson; pk: p-value, kendall; ps: p-value, spearman)
IC2018pp <- cor_get_pval(IC2018cp)

IC2018pk <- cor_get_pval(IC2018ck)

IC2018ps <- cor_get_pval(IC2018cs)
```

Now I have 30 datasets, called IC[YEAR][p or c][k, p, or s]. YEAR = the year between 2018-2022. p or c denotes p-value or correlation. k, p, or s denotes Kendall's tau, Pearson's product-moment, or Spearman's rho. Now I need to combine them into clear, viewable tables.

```{r}
save(IC2022cp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2022cp.Rda")
save(IC2022ck , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2022ck.Rda")
save(IC2022cs , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2022cs.Rda")
save(IC2022pp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2022pp.Rda")
save(IC2022pk , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2022pk.Rda")
save(IC2022ps , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2022ps.Rda")

save(IC2021cp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2021cp.Rda")
save(IC2021ck , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2021ck.Rda")
save(IC2021cs , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2021cs.Rda")
save(IC2021pp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2021pp.Rda")
save(IC2021pk , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2021pk.Rda")
save(IC2021ps , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2021ps.Rda")

save(IC2020cp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2020cp.Rda")
save(IC2020ck , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2020ck.Rda")
save(IC2020cs , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2020cs.Rda")
save(IC2020pp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2020pp.Rda")
save(IC2020pk , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2020pk.Rda")
save(IC2020ps , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2020ps.Rda")

save(IC2019cp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2019cp.Rda")
save(IC2019ck , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2019ck.Rda")
save(IC2019cs , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2019cs.Rda")
save(IC2019pp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2019pp.Rda")
save(IC2019pk , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2019pk.Rda")
save(IC2019ps , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2019ps.Rda")

save(IC2018cp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2018cp.Rda")
save(IC2018ck , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2018ck.Rda")
save(IC2018cs , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2018cs.Rda")
save(IC2018pp , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2018pp.Rda")
save(IC2018pk , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2018pk.Rda")
save(IC2018ps , file = "/Users/steve/OneDrive/Desktop/DataMaster/IC2018ps.Rda")
```

Now I have to make clear, readable tables with the above IC datasets involving correlation coefficients and p-values.

```{r}
#Create data frame for clear, readable printing
#Create data frame with crime types, 2022 values, cor pearson, p-value pearson
  #c = correlation, p = p-value, pct0-10 = pct of population income $0-$10,000
prownames2022 <- IC2022cp |>
  select(rowname) |>
  rename(crime_2022_pearson = rowname)

cp2022_pct0_10 <- IC2022cp |>
  select(Pct0to10k) |>
  rename(cp2022_pct0_10 = Pct0to10k)

pp2022_pct0_10 <- IC2022pp |>
  select(Pct0to10k) |>
  rename(pp2022_pct0to10k = Pct0to10k)

cp2022_pct10_15 <- IC2022cp |>
  select(Pct10kto14999) |>
  rename(cp2022_pct10_15 = Pct10kto14999)

pp2022_pct10_15 <- IC2022pp |>
  select(Pct10kto14999) |>
  rename(pp2022_pct10_15 = Pct10kto14999)

cp2022_pct15_25 <- IC2022cp |>
  select(Pct15kto24999...8) |>
  rename(cp2022_pct15_25 = Pct15kto24999...8)

pp2022_pct15_25 <- IC2022pp |>
  select(Pct15kto24999...8) |>
  rename(pp2022_pct15_25 = Pct15kto24999...8)

cp2022_pct25_35 <- IC2022cp |>
  select(Pct25kto34999) |>
  rename(cp2022_pct25_35 = Pct25kto34999)

pp2022_pct25_35 <- IC2022pp |>
  select(Pct25kto34999) |>
  rename(pp2022_pct25_35 = Pct25kto34999)

cp2022_pct35_50 <- IC2022cp |>
  select(Pct35kto49999) |>
  rename(cp2022_pct35_50 = Pct35kto49999)

pp2022_pct35_50 <- IC2022pp |>
  select(Pct35kto49999) |>
  rename(pp2022_pct35_50 = Pct35kto49999)

cp2022_pct50_75 <- IC2022cp |>
  select(Pct50kto74999) |>
  rename(cp2022_pct50_75 = Pct50kto74999)

pp2022_pct50_75 <- IC2022pp |>
  select(Pct50kto74999) |>
  rename(pp2022_pct50_75 = Pct50kto74999)

cp2022_pct75_100 <- IC2022cp |>
  select(Pct75kto99999) |>
  rename(cp2022_pct75_100 = Pct75kto99999)

pp2022_pct75_100 <- IC2022pp |>
  select(Pct75kto99999) |>
  rename(pp2022_pct75_100 = Pct75kto99999)

cp2022_pct100_150 <- IC2022cp |>
  select(Pct100kto149999) |>
  rename(cp2022_pct100_150 = Pct100kto149999)

pp2022_pct100_150 <- IC2022pp |>
  select(Pct100kto149999) |>
  rename(pp2022_pct100_150 = Pct100kto149999)

cp2022_pct150_200 <- IC2022cp |>
  select(Pct150kto199999) |>
  rename(cp2022_pct150_200 = Pct150kto199999)

pp2022_pct150_200 <- IC2022pp |>
  select(Pct150kto199999) |>
  rename(pp2022_pct150_200 = Pct150kto199999)

cp2022_pct200_up <- IC2022cp |>
  select(Pct200korMore...22) |>
  rename(cp2022_pct200_up = Pct200korMore...22)

pp2022_pct200_up <- IC2022pp |>
  select(Pct200korMore...22) |>
  rename(pp2022_pct200_up = Pct200korMore...22)

cp2022_MedIncome <- IC2022cp |>
  select(HouseholdMedianIncome) |>
  rename(cp2022_MedIncome = HouseholdMedianIncome)

pp2022_MedIncome <- IC2022pp |>
  select(HouseholdMedianIncome) |>
  rename(pp2022_MedIncome = HouseholdMedianIncome)

cp2022_rat200_10 <- IC2022cp |>
  select(r200_10) |>
  rename(cp2022_rat200_10 = r200_10)

pp2022_rat200_10 <- IC2022pp |>
  select(r200_10) |>
  rename(pp2022_rat200_10 = r200_10)

cp2022_rat2_2 <- IC2022cp |>
  select(r2_2) |>
  rename(cp2022_rat2_2 = r2_2)

pp2022_rat2_2 <- IC2022pp |>
  select(r2_2) |>
  rename(pp2022_rat2_2 = r2_2)

cp2022_rat3_3 <- IC2022cp |>
  select(r3_3) |>
  rename(cp2022_rat3_3 = r3_3)

pp2022_rat3_3 <- IC2022pp |>
  select(r3_3) |>
  rename(pp2022_rat3_3 = r3_3)

cp2022_rat4_4 <- IC2022cp |>
  select(r4_4) |>
  rename(cp2022_rat4_4 = r4_4)

pp2022_rat4_4 <- IC2022pp |>
  select(r4_4) |>
  rename(pp2022_rat4_4 = r4_4)

cp2022_rat_half <- IC2022cp |>
  select(r_half) |>
  rename(cp2022_rat_half = r_half)

pp2022_rat_half <- IC2022pp |>
  select(r_half) |>
  rename(pp2022_rat_half = r_half)

#Create data frame with crime types, 2022 values, cor kendall, p-value kendall
krownames2022 <- IC2022ck |>
  select(rowname) |>
  rename(crime_2022_kendall = rowname)

ck2022_pct0_10 <- IC2022ck |>
  select(Pct0to10k) |>
  rename(ck2022_pct0_10 = Pct0to10k)

pk2022_pct0_10 <- IC2022pk |>
  select(Pct0to10k) |>
  rename(pk2022_pct0to10k = Pct0to10k)

ck2022_pct10_15 <- IC2022ck |>
  select(Pct10kto14999) |>
  rename(ck2022_pct10_15 = Pct10kto14999)

pk2022_pct10_15 <- IC2022pk |>
  select(Pct10kto14999) |>
  rename(pk2022_pct10_15 = Pct10kto14999)

ck2022_pct15_25 <- IC2022ck |>
  select(Pct15kto24999...8) |>
  rename(ck2022_pct15_25 = Pct15kto24999...8)

pk2022_pct15_25 <- IC2022pk |>
  select(Pct15kto24999...8) |>
  rename(pk2022_pct15_25 = Pct15kto24999...8)

ck2022_pct25_35 <- IC2022ck |>
  select(Pct25kto34999) |>
  rename(ck2022_pct25_35 = Pct25kto34999)

pk2022_pct25_35 <- IC2022pk |>
  select(Pct25kto34999) |>
  rename(pk2022_pct25_35 = Pct25kto34999)

ck2022_pct35_50 <- IC2022ck |>
  select(Pct35kto49999) |>
  rename(ck2022_pct35_50 = Pct35kto49999)

pk2022_pct35_50 <- IC2022pk |>
  select(Pct35kto49999) |>
  rename(pk2022_pct35_50 = Pct35kto49999)

ck2022_pct50_75 <- IC2022ck |>
  select(Pct50kto74999) |>
  rename(ck2022_pct50_75 = Pct50kto74999)

pk2022_pct50_75 <- IC2022pk |>
  select(Pct50kto74999) |>
  rename(pk2022_pct50_75 = Pct50kto74999)

ck2022_pct75_100 <- IC2022ck |>
  select(Pct75kto99999) |>
  rename(ck2022_pct75_100 = Pct75kto99999)

pk2022_pct75_100 <- IC2022pk |>
  select(Pct75kto99999) |>
  rename(pk2022_pct75_100 = Pct75kto99999)

ck2022_pct100_150 <- IC2022ck |>
  select(Pct100kto149999) |>
  rename(ck2022_pct100_150 = Pct100kto149999)

pk2022_pct100_150 <- IC2022pk |>
  select(Pct100kto149999) |>
  rename(pk2022_pct100_150 = Pct100kto149999)

ck2022_pct150_200 <- IC2022ck |>
  select(Pct150kto199999) |>
  rename(ck2022_pct150_200 = Pct150kto199999)

pk2022_pct150_200 <- IC2022pk |>
  select(Pct150kto199999) |>
  rename(pk2022_pct150_200 = Pct150kto199999)

ck2022_pct200_up <- IC2022ck |>
  select(Pct200korMore...22) |>
  rename(ck2022_pct200_up = Pct200korMore...22)

pk2022_pct200_up <- IC2022pk |>
  select(Pct200korMore...22) |>
  rename(pk2022_pct200_up = Pct200korMore...22)

ck2022_MedIncome <- IC2022ck |>
  select(HouseholdMedianIncome) |>
  rename(ck2022_MedIncome = HouseholdMedianIncome)

pk2022_MedIncome <- IC2022pk |>
  select(HouseholdMedianIncome) |>
  rename(pk2022_MedIncome = HouseholdMedianIncome)

ck2022_rat200_10 <- IC2022ck |>
  select(r200_10) |>
  rename(ck2022_rat200_10 = r200_10)

pk2022_rat200_10 <- IC2022pk |>
  select(r200_10) |>
  rename(pk2022_rat200_10 = r200_10)

ck2022_rat2_2 <- IC2022ck |>
  select(r2_2) |>
  rename(ck2022_rat2_2 = r2_2)

pk2022_rat2_2 <- IC2022pk |>
  select(r2_2) |>
  rename(pk2022_rat2_2 = r2_2)

ck2022_rat3_3 <- IC2022ck |>
  select(r3_3) |>
  rename(ck2022_rat3_3 = r3_3)

pk2022_rat3_3 <- IC2022pk |>
  select(r3_3) |>
  rename(pk2022_rat3_3 = r3_3)

ck2022_rat4_4 <- IC2022ck |>
  select(r4_4) |>
  rename(ck2022_rat4_4 = r4_4)

pk2022_rat4_4 <- IC2022pk |>
  select(r4_4) |>
  rename(pk2022_rat4_4 = r4_4)

ck2022_rat_half <- IC2022ck |>
  select(r_half) |>
  rename(ck2022_rat_half = r_half)

pk2022_rat_half <- IC2022pk |>
  select(r_half) |>
  rename(pk2022_rat_half = r_half)

#Create data frame with crime types, 2022 values, cor spearman, p-value spearman
srownames2022 <- IC2022cs |>
  select(rowname) |>
  rename(crime_2022_spearman = rowname)

cs2022_pct0_10 <- IC2022cs |>
  select(Pct0to10k) |>
  rename(cs2022_pct0_10 = Pct0to10k)

ps2022_pct0_10 <- IC2022ps |>
  select(Pct0to10k) |>
  rename(ps2022_pct0to10k = Pct0to10k)

cs2022_pct10_15 <- IC2022cs |>
  select(Pct10kto14999) |>
  rename(cs2022_pct10_15 = Pct10kto14999)

ps2022_pct10_15 <- IC2022ps |>
  select(Pct10kto14999) |>
  rename(ps2022_pct10_15 = Pct10kto14999)

cs2022_pct15_25 <- IC2022cs |>
  select(Pct15kto24999...8) |>
  rename(cs2022_pct15_25 = Pct15kto24999...8)

ps2022_pct15_25 <- IC2022ps |>
  select(Pct15kto24999...8) |>
  rename(ps2022_pct15_25 = Pct15kto24999...8)

cs2022_pct25_35 <- IC2022cs |>
  select(Pct25kto34999) |>
  rename(cs2022_pct25_35 = Pct25kto34999)

ps2022_pct25_35 <- IC2022ps |>
  select(Pct25kto34999) |>
  rename(ps2022_pct25_35 = Pct25kto34999)

cs2022_pct35_50 <- IC2022cs |>
  select(Pct35kto49999) |>
  rename(cs2022_pct35_50 = Pct35kto49999)

ps2022_pct35_50 <- IC2022ps |>
  select(Pct35kto49999) |>
  rename(ps2022_pct35_50 = Pct35kto49999)

cs2022_pct50_75 <- IC2022cs |>
  select(Pct50kto74999) |>
  rename(cs2022_pct50_75 = Pct50kto74999)

ps2022_pct50_75 <- IC2022ps |>
  select(Pct50kto74999) |>
  rename(ps2022_pct50_75 = Pct50kto74999)

cs2022_pct75_100 <- IC2022cs |>
  select(Pct75kto99999) |>
  rename(cs2022_pct75_100 = Pct75kto99999)

ps2022_pct75_100 <- IC2022ps |>
  select(Pct75kto99999) |>
  rename(ps2022_pct75_100 = Pct75kto99999)

cs2022_pct100_150 <- IC2022cs |>
  select(Pct100kto149999) |>
  rename(cs2022_pct100_150 = Pct100kto149999)

ps2022_pct100_150 <- IC2022ps |>
  select(Pct100kto149999) |>
  rename(ps2022_pct100_150 = Pct100kto149999)

cs2022_pct150_200 <- IC2022cs |>
  select(Pct150kto199999) |>
  rename(cs2022_pct150_200 = Pct150kto199999)

ps2022_pct150_200 <- IC2022ps |>
  select(Pct150kto199999) |>
  rename(ps2022_pct150_200 = Pct150kto199999)

cs2022_pct200_up <- IC2022cs |>
  select(Pct200korMore...22) |>
  rename(cs2022_pct200_up = Pct200korMore...22)

ps2022_pct200_up <- IC2022ps |>
  select(Pct200korMore...22) |>
  rename(ps2022_pct200_up = Pct200korMore...22)

cs2022_MedIncome <- IC2022cs |>
  select(HouseholdMedianIncome) |>
  rename(cs2022_MedIncome = HouseholdMedianIncome)

ps2022_MedIncome <- IC2022ps |>
  select(HouseholdMedianIncome) |>
  rename(ps2022_MedIncome = HouseholdMedianIncome)

cs2022_rat200_10 <- IC2022cs |>
  select(r200_10) |>
  rename(cs2022_rat200_10 = r200_10)

ps2022_rat200_10 <- IC2022ps |>
  select(r200_10) |>
  rename(ps2022_rat200_10 = r200_10)

cs2022_rat2_2 <- IC2022cs |>
  select(r2_2) |>
  rename(cs2022_rat2_2 = r2_2)

ps2022_rat2_2 <- IC2022ps |>
  select(r2_2) |>
  rename(ps2022_rat2_2 = r2_2)

cs2022_rat3_3 <- IC2022cs |>
  select(r3_3) |>
  rename(cs2022_rat3_3 = r3_3)

ps2022_rat3_3 <- IC2022ps |>
  select(r3_3) |>
  rename(ps2022_rat3_3 = r3_3)

cs2022_rat4_4 <- IC2022cs |>
  select(r4_4) |>
  rename(cs2022_rat4_4 = r4_4)

ps2022_rat4_4 <- IC2022ps |>
  select(r4_4) |>
  rename(ps2022_rat4_4 = r4_4)

cs2022_rat_half <- IC2022cs |>
  select(r_half) |>
  rename(cs2022_rat_half = r_half)

ps2022_rat_half <- IC2022ps |>
  select(r_half) |>
  rename(ps2022_rat_half = r_half)
```

```{r}
#Create data frame for clear, readable printing
#Create data frame with crime types, 2021 values, cor pearson, p-value pearson
  #c = correlation, p = p-value, pct0-10 = pct of population income $0-$10,000
prownames2021 <- IC2021cp |>
  select(rowname) |>
  rename(crime_2021_pearson = rowname)

cp2021_pct0_10 <- IC2021cp |>
  select(Pct0to10k) |>
  rename(cp2021_pct0_10 = Pct0to10k)

pp2021_pct0_10 <- IC2021pp |>
  select(Pct0to10k) |>
  rename(pp2021_pct0to10k = Pct0to10k)

cp2021_pct10_15 <- IC2021cp |>
  select(Pct10kto14999) |>
  rename(cp2021_pct10_15 = Pct10kto14999)

pp2021_pct10_15 <- IC2021pp |>
  select(Pct10kto14999) |>
  rename(pp2021_pct10_15 = Pct10kto14999)

cp2021_pct15_25 <- IC2021cp |>
  select(Pct15kto24999...8) |>
  rename(cp2021_pct15_25 = Pct15kto24999...8)

pp2021_pct15_25 <- IC2021pp |>
  select(Pct15kto24999...8) |>
  rename(pp2021_pct15_25 = Pct15kto24999...8)

cp2021_pct25_35 <- IC2021cp |>
  select(Pct25kto34999) |>
  rename(cp2021_pct25_35 = Pct25kto34999)

pp2021_pct25_35 <- IC2021pp |>
  select(Pct25kto34999) |>
  rename(pp2021_pct25_35 = Pct25kto34999)

cp2021_pct35_50 <- IC2021cp |>
  select(Pct35kto49999) |>
  rename(cp2021_pct35_50 = Pct35kto49999)

pp2021_pct35_50 <- IC2021pp |>
  select(Pct35kto49999) |>
  rename(pp2021_pct35_50 = Pct35kto49999)

cp2021_pct50_75 <- IC2021cp |>
  select(Pct50kto74999) |>
  rename(cp2021_pct50_75 = Pct50kto74999)

pp2021_pct50_75 <- IC2021pp |>
  select(Pct50kto74999) |>
  rename(pp2021_pct50_75 = Pct50kto74999)

cp2021_pct75_100 <- IC2021cp |>
  select(Pct75kto99999) |>
  rename(cp2021_pct75_100 = Pct75kto99999)

pp2021_pct75_100 <- IC2021pp |>
  select(Pct75kto99999) |>
  rename(pp2021_pct75_100 = Pct75kto99999)

cp2021_pct100_150 <- IC2021cp |>
  select(Pct100kto149999) |>
  rename(cp2021_pct100_150 = Pct100kto149999)

pp2021_pct100_150 <- IC2021pp |>
  select(Pct100kto149999) |>
  rename(pp2021_pct100_150 = Pct100kto149999)

cp2021_pct150_200 <- IC2021cp |>
  select(Pct150kto199999) |>
  rename(cp2021_pct150_200 = Pct150kto199999)

pp2021_pct150_200 <- IC2021pp |>
  select(Pct150kto199999) |>
  rename(pp2021_pct150_200 = Pct150kto199999)

cp2021_pct200_up <- IC2021cp |>
  select(Pct200korMore...22) |>
  rename(cp2021_pct200_up = Pct200korMore...22)

pp2021_pct200_up <- IC2021pp |>
  select(Pct200korMore...22) |>
  rename(pp2021_pct200_up = Pct200korMore...22)

cp2021_MedIncome <- IC2021cp |>
  select(HouseholdMedianIncome) |>
  rename(cp2021_MedIncome = HouseholdMedianIncome)

pp2021_MedIncome <- IC2021pp |>
  select(HouseholdMedianIncome) |>
  rename(pp2021_MedIncome = HouseholdMedianIncome)

cp2021_rat200_10 <- IC2021cp |>
  select(r200_10) |>
  rename(cp2021_rat200_10 = r200_10)

pp2021_rat200_10 <- IC2021pp |>
  select(r200_10) |>
  rename(pp2021_rat200_10 = r200_10)

cp2021_rat2_2 <- IC2021cp |>
  select(r2_2) |>
  rename(cp2021_rat2_2 = r2_2)

pp2021_rat2_2 <- IC2021pp |>
  select(r2_2) |>
  rename(pp2021_rat2_2 = r2_2)

cp2021_rat3_3 <- IC2021cp |>
  select(r3_3) |>
  rename(cp2021_rat3_3 = r3_3)

pp2021_rat3_3 <- IC2021pp |>
  select(r3_3) |>
  rename(pp2021_rat3_3 = r3_3)

cp2021_rat4_4 <- IC2021cp |>
  select(r4_4) |>
  rename(cp2021_rat4_4 = r4_4)

pp2021_rat4_4 <- IC2021pp |>
  select(r4_4) |>
  rename(pp2021_rat4_4 = r4_4)

cp2021_rat_half <- IC2021cp |>
  select(r_half) |>
  rename(cp2021_rat_half = r_half)

pp2021_rat_half <- IC2021pp |>
  select(r_half) |>
  rename(pp2021_rat_half = r_half)

#Create data frame with crime types, 2021 values, cor kendall, p-value kendall
krownames2021 <- IC2021ck |>
  select(rowname) |>
  rename(crime_2021_kendall = rowname)

ck2021_pct0_10 <- IC2021ck |>
  select(Pct0to10k) |>
  rename(ck2021_pct0_10 = Pct0to10k)

pk2021_pct0_10 <- IC2021pk |>
  select(Pct0to10k) |>
  rename(pk2021_pct0to10k = Pct0to10k)

ck2021_pct10_15 <- IC2021ck |>
  select(Pct10kto14999) |>
  rename(ck2021_pct10_15 = Pct10kto14999)

pk2021_pct10_15 <- IC2021pk |>
  select(Pct10kto14999) |>
  rename(pk2021_pct10_15 = Pct10kto14999)

ck2021_pct15_25 <- IC2021ck |>
  select(Pct15kto24999...8) |>
  rename(ck2021_pct15_25 = Pct15kto24999...8)

pk2021_pct15_25 <- IC2021pk |>
  select(Pct15kto24999...8) |>
  rename(pk2021_pct15_25 = Pct15kto24999...8)

ck2021_pct25_35 <- IC2021ck |>
  select(Pct25kto34999) |>
  rename(ck2021_pct25_35 = Pct25kto34999)

pk2021_pct25_35 <- IC2021pk |>
  select(Pct25kto34999) |>
  rename(pk2021_pct25_35 = Pct25kto34999)

ck2021_pct35_50 <- IC2021ck |>
  select(Pct35kto49999) |>
  rename(ck2021_pct35_50 = Pct35kto49999)

pk2021_pct35_50 <- IC2021pk |>
  select(Pct35kto49999) |>
  rename(pk2021_pct35_50 = Pct35kto49999)

ck2021_pct50_75 <- IC2021ck |>
  select(Pct50kto74999) |>
  rename(ck2021_pct50_75 = Pct50kto74999)

pk2021_pct50_75 <- IC2021pk |>
  select(Pct50kto74999) |>
  rename(pk2021_pct50_75 = Pct50kto74999)

ck2021_pct75_100 <- IC2021ck |>
  select(Pct75kto99999) |>
  rename(ck2021_pct75_100 = Pct75kto99999)

pk2021_pct75_100 <- IC2021pk |>
  select(Pct75kto99999) |>
  rename(pk2021_pct75_100 = Pct75kto99999)

ck2021_pct100_150 <- IC2021ck |>
  select(Pct100kto149999) |>
  rename(ck2021_pct100_150 = Pct100kto149999)

pk2021_pct100_150 <- IC2021pk |>
  select(Pct100kto149999) |>
  rename(pk2021_pct100_150 = Pct100kto149999)

ck2021_pct150_200 <- IC2021ck |>
  select(Pct150kto199999) |>
  rename(ck2021_pct150_200 = Pct150kto199999)

pk2021_pct150_200 <- IC2021pk |>
  select(Pct150kto199999) |>
  rename(pk2021_pct150_200 = Pct150kto199999)

ck2021_pct200_up <- IC2021ck |>
  select(Pct200korMore...22) |>
  rename(ck2021_pct200_up = Pct200korMore...22)

pk2021_pct200_up <- IC2021pk |>
  select(Pct200korMore...22) |>
  rename(pk2021_pct200_up = Pct200korMore...22)

ck2021_MedIncome <- IC2021ck |>
  select(HouseholdMedianIncome) |>
  rename(ck2021_MedIncome = HouseholdMedianIncome)

pk2021_MedIncome <- IC2021pk |>
  select(HouseholdMedianIncome) |>
  rename(pk2021_MedIncome = HouseholdMedianIncome)

ck2021_rat200_10 <- IC2021ck |>
  select(r200_10) |>
  rename(ck2021_rat200_10 = r200_10)

pk2021_rat200_10 <- IC2021pk |>
  select(r200_10) |>
  rename(pk2021_rat200_10 = r200_10)

ck2021_rat2_2 <- IC2021ck |>
  select(r2_2) |>
  rename(ck2021_rat2_2 = r2_2)

pk2021_rat2_2 <- IC2021pk |>
  select(r2_2) |>
  rename(pk2021_rat2_2 = r2_2)

ck2021_rat3_3 <- IC2021ck |>
  select(r3_3) |>
  rename(ck2021_rat3_3 = r3_3)

pk2021_rat3_3 <- IC2021pk |>
  select(r3_3) |>
  rename(pk2021_rat3_3 = r3_3)

ck2021_rat4_4 <- IC2021ck |>
  select(r4_4) |>
  rename(ck2021_rat4_4 = r4_4)

pk2021_rat4_4 <- IC2021pk |>
  select(r4_4) |>
  rename(pk2021_rat4_4 = r4_4)

ck2021_rat_half <- IC2021ck |>
  select(r_half) |>
  rename(ck2021_rat_half = r_half)

pk2021_rat_half <- IC2021pk |>
  select(r_half) |>
  rename(pk2021_rat_half = r_half)

#Create data frame with crime types, 2021 values, cor spearman, p-value spearman
srownames2021 <- IC2021cs |>
  select(rowname) |>
  rename(crime_2021_spearman = rowname)

cs2021_pct0_10 <- IC2021cs |>
  select(Pct0to10k) |>
  rename(cs2021_pct0_10 = Pct0to10k)

ps2021_pct0_10 <- IC2021ps |>
  select(Pct0to10k) |>
  rename(ps2021_pct0to10k = Pct0to10k)

cs2021_pct10_15 <- IC2021cs |>
  select(Pct10kto14999) |>
  rename(cs2021_pct10_15 = Pct10kto14999)

ps2021_pct10_15 <- IC2021ps |>
  select(Pct10kto14999) |>
  rename(ps2021_pct10_15 = Pct10kto14999)

cs2021_pct15_25 <- IC2021cs |>
  select(Pct15kto24999...8) |>
  rename(cs2021_pct15_25 = Pct15kto24999...8)

ps2021_pct15_25 <- IC2021ps |>
  select(Pct15kto24999...8) |>
  rename(ps2021_pct15_25 = Pct15kto24999...8)

cs2021_pct25_35 <- IC2021cs |>
  select(Pct25kto34999) |>
  rename(cs2021_pct25_35 = Pct25kto34999)

ps2021_pct25_35 <- IC2021ps |>
  select(Pct25kto34999) |>
  rename(ps2021_pct25_35 = Pct25kto34999)

cs2021_pct35_50 <- IC2021cs |>
  select(Pct35kto49999) |>
  rename(cs2021_pct35_50 = Pct35kto49999)

ps2021_pct35_50 <- IC2021ps |>
  select(Pct35kto49999) |>
  rename(ps2021_pct35_50 = Pct35kto49999)

cs2021_pct50_75 <- IC2021cs |>
  select(Pct50kto74999) |>
  rename(cs2021_pct50_75 = Pct50kto74999)

ps2021_pct50_75 <- IC2021ps |>
  select(Pct50kto74999) |>
  rename(ps2021_pct50_75 = Pct50kto74999)

cs2021_pct75_100 <- IC2021cs |>
  select(Pct75kto99999) |>
  rename(cs2021_pct75_100 = Pct75kto99999)

ps2021_pct75_100 <- IC2021ps |>
  select(Pct75kto99999) |>
  rename(ps2021_pct75_100 = Pct75kto99999)

cs2021_pct100_150 <- IC2021cs |>
  select(Pct100kto149999) |>
  rename(cs2021_pct100_150 = Pct100kto149999)

ps2021_pct100_150 <- IC2021ps |>
  select(Pct100kto149999) |>
  rename(ps2021_pct100_150 = Pct100kto149999)

cs2021_pct150_200 <- IC2021cs |>
  select(Pct150kto199999) |>
  rename(cs2021_pct150_200 = Pct150kto199999)

ps2021_pct150_200 <- IC2021ps |>
  select(Pct150kto199999) |>
  rename(ps2021_pct150_200 = Pct150kto199999)

cs2021_pct200_up <- IC2021cs |>
  select(Pct200korMore...22) |>
  rename(cs2021_pct200_up = Pct200korMore...22)

ps2021_pct200_up <- IC2021ps |>
  select(Pct200korMore...22) |>
  rename(ps2021_pct200_up = Pct200korMore...22)

cs2021_MedIncome <- IC2021cs |>
  select(HouseholdMedianIncome) |>
  rename(cs2021_MedIncome = HouseholdMedianIncome)

ps2021_MedIncome <- IC2021ps |>
  select(HouseholdMedianIncome) |>
  rename(ps2021_MedIncome = HouseholdMedianIncome)

cs2021_rat200_10 <- IC2021cs |>
  select(r200_10) |>
  rename(cs2021_rat200_10 = r200_10)

ps2021_rat200_10 <- IC2021ps |>
  select(r200_10) |>
  rename(ps2021_rat200_10 = r200_10)

cs2021_rat2_2 <- IC2021cs |>
  select(r2_2) |>
  rename(cs2021_rat2_2 = r2_2)

ps2021_rat2_2 <- IC2021ps |>
  select(r2_2) |>
  rename(ps2021_rat2_2 = r2_2)

cs2021_rat3_3 <- IC2021cs |>
  select(r3_3) |>
  rename(cs2021_rat3_3 = r3_3)

ps2021_rat3_3 <- IC2021ps |>
  select(r3_3) |>
  rename(ps2021_rat3_3 = r3_3)

cs2021_rat4_4 <- IC2021cs |>
  select(r4_4) |>
  rename(cs2021_rat4_4 = r4_4)

ps2021_rat4_4 <- IC2021ps |>
  select(r4_4) |>
  rename(ps2021_rat4_4 = r4_4)

cs2021_rat_half <- IC2021cs |>
  select(r_half) |>
  rename(cs2021_rat_half = r_half)

ps2021_rat_half <- IC2021ps |>
  select(r_half) |>
  rename(ps2021_rat_half = r_half)
```

```{r}
#Create data frame for clear, readable printing
#Create data frame with crime types, 2020 values, cor pearson, p-value pearson
  #c = correlation, p = p-value, pct0-10 = pct of population income $0-$10,000
prownames2020 <- IC2020cp |>
  select(rowname) |>
  rename(crime_2020_pearson = rowname)

cp2020_pct0_10 <- IC2020cp |>
  select(Pct0to10k) |>
  rename(cp2020_pct0_10 = Pct0to10k)

pp2020_pct0_10 <- IC2020pp |>
  select(Pct0to10k) |>
  rename(pp2020_pct0to10k = Pct0to10k)

cp2020_pct10_15 <- IC2020cp |>
  select(Pct10kto14999) |>
  rename(cp2020_pct10_15 = Pct10kto14999)

pp2020_pct10_15 <- IC2020pp |>
  select(Pct10kto14999) |>
  rename(pp2020_pct10_15 = Pct10kto14999)

cp2020_pct15_25 <- IC2020cp |>
  select(Pct15kto24999...8) |>
  rename(cp2020_pct15_25 = Pct15kto24999...8)

pp2020_pct15_25 <- IC2020pp |>
  select(Pct15kto24999...8) |>
  rename(pp2020_pct15_25 = Pct15kto24999...8)

cp2020_pct25_35 <- IC2020cp |>
  select(Pct25kto34999) |>
  rename(cp2020_pct25_35 = Pct25kto34999)

pp2020_pct25_35 <- IC2020pp |>
  select(Pct25kto34999) |>
  rename(pp2020_pct25_35 = Pct25kto34999)

cp2020_pct35_50 <- IC2020cp |>
  select(Pct35kto49999) |>
  rename(cp2020_pct35_50 = Pct35kto49999)

pp2020_pct35_50 <- IC2020pp |>
  select(Pct35kto49999) |>
  rename(pp2020_pct35_50 = Pct35kto49999)

cp2020_pct50_75 <- IC2020cp |>
  select(Pct50kto74999) |>
  rename(cp2020_pct50_75 = Pct50kto74999)

pp2020_pct50_75 <- IC2020pp |>
  select(Pct50kto74999) |>
  rename(pp2020_pct50_75 = Pct50kto74999)

cp2020_pct75_100 <- IC2020cp |>
  select(Pct75kto99999) |>
  rename(cp2020_pct75_100 = Pct75kto99999)

pp2020_pct75_100 <- IC2020pp |>
  select(Pct75kto99999) |>
  rename(pp2020_pct75_100 = Pct75kto99999)

cp2020_pct100_150 <- IC2020cp |>
  select(Pct100kto149999) |>
  rename(cp2020_pct100_150 = Pct100kto149999)

pp2020_pct100_150 <- IC2020pp |>
  select(Pct100kto149999) |>
  rename(pp2020_pct100_150 = Pct100kto149999)

cp2020_pct150_200 <- IC2020cp |>
  select(Pct150kto199999) |>
  rename(cp2020_pct150_200 = Pct150kto199999)

pp2020_pct150_200 <- IC2020pp |>
  select(Pct150kto199999) |>
  rename(pp2020_pct150_200 = Pct150kto199999)

cp2020_pct200_up <- IC2020cp |>
  select(Pct200korMore...22) |>
  rename(cp2020_pct200_up = Pct200korMore...22)

pp2020_pct200_up <- IC2020pp |>
  select(Pct200korMore...22) |>
  rename(pp2020_pct200_up = Pct200korMore...22)

cp2020_MedIncome <- IC2020cp |>
  select(HouseholdMedianIncome) |>
  rename(cp2020_MedIncome = HouseholdMedianIncome)

pp2020_MedIncome <- IC2020pp |>
  select(HouseholdMedianIncome) |>
  rename(pp2020_MedIncome = HouseholdMedianIncome)

cp2020_rat200_10 <- IC2020cp |>
  select(r200_10) |>
  rename(cp2020_rat200_10 = r200_10)

pp2020_rat200_10 <- IC2020pp |>
  select(r200_10) |>
  rename(pp2020_rat200_10 = r200_10)

cp2020_rat2_2 <- IC2020cp |>
  select(r2_2) |>
  rename(cp2020_rat2_2 = r2_2)

pp2020_rat2_2 <- IC2020pp |>
  select(r2_2) |>
  rename(pp2020_rat2_2 = r2_2)

cp2020_rat3_3 <- IC2020cp |>
  select(r3_3) |>
  rename(cp2020_rat3_3 = r3_3)

pp2020_rat3_3 <- IC2020pp |>
  select(r3_3) |>
  rename(pp2020_rat3_3 = r3_3)

cp2020_rat4_4 <- IC2020cp |>
  select(r4_4) |>
  rename(cp2020_rat4_4 = r4_4)

pp2020_rat4_4 <- IC2020pp |>
  select(r4_4) |>
  rename(pp2020_rat4_4 = r4_4)

cp2020_rat_half <- IC2020cp |>
  select(r_half) |>
  rename(cp2020_rat_half = r_half)

pp2020_rat_half <- IC2020pp |>
  select(r_half) |>
  rename(pp2020_rat_half = r_half)

#Create data frame with crime types, 2020 values, cor kendall, p-value kendall
krownames2020 <- IC2020ck |>
  select(rowname) |>
  rename(crime_2020_kendall = rowname)

ck2020_pct0_10 <- IC2020ck |>
  select(Pct0to10k) |>
  rename(ck2020_pct0_10 = Pct0to10k)

pk2020_pct0_10 <- IC2020pk |>
  select(Pct0to10k) |>
  rename(pk2020_pct0to10k = Pct0to10k)

ck2020_pct10_15 <- IC2020ck |>
  select(Pct10kto14999) |>
  rename(ck2020_pct10_15 = Pct10kto14999)

pk2020_pct10_15 <- IC2020pk |>
  select(Pct10kto14999) |>
  rename(pk2020_pct10_15 = Pct10kto14999)

ck2020_pct15_25 <- IC2020ck |>
  select(Pct15kto24999...8) |>
  rename(ck2020_pct15_25 = Pct15kto24999...8)

pk2020_pct15_25 <- IC2020pk |>
  select(Pct15kto24999...8) |>
  rename(pk2020_pct15_25 = Pct15kto24999...8)

ck2020_pct25_35 <- IC2020ck |>
  select(Pct25kto34999) |>
  rename(ck2020_pct25_35 = Pct25kto34999)

pk2020_pct25_35 <- IC2020pk |>
  select(Pct25kto34999) |>
  rename(pk2020_pct25_35 = Pct25kto34999)

ck2020_pct35_50 <- IC2020ck |>
  select(Pct35kto49999) |>
  rename(ck2020_pct35_50 = Pct35kto49999)

pk2020_pct35_50 <- IC2020pk |>
  select(Pct35kto49999) |>
  rename(pk2020_pct35_50 = Pct35kto49999)

ck2020_pct50_75 <- IC2020ck |>
  select(Pct50kto74999) |>
  rename(ck2020_pct50_75 = Pct50kto74999)

pk2020_pct50_75 <- IC2020pk |>
  select(Pct50kto74999) |>
  rename(pk2020_pct50_75 = Pct50kto74999)

ck2020_pct75_100 <- IC2020ck |>
  select(Pct75kto99999) |>
  rename(ck2020_pct75_100 = Pct75kto99999)

pk2020_pct75_100 <- IC2020pk |>
  select(Pct75kto99999) |>
  rename(pk2020_pct75_100 = Pct75kto99999)

ck2020_pct100_150 <- IC2020ck |>
  select(Pct100kto149999) |>
  rename(ck2020_pct100_150 = Pct100kto149999)

pk2020_pct100_150 <- IC2020pk |>
  select(Pct100kto149999) |>
  rename(pk2020_pct100_150 = Pct100kto149999)

ck2020_pct150_200 <- IC2020ck |>
  select(Pct150kto199999) |>
  rename(ck2020_pct150_200 = Pct150kto199999)

pk2020_pct150_200 <- IC2020pk |>
  select(Pct150kto199999) |>
  rename(pk2020_pct150_200 = Pct150kto199999)

ck2020_pct200_up <- IC2020ck |>
  select(Pct200korMore...22) |>
  rename(ck2020_pct200_up = Pct200korMore...22)

pk2020_pct200_up <- IC2020pk |>
  select(Pct200korMore...22) |>
  rename(pk2020_pct200_up = Pct200korMore...22)

ck2020_MedIncome <- IC2020ck |>
  select(HouseholdMedianIncome) |>
  rename(ck2020_MedIncome = HouseholdMedianIncome)

pk2020_MedIncome <- IC2020pk |>
  select(HouseholdMedianIncome) |>
  rename(pk2020_MedIncome = HouseholdMedianIncome)

ck2020_rat200_10 <- IC2020ck |>
  select(r200_10) |>
  rename(ck2020_rat200_10 = r200_10)

pk2020_rat200_10 <- IC2020pk |>
  select(r200_10) |>
  rename(pk2020_rat200_10 = r200_10)

ck2020_rat2_2 <- IC2020ck |>
  select(r2_2) |>
  rename(ck2020_rat2_2 = r2_2)

pk2020_rat2_2 <- IC2020pk |>
  select(r2_2) |>
  rename(pk2020_rat2_2 = r2_2)

ck2020_rat3_3 <- IC2020ck |>
  select(r3_3) |>
  rename(ck2020_rat3_3 = r3_3)

pk2020_rat3_3 <- IC2020pk |>
  select(r3_3) |>
  rename(pk2020_rat3_3 = r3_3)

ck2020_rat4_4 <- IC2020ck |>
  select(r4_4) |>
  rename(ck2020_rat4_4 = r4_4)

pk2020_rat4_4 <- IC2020pk |>
  select(r4_4) |>
  rename(pk2020_rat4_4 = r4_4)

ck2020_rat_half <- IC2020ck |>
  select(r_half) |>
  rename(ck2020_rat_half = r_half)

pk2020_rat_half <- IC2020pk |>
  select(r_half) |>
  rename(pk2020_rat_half = r_half)

#Create data frame with crime types, 2020 values, cor spearman, p-value spearman
srownames2020 <- IC2020cs |>
  select(rowname) |>
  rename(crime_2020_spearman = rowname)

cs2020_pct0_10 <- IC2020cs |>
  select(Pct0to10k) |>
  rename(cs2020_pct0_10 = Pct0to10k)

ps2020_pct0_10 <- IC2020ps |>
  select(Pct0to10k) |>
  rename(ps2020_pct0to10k = Pct0to10k)

cs2020_pct10_15 <- IC2020cs |>
  select(Pct10kto14999) |>
  rename(cs2020_pct10_15 = Pct10kto14999)

ps2020_pct10_15 <- IC2020ps |>
  select(Pct10kto14999) |>
  rename(ps2020_pct10_15 = Pct10kto14999)

cs2020_pct15_25 <- IC2020cs |>
  select(Pct15kto24999...8) |>
  rename(cs2020_pct15_25 = Pct15kto24999...8)

ps2020_pct15_25 <- IC2020ps |>
  select(Pct15kto24999...8) |>
  rename(ps2020_pct15_25 = Pct15kto24999...8)

cs2020_pct25_35 <- IC2020cs |>
  select(Pct25kto34999) |>
  rename(cs2020_pct25_35 = Pct25kto34999)

ps2020_pct25_35 <- IC2020ps |>
  select(Pct25kto34999) |>
  rename(ps2020_pct25_35 = Pct25kto34999)

cs2020_pct35_50 <- IC2020cs |>
  select(Pct35kto49999) |>
  rename(cs2020_pct35_50 = Pct35kto49999)

ps2020_pct35_50 <- IC2020ps |>
  select(Pct35kto49999) |>
  rename(ps2020_pct35_50 = Pct35kto49999)

cs2020_pct50_75 <- IC2020cs |>
  select(Pct50kto74999) |>
  rename(cs2020_pct50_75 = Pct50kto74999)

ps2020_pct50_75 <- IC2020ps |>
  select(Pct50kto74999) |>
  rename(ps2020_pct50_75 = Pct50kto74999)

cs2020_pct75_100 <- IC2020cs |>
  select(Pct75kto99999) |>
  rename(cs2020_pct75_100 = Pct75kto99999)

ps2020_pct75_100 <- IC2020ps |>
  select(Pct75kto99999) |>
  rename(ps2020_pct75_100 = Pct75kto99999)

cs2020_pct100_150 <- IC2020cs |>
  select(Pct100kto149999) |>
  rename(cs2020_pct100_150 = Pct100kto149999)

ps2020_pct100_150 <- IC2020ps |>
  select(Pct100kto149999) |>
  rename(ps2020_pct100_150 = Pct100kto149999)

cs2020_pct150_200 <- IC2020cs |>
  select(Pct150kto199999) |>
  rename(cs2020_pct150_200 = Pct150kto199999)

ps2020_pct150_200 <- IC2020ps |>
  select(Pct150kto199999) |>
  rename(ps2020_pct150_200 = Pct150kto199999)

cs2020_pct200_up <- IC2020cs |>
  select(Pct200korMore...22) |>
  rename(cs2020_pct200_up = Pct200korMore...22)

ps2020_pct200_up <- IC2020ps |>
  select(Pct200korMore...22) |>
  rename(ps2020_pct200_up = Pct200korMore...22)

cs2020_MedIncome <- IC2020cs |>
  select(HouseholdMedianIncome) |>
  rename(cs2020_MedIncome = HouseholdMedianIncome)

ps2020_MedIncome <- IC2020ps |>
  select(HouseholdMedianIncome) |>
  rename(ps2020_MedIncome = HouseholdMedianIncome)

cs2020_rat200_10 <- IC2020cs |>
  select(r200_10) |>
  rename(cs2020_rat200_10 = r200_10)

ps2020_rat200_10 <- IC2020ps |>
  select(r200_10) |>
  rename(ps2020_rat200_10 = r200_10)

cs2020_rat2_2 <- IC2020cs |>
  select(r2_2) |>
  rename(cs2020_rat2_2 = r2_2)

ps2020_rat2_2 <- IC2020ps |>
  select(r2_2) |>
  rename(ps2020_rat2_2 = r2_2)

cs2020_rat3_3 <- IC2020cs |>
  select(r3_3) |>
  rename(cs2020_rat3_3 = r3_3)

ps2020_rat3_3 <- IC2020ps |>
  select(r3_3) |>
  rename(ps2020_rat3_3 = r3_3)

cs2020_rat4_4 <- IC2020cs |>
  select(r4_4) |>
  rename(cs2020_rat4_4 = r4_4)

ps2020_rat4_4 <- IC2020ps |>
  select(r4_4) |>
  rename(ps2020_rat4_4 = r4_4)

cs2020_rat_half <- IC2020cs |>
  select(r_half) |>
  rename(cs2020_rat_half = r_half)

ps2020_rat_half <- IC2020ps |>
  select(r_half) |>
  rename(ps2020_rat_half = r_half)
```

```{r}
#Create data frame for clear, readable printing
#Create data frame with crime types, 2019 values, cor pearson, p-value pearson
  #c = correlation, p = p-value, pct0-10 = pct of population income $0-$10,000
prownames2019 <- IC2019cp |>
  select(rowname) |>
  rename(crime_2019_pearson = rowname)

cp2019_pct0_10 <- IC2019cp |>
  select(Pct0to10k) |>
  rename(cp2019_pct0_10 = Pct0to10k)

pp2019_pct0_10 <- IC2019pp |>
  select(Pct0to10k) |>
  rename(pp2019_pct0to10k = Pct0to10k)

cp2019_pct10_15 <- IC2019cp |>
  select(Pct10kto14999) |>
  rename(cp2019_pct10_15 = Pct10kto14999)

pp2019_pct10_15 <- IC2019pp |>
  select(Pct10kto14999) |>
  rename(pp2019_pct10_15 = Pct10kto14999)

cp2019_pct15_25 <- IC2019cp |>
  select(Pct15kto24999...8) |>
  rename(cp2019_pct15_25 = Pct15kto24999...8)

pp2019_pct15_25 <- IC2019pp |>
  select(Pct15kto24999...8) |>
  rename(pp2019_pct15_25 = Pct15kto24999...8)

cp2019_pct25_35 <- IC2019cp |>
  select(Pct25kto34999) |>
  rename(cp2019_pct25_35 = Pct25kto34999)

pp2019_pct25_35 <- IC2019pp |>
  select(Pct25kto34999) |>
  rename(pp2019_pct25_35 = Pct25kto34999)

cp2019_pct35_50 <- IC2019cp |>
  select(Pct35kto49999) |>
  rename(cp2019_pct35_50 = Pct35kto49999)

pp2019_pct35_50 <- IC2019pp |>
  select(Pct35kto49999) |>
  rename(pp2019_pct35_50 = Pct35kto49999)

cp2019_pct50_75 <- IC2019cp |>
  select(Pct50kto74999) |>
  rename(cp2019_pct50_75 = Pct50kto74999)

pp2019_pct50_75 <- IC2019pp |>
  select(Pct50kto74999) |>
  rename(pp2019_pct50_75 = Pct50kto74999)

cp2019_pct75_100 <- IC2019cp |>
  select(Pct75kto99999) |>
  rename(cp2019_pct75_100 = Pct75kto99999)

pp2019_pct75_100 <- IC2019pp |>
  select(Pct75kto99999) |>
  rename(pp2019_pct75_100 = Pct75kto99999)

cp2019_pct100_150 <- IC2019cp |>
  select(Pct100kto149999) |>
  rename(cp2019_pct100_150 = Pct100kto149999)

pp2019_pct100_150 <- IC2019pp |>
  select(Pct100kto149999) |>
  rename(pp2019_pct100_150 = Pct100kto149999)

cp2019_pct150_200 <- IC2019cp |>
  select(Pct150kto199999) |>
  rename(cp2019_pct150_200 = Pct150kto199999)

pp2019_pct150_200 <- IC2019pp |>
  select(Pct150kto199999) |>
  rename(pp2019_pct150_200 = Pct150kto199999)

cp2019_pct200_up <- IC2019cp |>
  select(Pct200korMore...22) |>
  rename(cp2019_pct200_up = Pct200korMore...22)

pp2019_pct200_up <- IC2019pp |>
  select(Pct200korMore...22) |>
  rename(pp2019_pct200_up = Pct200korMore...22)

cp2019_MedIncome <- IC2019cp |>
  select(HouseholdMedianIncome) |>
  rename(cp2019_MedIncome = HouseholdMedianIncome)

pp2019_MedIncome <- IC2019pp |>
  select(HouseholdMedianIncome) |>
  rename(pp2019_MedIncome = HouseholdMedianIncome)

cp2019_rat200_10 <- IC2019cp |>
  select(r200_10) |>
  rename(cp2019_rat200_10 = r200_10)

pp2019_rat200_10 <- IC2019pp |>
  select(r200_10) |>
  rename(pp2019_rat200_10 = r200_10)

cp2019_rat2_2 <- IC2019cp |>
  select(r2_2) |>
  rename(cp2019_rat2_2 = r2_2)

pp2019_rat2_2 <- IC2019pp |>
  select(r2_2) |>
  rename(pp2019_rat2_2 = r2_2)

cp2019_rat3_3 <- IC2019cp |>
  select(r3_3) |>
  rename(cp2019_rat3_3 = r3_3)

pp2019_rat3_3 <- IC2019pp |>
  select(r3_3) |>
  rename(pp2019_rat3_3 = r3_3)

cp2019_rat4_4 <- IC2019cp |>
  select(r4_4) |>
  rename(cp2019_rat4_4 = r4_4)

pp2019_rat4_4 <- IC2019pp |>
  select(r4_4) |>
  rename(pp2019_rat4_4 = r4_4)

cp2019_rat_half <- IC2019cp |>
  select(r_half) |>
  rename(cp2019_rat_half = r_half)

pp2019_rat_half <- IC2019pp |>
  select(r_half) |>
  rename(pp2019_rat_half = r_half)

#Create data frame with crime types, 2019 values, cor kendall, p-value kendall
krownames2019 <- IC2019ck |>
  select(rowname) |>
  rename(crime_2019_kendall = rowname)

ck2019_pct0_10 <- IC2019ck |>
  select(Pct0to10k) |>
  rename(ck2019_pct0_10 = Pct0to10k)

pk2019_pct0_10 <- IC2019pk |>
  select(Pct0to10k) |>
  rename(pk2019_pct0to10k = Pct0to10k)

ck2019_pct10_15 <- IC2019ck |>
  select(Pct10kto14999) |>
  rename(ck2019_pct10_15 = Pct10kto14999)

pk2019_pct10_15 <- IC2019pk |>
  select(Pct10kto14999) |>
  rename(pk2019_pct10_15 = Pct10kto14999)

ck2019_pct15_25 <- IC2019ck |>
  select(Pct15kto24999...8) |>
  rename(ck2019_pct15_25 = Pct15kto24999...8)

pk2019_pct15_25 <- IC2019pk |>
  select(Pct15kto24999...8) |>
  rename(pk2019_pct15_25 = Pct15kto24999...8)

ck2019_pct25_35 <- IC2019ck |>
  select(Pct25kto34999) |>
  rename(ck2019_pct25_35 = Pct25kto34999)

pk2019_pct25_35 <- IC2019pk |>
  select(Pct25kto34999) |>
  rename(pk2019_pct25_35 = Pct25kto34999)

ck2019_pct35_50 <- IC2019ck |>
  select(Pct35kto49999) |>
  rename(ck2019_pct35_50 = Pct35kto49999)

pk2019_pct35_50 <- IC2019pk |>
  select(Pct35kto49999) |>
  rename(pk2019_pct35_50 = Pct35kto49999)

ck2019_pct50_75 <- IC2019ck |>
  select(Pct50kto74999) |>
  rename(ck2019_pct50_75 = Pct50kto74999)

pk2019_pct50_75 <- IC2019pk |>
  select(Pct50kto74999) |>
  rename(pk2019_pct50_75 = Pct50kto74999)

ck2019_pct75_100 <- IC2019ck |>
  select(Pct75kto99999) |>
  rename(ck2019_pct75_100 = Pct75kto99999)

pk2019_pct75_100 <- IC2019pk |>
  select(Pct75kto99999) |>
  rename(pk2019_pct75_100 = Pct75kto99999)

ck2019_pct100_150 <- IC2019ck |>
  select(Pct100kto149999) |>
  rename(ck2019_pct100_150 = Pct100kto149999)

pk2019_pct100_150 <- IC2019pk |>
  select(Pct100kto149999) |>
  rename(pk2019_pct100_150 = Pct100kto149999)

ck2019_pct150_200 <- IC2019ck |>
  select(Pct150kto199999) |>
  rename(ck2019_pct150_200 = Pct150kto199999)

pk2019_pct150_200 <- IC2019pk |>
  select(Pct150kto199999) |>
  rename(pk2019_pct150_200 = Pct150kto199999)

ck2019_pct200_up <- IC2019ck |>
  select(Pct200korMore...22) |>
  rename(ck2019_pct200_up = Pct200korMore...22)

pk2019_pct200_up <- IC2019pk |>
  select(Pct200korMore...22) |>
  rename(pk2019_pct200_up = Pct200korMore...22)

ck2019_MedIncome <- IC2019ck |>
  select(HouseholdMedianIncome) |>
  rename(ck2019_MedIncome = HouseholdMedianIncome)

pk2019_MedIncome <- IC2019pk |>
  select(HouseholdMedianIncome) |>
  rename(pk2019_MedIncome = HouseholdMedianIncome)

ck2019_rat200_10 <- IC2019ck |>
  select(r200_10) |>
  rename(ck2019_rat200_10 = r200_10)

pk2019_rat200_10 <- IC2019pk |>
  select(r200_10) |>
  rename(pk2019_rat200_10 = r200_10)

ck2019_rat2_2 <- IC2019ck |>
  select(r2_2) |>
  rename(ck2019_rat2_2 = r2_2)

pk2019_rat2_2 <- IC2019pk |>
  select(r2_2) |>
  rename(pk2019_rat2_2 = r2_2)

ck2019_rat3_3 <- IC2019ck |>
  select(r3_3) |>
  rename(ck2019_rat3_3 = r3_3)

pk2019_rat3_3 <- IC2019pk |>
  select(r3_3) |>
  rename(pk2019_rat3_3 = r3_3)

ck2019_rat4_4 <- IC2019ck |>
  select(r4_4) |>
  rename(ck2019_rat4_4 = r4_4)

pk2019_rat4_4 <- IC2019pk |>
  select(r4_4) |>
  rename(pk2019_rat4_4 = r4_4)

ck2019_rat_half <- IC2019ck |>
  select(r_half) |>
  rename(ck2019_rat_half = r_half)

pk2019_rat_half <- IC2019pk |>
  select(r_half) |>
  rename(pk2019_rat_half = r_half)

#Create data frame with crime types, 2019 values, cor spearman, p-value spearman
srownames2019 <- IC2019cs |>
  select(rowname) |>
  rename(crime_2019_spearman = rowname)

cs2019_pct0_10 <- IC2019cs |>
  select(Pct0to10k) |>
  rename(cs2019_pct0_10 = Pct0to10k)

ps2019_pct0_10 <- IC2019ps |>
  select(Pct0to10k) |>
  rename(ps2019_pct0to10k = Pct0to10k)

cs2019_pct10_15 <- IC2019cs |>
  select(Pct10kto14999) |>
  rename(cs2019_pct10_15 = Pct10kto14999)

ps2019_pct10_15 <- IC2019ps |>
  select(Pct10kto14999) |>
  rename(ps2019_pct10_15 = Pct10kto14999)

cs2019_pct15_25 <- IC2019cs |>
  select(Pct15kto24999...8) |>
  rename(cs2019_pct15_25 = Pct15kto24999...8)

ps2019_pct15_25 <- IC2019ps |>
  select(Pct15kto24999...8) |>
  rename(ps2019_pct15_25 = Pct15kto24999...8)

cs2019_pct25_35 <- IC2019cs |>
  select(Pct25kto34999) |>
  rename(cs2019_pct25_35 = Pct25kto34999)

ps2019_pct25_35 <- IC2019ps |>
  select(Pct25kto34999) |>
  rename(ps2019_pct25_35 = Pct25kto34999)

cs2019_pct35_50 <- IC2019cs |>
  select(Pct35kto49999) |>
  rename(cs2019_pct35_50 = Pct35kto49999)

ps2019_pct35_50 <- IC2019ps |>
  select(Pct35kto49999) |>
  rename(ps2019_pct35_50 = Pct35kto49999)

cs2019_pct50_75 <- IC2019cs |>
  select(Pct50kto74999) |>
  rename(cs2019_pct50_75 = Pct50kto74999)

ps2019_pct50_75 <- IC2019ps |>
  select(Pct50kto74999) |>
  rename(ps2019_pct50_75 = Pct50kto74999)

cs2019_pct75_100 <- IC2019cs |>
  select(Pct75kto99999) |>
  rename(cs2019_pct75_100 = Pct75kto99999)

ps2019_pct75_100 <- IC2019ps |>
  select(Pct75kto99999) |>
  rename(ps2019_pct75_100 = Pct75kto99999)

cs2019_pct100_150 <- IC2019cs |>
  select(Pct100kto149999) |>
  rename(cs2019_pct100_150 = Pct100kto149999)

ps2019_pct100_150 <- IC2019ps |>
  select(Pct100kto149999) |>
  rename(ps2019_pct100_150 = Pct100kto149999)

cs2019_pct150_200 <- IC2019cs |>
  select(Pct150kto199999) |>
  rename(cs2019_pct150_200 = Pct150kto199999)

ps2019_pct150_200 <- IC2019ps |>
  select(Pct150kto199999) |>
  rename(ps2019_pct150_200 = Pct150kto199999)

cs2019_pct200_up <- IC2019cs |>
  select(Pct200korMore...22) |>
  rename(cs2019_pct200_up = Pct200korMore...22)

ps2019_pct200_up <- IC2019ps |>
  select(Pct200korMore...22) |>
  rename(ps2019_pct200_up = Pct200korMore...22)

cs2019_MedIncome <- IC2019cs |>
  select(HouseholdMedianIncome) |>
  rename(cs2019_MedIncome = HouseholdMedianIncome)

ps2019_MedIncome <- IC2019ps |>
  select(HouseholdMedianIncome) |>
  rename(ps2019_MedIncome = HouseholdMedianIncome)

cs2019_rat200_10 <- IC2019cs |>
  select(r200_10) |>
  rename(cs2019_rat200_10 = r200_10)

ps2019_rat200_10 <- IC2019ps |>
  select(r200_10) |>
  rename(ps2019_rat200_10 = r200_10)

cs2019_rat2_2 <- IC2019cs |>
  select(r2_2) |>
  rename(cs2019_rat2_2 = r2_2)

ps2019_rat2_2 <- IC2019ps |>
  select(r2_2) |>
  rename(ps2019_rat2_2 = r2_2)

cs2019_rat3_3 <- IC2019cs |>
  select(r3_3) |>
  rename(cs2019_rat3_3 = r3_3)

ps2019_rat3_3 <- IC2019ps |>
  select(r3_3) |>
  rename(ps2019_rat3_3 = r3_3)

cs2019_rat4_4 <- IC2019cs |>
  select(r4_4) |>
  rename(cs2019_rat4_4 = r4_4)

ps2019_rat4_4 <- IC2019ps |>
  select(r4_4) |>
  rename(ps2019_rat4_4 = r4_4)

cs2019_rat_half <- IC2019cs |>
  select(r_half) |>
  rename(cs2019_rat_half = r_half)

ps2019_rat_half <- IC2019ps |>
  select(r_half) |>
  rename(ps2019_rat_half = r_half)
```

```{r}
#Create data frame for clear, readable printing
#Create data frame with crime types, 2018 values, cor pearson, p-value pearson
  #c = correlation, p = p-value, pct0-10 = pct of population income $0-$10,000
prownames2018 <- IC2018cp |>
  select(rowname) |>
  rename(crime_2018_pearson = rowname)

cp2018_pct0_10 <- IC2018cp |>
  select(Pct0to10k) |>
  rename(cp2018_pct0_10 = Pct0to10k)

pp2018_pct0_10 <- IC2018pp |>
  select(Pct0to10k) |>
  rename(pp2018_pct0to10k = Pct0to10k)

cp2018_pct10_15 <- IC2018cp |>
  select(Pct10kto14999) |>
  rename(cp2018_pct10_15 = Pct10kto14999)

pp2018_pct10_15 <- IC2018pp |>
  select(Pct10kto14999) |>
  rename(pp2018_pct10_15 = Pct10kto14999)

cp2018_pct15_25 <- IC2018cp |>
  select(Pct15kto24999...8) |>
  rename(cp2018_pct15_25 = Pct15kto24999...8)

pp2018_pct15_25 <- IC2018pp |>
  select(Pct15kto24999...8) |>
  rename(pp2018_pct15_25 = Pct15kto24999...8)

cp2018_pct25_35 <- IC2018cp |>
  select(Pct25kto34999) |>
  rename(cp2018_pct25_35 = Pct25kto34999)

pp2018_pct25_35 <- IC2018pp |>
  select(Pct25kto34999) |>
  rename(pp2018_pct25_35 = Pct25kto34999)

cp2018_pct35_50 <- IC2018cp |>
  select(Pct35kto49999) |>
  rename(cp2018_pct35_50 = Pct35kto49999)

pp2018_pct35_50 <- IC2018pp |>
  select(Pct35kto49999) |>
  rename(pp2018_pct35_50 = Pct35kto49999)

cp2018_pct50_75 <- IC2018cp |>
  select(Pct50kto74999) |>
  rename(cp2018_pct50_75 = Pct50kto74999)

pp2018_pct50_75 <- IC2018pp |>
  select(Pct50kto74999) |>
  rename(pp2018_pct50_75 = Pct50kto74999)

cp2018_pct75_100 <- IC2018cp |>
  select(Pct75kto99999) |>
  rename(cp2018_pct75_100 = Pct75kto99999)

pp2018_pct75_100 <- IC2018pp |>
  select(Pct75kto99999) |>
  rename(pp2018_pct75_100 = Pct75kto99999)

cp2018_pct100_150 <- IC2018cp |>
  select(Pct100kto149999) |>
  rename(cp2018_pct100_150 = Pct100kto149999)

pp2018_pct100_150 <- IC2018pp |>
  select(Pct100kto149999) |>
  rename(pp2018_pct100_150 = Pct100kto149999)

cp2018_pct150_200 <- IC2018cp |>
  select(Pct150kto199999) |>
  rename(cp2018_pct150_200 = Pct150kto199999)

pp2018_pct150_200 <- IC2018pp |>
  select(Pct150kto199999) |>
  rename(pp2018_pct150_200 = Pct150kto199999)

cp2018_pct200_up <- IC2018cp |>
  select(Pct200korMore...22) |>
  rename(cp2018_pct200_up = Pct200korMore...22)

pp2018_pct200_up <- IC2018pp |>
  select(Pct200korMore...22) |>
  rename(pp2018_pct200_up = Pct200korMore...22)

cp2018_MedIncome <- IC2018cp |>
  select(HouseholdMedianIncome) |>
  rename(cp2018_MedIncome = HouseholdMedianIncome)

pp2018_MedIncome <- IC2018pp |>
  select(HouseholdMedianIncome) |>
  rename(pp2018_MedIncome = HouseholdMedianIncome)

cp2018_rat200_10 <- IC2018cp |>
  select(r200_10) |>
  rename(cp2018_rat200_10 = r200_10)

pp2018_rat200_10 <- IC2018pp |>
  select(r200_10) |>
  rename(pp2018_rat200_10 = r200_10)

cp2018_rat2_2 <- IC2018cp |>
  select(r2_2) |>
  rename(cp2018_rat2_2 = r2_2)

pp2018_rat2_2 <- IC2018pp |>
  select(r2_2) |>
  rename(pp2018_rat2_2 = r2_2)

cp2018_rat3_3 <- IC2018cp |>
  select(r3_3) |>
  rename(cp2018_rat3_3 = r3_3)

pp2018_rat3_3 <- IC2018pp |>
  select(r3_3) |>
  rename(pp2018_rat3_3 = r3_3)

cp2018_rat4_4 <- IC2018cp |>
  select(r4_4) |>
  rename(cp2018_rat4_4 = r4_4)

pp2018_rat4_4 <- IC2018pp |>
  select(r4_4) |>
  rename(pp2018_rat4_4 = r4_4)

cp2018_rat_half <- IC2018cp |>
  select(r_half) |>
  rename(cp2018_rat_half = r_half)

pp2018_rat_half <- IC2018pp |>
  select(r_half) |>
  rename(pp2018_rat_half = r_half)

#Create data frame with crime types, 2018 values, cor kendall, p-value kendall
krownames2018 <- IC2018ck |>
  select(rowname) |>
  rename(crime_2018_kendall = rowname)

ck2018_pct0_10 <- IC2018ck |>
  select(Pct0to10k) |>
  rename(ck2018_pct0_10 = Pct0to10k)

pk2018_pct0_10 <- IC2018pk |>
  select(Pct0to10k) |>
  rename(pk2018_pct0to10k = Pct0to10k)

ck2018_pct10_15 <- IC2018ck |>
  select(Pct10kto14999) |>
  rename(ck2018_pct10_15 = Pct10kto14999)

pk2018_pct10_15 <- IC2018pk |>
  select(Pct10kto14999) |>
  rename(pk2018_pct10_15 = Pct10kto14999)

ck2018_pct15_25 <- IC2018ck |>
  select(Pct15kto24999...8) |>
  rename(ck2018_pct15_25 = Pct15kto24999...8)

pk2018_pct15_25 <- IC2018pk |>
  select(Pct15kto24999...8) |>
  rename(pk2018_pct15_25 = Pct15kto24999...8)

ck2018_pct25_35 <- IC2018ck |>
  select(Pct25kto34999) |>
  rename(ck2018_pct25_35 = Pct25kto34999)

pk2018_pct25_35 <- IC2018pk |>
  select(Pct25kto34999) |>
  rename(pk2018_pct25_35 = Pct25kto34999)

ck2018_pct35_50 <- IC2018ck |>
  select(Pct35kto49999) |>
  rename(ck2018_pct35_50 = Pct35kto49999)

pk2018_pct35_50 <- IC2018pk |>
  select(Pct35kto49999) |>
  rename(pk2018_pct35_50 = Pct35kto49999)

ck2018_pct50_75 <- IC2018ck |>
  select(Pct50kto74999) |>
  rename(ck2018_pct50_75 = Pct50kto74999)

pk2018_pct50_75 <- IC2018pk |>
  select(Pct50kto74999) |>
  rename(pk2018_pct50_75 = Pct50kto74999)

ck2018_pct75_100 <- IC2018ck |>
  select(Pct75kto99999) |>
  rename(ck2018_pct75_100 = Pct75kto99999)

pk2018_pct75_100 <- IC2018pk |>
  select(Pct75kto99999) |>
  rename(pk2018_pct75_100 = Pct75kto99999)

ck2018_pct100_150 <- IC2018ck |>
  select(Pct100kto149999) |>
  rename(ck2018_pct100_150 = Pct100kto149999)

pk2018_pct100_150 <- IC2018pk |>
  select(Pct100kto149999) |>
  rename(pk2018_pct100_150 = Pct100kto149999)

ck2018_pct150_200 <- IC2018ck |>
  select(Pct150kto199999) |>
  rename(ck2018_pct150_200 = Pct150kto199999)

pk2018_pct150_200 <- IC2018pk |>
  select(Pct150kto199999) |>
  rename(pk2018_pct150_200 = Pct150kto199999)

ck2018_pct200_up <- IC2018ck |>
  select(Pct200korMore...22) |>
  rename(ck2018_pct200_up = Pct200korMore...22)

pk2018_pct200_up <- IC2018pk |>
  select(Pct200korMore...22) |>
  rename(pk2018_pct200_up = Pct200korMore...22)

ck2018_MedIncome <- IC2018ck |>
  select(HouseholdMedianIncome) |>
  rename(ck2018_MedIncome = HouseholdMedianIncome)

pk2018_MedIncome <- IC2018pk |>
  select(HouseholdMedianIncome) |>
  rename(pk2018_MedIncome = HouseholdMedianIncome)

ck2018_rat200_10 <- IC2018ck |>
  select(r200_10) |>
  rename(ck2018_rat200_10 = r200_10)

pk2018_rat200_10 <- IC2018pk |>
  select(r200_10) |>
  rename(pk2018_rat200_10 = r200_10)

ck2018_rat2_2 <- IC2018ck |>
  select(r2_2) |>
  rename(ck2018_rat2_2 = r2_2)

pk2018_rat2_2 <- IC2018pk |>
  select(r2_2) |>
  rename(pk2018_rat2_2 = r2_2)

ck2018_rat3_3 <- IC2018ck |>
  select(r3_3) |>
  rename(ck2018_rat3_3 = r3_3)

pk2018_rat3_3 <- IC2018pk |>
  select(r3_3) |>
  rename(pk2018_rat3_3 = r3_3)

ck2018_rat4_4 <- IC2018ck |>
  select(r4_4) |>
  rename(ck2018_rat4_4 = r4_4)

pk2018_rat4_4 <- IC2018pk |>
  select(r4_4) |>
  rename(pk2018_rat4_4 = r4_4)

ck2018_rat_half <- IC2018ck |>
  select(r_half) |>
  rename(ck2018_rat_half = r_half)

pk2018_rat_half <- IC2018pk |>
  select(r_half) |>
  rename(pk2018_rat_half = r_half)

#Create data frame with crime types, 2018 values, cor spearman, p-value spearman
srownames2018 <- IC2018cs |>
  select(rowname) |>
  rename(crime_2018_spearman = rowname)

cs2018_pct0_10 <- IC2018cs |>
  select(Pct0to10k) |>
  rename(cs2018_pct0_10 = Pct0to10k)

ps2018_pct0_10 <- IC2018ps |>
  select(Pct0to10k) |>
  rename(ps2018_pct0to10k = Pct0to10k)

cs2018_pct10_15 <- IC2018cs |>
  select(Pct10kto14999) |>
  rename(cs2018_pct10_15 = Pct10kto14999)

ps2018_pct10_15 <- IC2018ps |>
  select(Pct10kto14999) |>
  rename(ps2018_pct10_15 = Pct10kto14999)

cs2018_pct15_25 <- IC2018cs |>
  select(Pct15kto24999...8) |>
  rename(cs2018_pct15_25 = Pct15kto24999...8)

ps2018_pct15_25 <- IC2018ps |>
  select(Pct15kto24999...8) |>
  rename(ps2018_pct15_25 = Pct15kto24999...8)

cs2018_pct25_35 <- IC2018cs |>
  select(Pct25kto34999) |>
  rename(cs2018_pct25_35 = Pct25kto34999)

ps2018_pct25_35 <- IC2018ps |>
  select(Pct25kto34999) |>
  rename(ps2018_pct25_35 = Pct25kto34999)

cs2018_pct35_50 <- IC2018cs |>
  select(Pct35kto49999) |>
  rename(cs2018_pct35_50 = Pct35kto49999)

ps2018_pct35_50 <- IC2018ps |>
  select(Pct35kto49999) |>
  rename(ps2018_pct35_50 = Pct35kto49999)

cs2018_pct50_75 <- IC2018cs |>
  select(Pct50kto74999) |>
  rename(cs2018_pct50_75 = Pct50kto74999)

ps2018_pct50_75 <- IC2018ps |>
  select(Pct50kto74999) |>
  rename(ps2018_pct50_75 = Pct50kto74999)

cs2018_pct75_100 <- IC2018cs |>
  select(Pct75kto99999) |>
  rename(cs2018_pct75_100 = Pct75kto99999)

ps2018_pct75_100 <- IC2018ps |>
  select(Pct75kto99999) |>
  rename(ps2018_pct75_100 = Pct75kto99999)

cs2018_pct100_150 <- IC2018cs |>
  select(Pct100kto149999) |>
  rename(cs2018_pct100_150 = Pct100kto149999)

ps2018_pct100_150 <- IC2018ps |>
  select(Pct100kto149999) |>
  rename(ps2018_pct100_150 = Pct100kto149999)

cs2018_pct150_200 <- IC2018cs |>
  select(Pct150kto199999) |>
  rename(cs2018_pct150_200 = Pct150kto199999)

ps2018_pct150_200 <- IC2018ps |>
  select(Pct150kto199999) |>
  rename(ps2018_pct150_200 = Pct150kto199999)

cs2018_pct200_up <- IC2018cs |>
  select(Pct200korMore...22) |>
  rename(cs2018_pct200_up = Pct200korMore...22)

ps2018_pct200_up <- IC2018ps |>
  select(Pct200korMore...22) |>
  rename(ps2018_pct200_up = Pct200korMore...22)

cs2018_MedIncome <- IC2018cs |>
  select(HouseholdMedianIncome) |>
  rename(cs2018_MedIncome = HouseholdMedianIncome)

ps2018_MedIncome <- IC2018ps |>
  select(HouseholdMedianIncome) |>
  rename(ps2018_MedIncome = HouseholdMedianIncome)

cs2018_rat200_10 <- IC2018cs |>
  select(r200_10) |>
  rename(cs2018_rat200_10 = r200_10)

ps2018_rat200_10 <- IC2018ps |>
  select(r200_10) |>
  rename(ps2018_rat200_10 = r200_10)

cs2018_rat2_2 <- IC2018cs |>
  select(r2_2) |>
  rename(cs2018_rat2_2 = r2_2)

ps2018_rat2_2 <- IC2018ps |>
  select(r2_2) |>
  rename(ps2018_rat2_2 = r2_2)

cs2018_rat3_3 <- IC2018cs |>
  select(r3_3) |>
  rename(cs2018_rat3_3 = r3_3)

ps2018_rat3_3 <- IC2018ps |>
  select(r3_3) |>
  rename(ps2018_rat3_3 = r3_3)

cs2018_rat4_4 <- IC2018cs |>
  select(r4_4) |>
  rename(cs2018_rat4_4 = r4_4)

ps2018_rat4_4 <- IC2018ps |>
  select(r4_4) |>
  rename(ps2018_rat4_4 = r4_4)

cs2018_rat_half <- IC2018cs |>
  select(r_half) |>
  rename(cs2018_rat_half = r_half)

ps2018_rat_half <- IC2018ps |>
  select(r_half) |>
  rename(ps2018_rat_half = r_half)
```

```{r}
#Create clean tables with crime types, 2022 values, cor pearson, p-value pearson (PRINTED as "IC2022_p.docx")
p2022_1 <- cbind(prownames2022, cp2022_pct0_10, pp2022_pct0_10, cp2022_pct10_15, pp2022_pct10_15, cp2022_pct15_25, pp2022_pct15_25, cp2022_pct25_35, pp2022_pct25_35, cp2022_pct35_50, pp2022_pct35_50)
p2022_1_table <- nice_table(p2022_1 , highlight = TRUE)
print(p2022_1_table , preview = "docx")

p2022_2 <- cbind(prownames2022, cp2022_pct50_75, pp2022_pct50_75, cp2022_pct75_100, pp2022_pct75_100, cp2022_pct100_150, pp2022_pct100_150, cp2022_pct150_200, pp2022_pct150_200, cp2022_pct200_up, pp2022_pct200_up)
p2022_2_table <- nice_table(p2022_2 , highlight = TRUE)
print(p2022_2_table , preview = "docx")

p2022_3 <- cbind(prownames2022, cp2022_MedIncome, pp2022_MedIncome, cp2022_rat200_10, pp2022_rat200_10, cp2022_rat2_2, pp2022_rat2_2, cp2022_rat3_3, pp2022_rat3_3, cp2022_rat4_4, pp2022_rat4_4, cp2022_rat_half, pp2022_rat_half)
p2022_3_table <- nice_table(p2022_3 , highlight = TRUE)
print(p2022_3_table , preview = "docx")

#Create clean tables with crime types, 2022 values, cor kendall, p-value kendall (PRINTED as "IC2022_k.docx")
k2022_1 <- cbind(krownames2022, ck2022_pct0_10, pk2022_pct0_10, ck2022_pct10_15, pk2022_pct10_15, ck2022_pct15_25, pk2022_pct15_25, ck2022_pct25_35, pk2022_pct25_35, ck2022_pct35_50, pk2022_pct35_50)
k2022_1_table <- nice_table(k2022_1 , highlight = TRUE)
print(k2022_1_table , preview = "docx")

k2022_2 <- cbind(krownames2022, ck2022_pct50_75, pk2022_pct50_75, ck2022_pct75_100, pk2022_pct75_100, ck2022_pct100_150, pk2022_pct100_150, ck2022_pct150_200, pk2022_pct150_200, ck2022_pct200_up, pk2022_pct200_up)
k2022_2_table <- nice_table(k2022_2 , highlight = TRUE)
print(k2022_2_table , preview = "docx")

k2022_3 <- cbind(krownames2022, ck2022_MedIncome, pk2022_MedIncome, ck2022_rat200_10, pk2022_rat200_10, ck2022_rat2_2, pk2022_rat2_2, ck2022_rat3_3, pk2022_rat3_3, ck2022_rat4_4, pk2022_rat4_4, ck2022_rat_half, pk2022_rat_half)
k2022_3_table <- nice_table(k2022_3 , highlight = TRUE)
print(k2022_3_table , preview = "docx")

#Create clean with crime types, 2022 values, cor spearman, p-value spearman (PRINTED as "IC2022_s .docx")
s2022_1 <- cbind(srownames2022, cs2022_pct0_10, ps2022_pct0_10, cs2022_pct10_15, ps2022_pct10_15, cs2022_pct15_25, ps2022_pct15_25, cs2022_pct25_35, ps2022_pct25_35, cs2022_pct35_50, ps2022_pct35_50)
s2022_1_table <- nice_table(s2022_1 , highlight = TRUE)
print(s2022_1_table , preview = "docx")

s2022_2 <- cbind(srownames2022, cs2022_pct50_75, ps2022_pct50_75, cs2022_pct75_100, ps2022_pct75_100, cs2022_pct100_150, ps2022_pct100_150, cs2022_pct150_200, ps2022_pct150_200, cs2022_pct200_up, ps2022_pct200_up)
s2022_2_table <- nice_table(s2022_2 , highlight = TRUE)
print(s2022_2_table , preview = "docx")

s2022_3 <- cbind(srownames2022, cs2022_MedIncome, ps2022_MedIncome, cs2022_rat200_10, ps2022_rat200_10, cs2022_rat2_2, ps2022_rat2_2, cs2022_rat3_3, ps2022_rat3_3, cs2022_rat4_4, ps2022_rat4_4, cs2022_rat_half, ps2022_rat_half)
s2022_3_table <- nice_table(s2022_3 , highlight = TRUE)
print(s2022_3_table , preview = "docx")
```

```{r}
#Create clean tables with crime types, 2021 values, cor pearson, p-value pearson (PRINTED as "IC2021_p .docx")
p2021_1 <- cbind(prownames2021, cp2021_pct0_10, pp2021_pct0_10, cp2021_pct10_15, pp2021_pct10_15, cp2021_pct15_25, pp2021_pct15_25, cp2021_pct25_35, pp2021_pct25_35, cp2021_pct35_50, pp2021_pct35_50)
p2021_1_table <- nice_table(p2021_1 , highlight = TRUE)
print(p2021_1_table , preview = "docx")

p2021_2 <- cbind(prownames2021, cp2021_pct50_75, pp2021_pct50_75, cp2021_pct75_100, pp2021_pct75_100, cp2021_pct100_150, pp2021_pct100_150, cp2021_pct150_200, pp2021_pct150_200, cp2021_pct200_up, pp2021_pct200_up)
p2021_2_table <- nice_table(p2021_2 , highlight = TRUE)
print(p2021_2_table , preview = "docx")

p2021_3 <- cbind(prownames2021, cp2021_MedIncome, pp2021_MedIncome, cp2021_rat200_10, pp2021_rat200_10, cp2021_rat2_2, pp2021_rat2_2, cp2021_rat3_3, pp2021_rat3_3, cp2021_rat4_4, pp2021_rat4_4, cp2021_rat_half, pp2021_rat_half)
p2021_3_table <- nice_table(p2021_3 , highlight = TRUE)
print(p2021_3_table , preview = "docx")

#Create clean tables with crime types, 2021 values, cor spearman, p-value kendall
k2021_1 <- cbind(krownames2021, ck2021_pct0_10, pk2021_pct0_10, ck2021_pct10_15, pk2021_pct10_15, ck2021_pct15_25, pk2021_pct15_25, ck2021_pct25_35, pk2021_pct25_35, ck2021_pct35_50, pk2021_pct35_50)
k2021_1_table <- nice_table(k2021_1 , highlight = TRUE)
print(k2021_1_table , preview = "docx")

k2021_2 <- cbind(krownames2021, ck2021_pct50_75, pk2021_pct50_75, ck2021_pct75_100, pk2021_pct75_100, ck2021_pct100_150, pk2021_pct100_150, ck2021_pct150_200, pk2021_pct150_200, ck2021_pct200_up, pk2021_pct200_up)
k2021_2_table <- nice_table(k2021_2 , highlight = TRUE)
print(k2021_2_table , preview = "docx")

k2021_3 <- cbind(krownames2021, ck2021_MedIncome, pk2021_MedIncome, ck2021_rat200_10, pk2021_rat200_10, ck2021_rat2_2, pk2021_rat2_2, ck2021_rat3_3, pk2021_rat3_3, ck2021_rat4_4, pk2021_rat4_4, ck2021_rat_half, pk2021_rat_half)
k2021_3_table <- nice_table(k2021_3 , highlight = TRUE)
print(k2021_3_table , preview = "docx")

#Create clean with crime types, 2021 values, cor spearman, p-value spearman
s2021_1 <- cbind(srownames2021, cs2021_pct0_10, ps2021_pct0_10, cs2021_pct10_15, ps2021_pct10_15, cs2021_pct15_25, ps2021_pct15_25, cs2021_pct25_35, ps2021_pct25_35, cs2021_pct35_50, ps2021_pct35_50)
s2021_1_table <- nice_table(s2021_1 , highlight = TRUE)
print(s2021_1_table , preview = "docx")

s2021_2 <- cbind(srownames2021, cs2021_pct50_75, ps2021_pct50_75, cs2021_pct75_100, ps2021_pct75_100, cs2021_pct100_150, ps2021_pct100_150, cs2021_pct150_200, ps2021_pct150_200, cs2021_pct200_up, ps2021_pct200_up)
s2021_2_table <- nice_table(s2021_2 , highlight = TRUE)
print(s2021_2_table , preview = "docx")

s2021_3 <- cbind(srownames2021, cs2021_MedIncome, ps2021_MedIncome, cs2021_rat200_10, ps2021_rat200_10, cs2021_rat2_2, ps2021_rat2_2, cs2021_rat3_3, ps2021_rat3_3, cs2021_rat4_4, ps2021_rat4_4, cs2021_rat_half, ps2021_rat_half)
s2021_3_table <- nice_table(s2021_3 , highlight = TRUE)
print(s2021_3_table , preview = "docx")
```

```{r}
#Create clean tables with crime types, 2020 values, cor pearson, p-value pearson
p2020_1 <- cbind(prownames2020, cp2020_pct0_10, pp2020_pct0_10, cp2020_pct10_15, pp2020_pct10_15, cp2020_pct15_25, pp2020_pct15_25, cp2020_pct25_35, pp2020_pct25_35, cp2020_pct35_50, pp2020_pct35_50)
p2020_1_table <- nice_table(p2020_1 , highlight = TRUE)
print(p2020_1_table , preview = "docx")

p2020_2 <- cbind(prownames2020, cp2020_pct50_75, pp2020_pct50_75, cp2020_pct75_100, pp2020_pct75_100, cp2020_pct100_150, pp2020_pct100_150, cp2020_pct150_200, pp2020_pct150_200, cp2020_pct200_up, pp2020_pct200_up)
p2020_2_table <- nice_table(p2020_2 , highlight = TRUE)
print(p2020_2_table , preview = "docx")

p2020_3 <- cbind(prownames2020, cp2020_MedIncome, pp2020_MedIncome, cp2020_rat200_10, pp2020_rat200_10, cp2020_rat2_2, pp2020_rat2_2, cp2020_rat3_3, pp2020_rat3_3, cp2020_rat4_4, pp2020_rat4_4, cp2020_rat_half, pp2020_rat_half)
p2020_3_table <- nice_table(p2020_3 , highlight = TRUE)
print(p2020_3_table , preview = "docx")

#Create clean tables with crime types, 2020 values, cor spearman, p-value kendall
k2020_1 <- cbind(krownames2020, ck2020_pct0_10, pk2020_pct0_10, ck2020_pct10_15, pk2020_pct10_15, ck2020_pct15_25, pk2020_pct15_25, ck2020_pct25_35, pk2020_pct25_35, ck2020_pct35_50, pk2020_pct35_50)
k2020_1_table <- nice_table(k2020_1 , highlight = TRUE)
print(k2020_1_table , preview = "docx")

k2020_2 <- cbind(krownames2020, ck2020_pct50_75, pk2020_pct50_75, ck2020_pct75_100, pk2020_pct75_100, ck2020_pct100_150, pk2020_pct100_150, ck2020_pct150_200, pk2020_pct150_200, ck2020_pct200_up, pk2020_pct200_up)
k2020_2_table <- nice_table(k2020_2 , highlight = TRUE)
print(k2020_2_table , preview = "docx")

k2020_3 <- cbind(krownames2020, ck2020_MedIncome, pk2020_MedIncome, ck2020_rat200_10, pk2020_rat200_10, ck2020_rat2_2, pk2020_rat2_2, ck2020_rat3_3, pk2020_rat3_3, ck2020_rat4_4, pk2020_rat4_4, ck2020_rat_half, pk2020_rat_half)
k2020_3_table <- nice_table(k2020_3 , highlight = TRUE)
print(k2020_3_table , preview = "docx")

#Create clean with crime types, 2020 values, cor spearman, p-value spearman
s2020_1 <- cbind(srownames2020, cs2020_pct0_10, ps2020_pct0_10, cs2020_pct10_15, ps2020_pct10_15, cs2020_pct15_25, ps2020_pct15_25, cs2020_pct25_35, ps2020_pct25_35, cs2020_pct35_50, ps2020_pct35_50)
s2020_1_table <- nice_table(s2020_1 , highlight = TRUE)
print(s2020_1_table , preview = "docx")

s2020_2 <- cbind(srownames2020, cs2020_pct50_75, ps2020_pct50_75, cs2020_pct75_100, ps2020_pct75_100, cs2020_pct100_150, ps2020_pct100_150, cs2020_pct150_200, ps2020_pct150_200, cs2020_pct200_up, ps2020_pct200_up)
s2020_2_table <- nice_table(s2020_2 , highlight = TRUE)
print(s2020_2_table , preview = "docx")

s2020_3 <- cbind(srownames2020, cs2020_MedIncome, ps2020_MedIncome, cs2020_rat200_10, ps2020_rat200_10, cs2020_rat2_2, ps2020_rat2_2, cs2020_rat3_3, ps2020_rat3_3, cs2020_rat4_4, ps2020_rat4_4, cs2020_rat_half, ps2020_rat_half)
s2020_3_table <- nice_table(s2020_3 , highlight = TRUE)
print(s2020_3_table , preview = "docx")
```

```{r}
#Create clean tables with crime types, 2019 values, cor pearson, p-value pearson
p2019_1 <- cbind(prownames2019, cp2019_pct0_10, pp2019_pct0_10, cp2019_pct10_15, pp2019_pct10_15, cp2019_pct15_25, pp2019_pct15_25, cp2019_pct25_35, pp2019_pct25_35, cp2019_pct35_50, pp2019_pct35_50)
p2019_1_table <- nice_table(p2019_1 , highlight = TRUE)
print(p2019_1_table , preview = "docx")

p2019_2 <- cbind(prownames2019, cp2019_pct50_75, pp2019_pct50_75, cp2019_pct75_100, pp2019_pct75_100, cp2019_pct100_150, pp2019_pct100_150, cp2019_pct150_200, pp2019_pct150_200, cp2019_pct200_up, pp2019_pct200_up)
p2019_2_table <- nice_table(p2019_2 , highlight = TRUE)
print(p2019_2_table , preview = "docx")

p2019_3 <- cbind(prownames2019, cp2019_MedIncome, pp2019_MedIncome, cp2019_rat200_10, pp2019_rat200_10, cp2019_rat2_2, pp2019_rat2_2, cp2019_rat3_3, pp2019_rat3_3, cp2019_rat4_4, pp2019_rat4_4, cp2019_rat_half, pp2019_rat_half)
p2019_3_table <- nice_table(p2019_3 , highlight = TRUE)
print(p2019_3_table , preview = "docx")

#Create clean tables with crime types, 2019 values, cor spearman, p-value kendall
k2019_1 <- cbind(krownames2019, ck2019_pct0_10, pk2019_pct0_10, ck2019_pct10_15, pk2019_pct10_15, ck2019_pct15_25, pk2019_pct15_25, ck2019_pct25_35, pk2019_pct25_35, ck2019_pct35_50, pk2019_pct35_50)
k2019_1_table <- nice_table(k2019_1 , highlight = TRUE)
print(k2019_1_table , preview = "docx")

k2019_2 <- cbind(krownames2019, ck2019_pct50_75, pk2019_pct50_75, ck2019_pct75_100, pk2019_pct75_100, ck2019_pct100_150, pk2019_pct100_150, ck2019_pct150_200, pk2019_pct150_200, ck2019_pct200_up, pk2019_pct200_up)
k2019_2_table <- nice_table(k2019_2 , highlight = TRUE)
print(k2019_2_table , preview = "docx")

k2019_3 <- cbind(krownames2019, ck2019_MedIncome, pk2019_MedIncome, ck2019_rat200_10, pk2019_rat200_10, ck2019_rat2_2, pk2019_rat2_2, ck2019_rat3_3, pk2019_rat3_3, ck2019_rat4_4, pk2019_rat4_4, ck2019_rat_half, pk2019_rat_half)
k2019_3_table <- nice_table(k2019_3 , highlight = TRUE)
print(k2019_3_table , preview = "docx")

#Create clean with crime types, 2019 values, cor spearman, p-value spearman
s2019_1 <- cbind(srownames2019, cs2019_pct0_10, ps2019_pct0_10, cs2019_pct10_15, ps2019_pct10_15, cs2019_pct15_25, ps2019_pct15_25, cs2019_pct25_35, ps2019_pct25_35, cs2019_pct35_50, ps2019_pct35_50)
s2019_1_table <- nice_table(s2019_1 , highlight = TRUE)
print(s2019_1_table , preview = "docx")

s2019_2 <- cbind(srownames2019, cs2019_pct50_75, ps2019_pct50_75, cs2019_pct75_100, ps2019_pct75_100, cs2019_pct100_150, ps2019_pct100_150, cs2019_pct150_200, ps2019_pct150_200, cs2019_pct200_up, ps2019_pct200_up)
s2019_2_table <- nice_table(s2019_2 , highlight = TRUE)
print(s2019_2_table , preview = "docx")

s2019_3 <- cbind(srownames2019, cs2019_MedIncome, ps2019_MedIncome, cs2019_rat200_10, ps2019_rat200_10, cs2019_rat2_2, ps2019_rat2_2, cs2019_rat3_3, ps2019_rat3_3, cs2019_rat4_4, ps2019_rat4_4, cs2019_rat_half, ps2019_rat_half)
s2019_3_table <- nice_table(s2019_3 , highlight = TRUE)
print(s2019_3_table , preview = "docx")
```

```{r}
#Create clean tables with crime types, 2018 values, cor pearson, p-value pearson
p2018_1 <- cbind(prownames2018, cp2018_pct0_10, pp2018_pct0_10, cp2018_pct10_15, pp2018_pct10_15, cp2018_pct15_25, pp2018_pct15_25, cp2018_pct25_35, pp2018_pct25_35, cp2018_pct35_50, pp2018_pct35_50)
p2018_1_table <- nice_table(p2018_1 , highlight = TRUE)
print(p2018_1_table , preview = "docx")

p2018_2 <- cbind(prownames2018, cp2018_pct50_75, pp2018_pct50_75, cp2018_pct75_100, pp2018_pct75_100, cp2018_pct100_150, pp2018_pct100_150, cp2018_pct150_200, pp2018_pct150_200, cp2018_pct200_up, pp2018_pct200_up)
p2018_2_table <- nice_table(p2018_2 , highlight = TRUE)
print(p2018_2_table , preview = "docx")

p2018_3 <- cbind(prownames2018, cp2018_MedIncome, pp2018_MedIncome, cp2018_rat200_10, pp2018_rat200_10, cp2018_rat2_2, pp2018_rat2_2, cp2018_rat3_3, pp2018_rat3_3, cp2018_rat4_4, pp2018_rat4_4, cp2018_rat_half, pp2018_rat_half)
p2018_3_table <- nice_table(p2018_3 , highlight = TRUE)
print(p2018_3_table , preview = "docx")

#Create clean tables with crime types, 2018 values, cor spearman, p-value kendall
k2018_1 <- cbind(krownames2018, ck2018_pct0_10, pk2018_pct0_10, ck2018_pct10_15, pk2018_pct10_15, ck2018_pct15_25, pk2018_pct15_25, ck2018_pct25_35, pk2018_pct25_35, ck2018_pct35_50, pk2018_pct35_50)
k2018_1_table <- nice_table(k2018_1 , highlight = TRUE)
print(k2018_1_table , preview = "docx")

k2018_2 <- cbind(krownames2018, ck2018_pct50_75, pk2018_pct50_75, ck2018_pct75_100, pk2018_pct75_100, ck2018_pct100_150, pk2018_pct100_150, ck2018_pct150_200, pk2018_pct150_200, ck2018_pct200_up, pk2018_pct200_up)
k2018_2_table <- nice_table(k2018_2 , highlight = TRUE)
print(k2018_2_table , preview = "docx")

k2018_3 <- cbind(krownames2018, ck2018_MedIncome, pk2018_MedIncome, ck2018_rat200_10, pk2018_rat200_10, ck2018_rat2_2, pk2018_rat2_2, ck2018_rat3_3, pk2018_rat3_3, ck2018_rat4_4, pk2018_rat4_4, ck2018_rat_half, pk2018_rat_half)
k2018_3_table <- nice_table(k2018_3 , highlight = TRUE)
print(k2018_3_table , preview = "docx")

#Create clean with crime types, 2018 values, cor spearman, p-value spearman
s2018_1 <- cbind(srownames2018, cs2018_pct0_10, ps2018_pct0_10, cs2018_pct10_15, ps2018_pct10_15, cs2018_pct15_25, ps2018_pct15_25, cs2018_pct25_35, ps2018_pct25_35, cs2018_pct35_50, ps2018_pct35_50)
s2018_1_table <- nice_table(s2018_1 , highlight = TRUE)
print(s2018_1_table , preview = "docx")

s2018_2 <- cbind(srownames2018, cs2018_pct50_75, ps2018_pct50_75, cs2018_pct75_100, ps2018_pct75_100, cs2018_pct100_150, ps2018_pct100_150, cs2018_pct150_200, ps2018_pct150_200, cs2018_pct200_up, ps2018_pct200_up)
s2018_2_table <- nice_table(s2018_2 , highlight = TRUE)
print(s2018_2_table , preview = "docx")

s2018_3 <- cbind(srownames2018, cs2018_MedIncome, ps2018_MedIncome, cs2018_rat200_10, ps2018_rat200_10, cs2018_rat2_2, ps2018_rat2_2, cs2018_rat3_3, ps2018_rat3_3, cs2018_rat4_4, ps2018_rat4_4, cs2018_rat_half, ps2018_rat_half)
s2018_3_table <- nice_table(s2018_3 , highlight = TRUE)
print(s2018_3_table , preview = "docx")
```

```{r}
#Simple linear regression

plot(Crime2022$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k)
plot(Crime2022$MurderNonNegManslaughter ~ S1901Income2022$Pct0to10k)
hist(Crime2022$BurglaryBreakingEntering, breaks = 30)
cor(Crime2022$BurglaryBreakingEntering , S1901Income2022$Pct0to10k)
hist(S1901Income2022$Pct0to10k, breaks = 30)
cor(S1901Income2022$Pct0to10k , S1901Income2022$Pct200korMore...22)

Burglary.Pct0to10k.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k)
summary(Burglary.Pct0to10k.lm)

BurglaryBOTH.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct200korMore...22)
summary(BurglaryBOTH.lm)

Prostitution.Pct200up.lm <- lm(formula = Crime2022_tnfd$Prostitution ~ S1901Income2022$Pct200korMore...22)
summary(Prostitution.Pct200up.lm)

ProstitutionBOTH.lm <- lm(formula = Crime2022_tnfd$Prostitution ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct200korMore...22)
summary(ProstitutionBOTH.lm)

AssistProstitution.Pct200up.lm <- lm(formula = Crime2022_tnfd$AssistPromoteProstitution ~ S1901Income2022$Pct200korMore...22)
summary(AssistProstitution.Pct200up.lm)

Hacking.Pct200up.lm <- lm(formula = Crime2022_tnfd$HackingComputerInvasion ~ S1901Income2022$Pct200korMore...22)
summary(Hacking.Pct200up.lm)

TheftfromVehicle.Pct200up.lm <- lm(formula = Crime2022_tnfd$TheftFromVehicle ~ S1901Income2022$Pct200korMore...22)
summary(TheftfromVehicle.Pct200up.lm)

VehicleTheft.Pct0to10.lm <- lm(formula = Crime2022_tnfd$VehicleTheft ~ S1901Income2022$Pct0to10k)
summary(VehicleTheft.Pct0to10.lm)

AggAssault.Pct0to10.lm <- lm(formula = Crime2022_tnfd$AggAssault ~ S1901Income2022$Pct0to10k)
summary(AggAssault.Pct0to10.lm)

PocketPicking.Pct200up.lm <- lm(formula = Crime2022_tnfd$PocketPicking ~ S1901Income2022$Pct200korMore...22)
summary(PocketPicking.Pct200up.lm)

Swindles.Pct200up.lm <- lm(formula = Crime2022_tnfd$SwindleConGame ~ S1901Income2022$Pct200korMore...22)
summary(Swindles.Pct200up.lm)

Impersonation.Pct200up.lm <- lm(formula = Crime2022_tnfd$Impersonation ~ S1901Income2022$Pct200korMore...22)
summary(Impersonation.Pct200up.lm)

Robbery.Pct0to10.lm <- lm(formula = Crime2022_tnfd$Robbery ~ S1901Income2022$Pct0to10k)
summary(Robbery.Pct0to10.lm)

Robbery.Pct200up.lm <- lm(formula = Crime2022_tnfd$Robbery ~ S1901Income2022$Pct200korMore...22)
summary(Robbery.Pct200up.lm)

RobberyBOTH.lm <- lm(formula = Crime2022_tnfd$Robbery ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct200korMore...22)
summary(RobberyBOTH.lm)

Murder.Pct0to10k.lm <- lm(formula = Crime2022$MurderNonNegManslaughter ~ S1901Income2022$Pct0to10k)
summary(Murder.Pct0to10k.lm)
par(mfrow=c(2,2))
plot(Murder.Pct0to10k.lm)
par(mfrow=c(1,1))

Burglary.highlow.lm <- lm(formula = Crime2022$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct200korMore...22)
summary(Burglary.highlow.lm)

Burglary.4vars.lm <- lm(formula = Crime2022$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct200korMore...22)
summary(Burglary.4vars.lm)

par(mfrow=c(2,2))
plot(Burglary.Pct0to10k.lm)
par(mfrow=c(1,1))

par(mfrow=c(2,2))
plot(Burglary.highlow.lm)
par(mfrow=c(1,1))

Burglary.graph.pct0to10 <- ggplot(IC2022cs , aes(x=Pct0to10k , y=BurglaryBreakingEntering)) +
  geom_point() +
  geom_smooth(method = "lm" , col = "black") +
  stat_regline_equation() +
  labs(title = "Reporting Burglary/B&E rate as a function of % of households 0 to 10k" ,
       x = "Income percent in $0 to $10k" , 
       y = "Rate of burglary/breaking and entering")
Burglary.graph.pct0to10

Burglary.graph.pct200ormore <- ggplot(IC2022cs , aes(x=Pct200korMore...22 , y=BurglaryBreakingEntering)) +
  geom_point() +
  geom_smooth(method = "lm" , col = "black") +
  stat_regline_equation() +
  labs(title = "Reporting Burglary/B&E rate as a function of % of households 0 to 10k" ,
       x = "Income percent $200k or more" , 
       y = "Rate of burglary/breaking and entering")
Burglary.graph.pct200ormore

Burglary.highlow.graph <- expand.grid(
  Pct0to10k = seq(IC2022cs$Pct0to10k),
  Pct200korMore...22 = c(IC2022cs$Pct200korMore...22)
)
Burglary.highlow.graph$predicted.y <- predict.lm(Burglary.highlow.lm , newdata = Burglary.highlow.graph)
Burglary.highlow.graph$Pct200korMore...22 <- round(Burglary.highlow.graph$Pct200korMore...22 , digits = 2)
Burglary.highlow.graph$Pct200korMore...22 <- as.factor(Burglary.highlow.graph$Pct200korMore...22)
mult.plot <- ggplot(IC2022cs , aes(x = Pct0to10k , y = BurglaryBreakingEntering)) +
  geom_point()
mult.plot

mult.plot <- mult.plot +
  coord_cartesian(xlim = c(0, 1), ylim = c(0, 1)) +
  geom_line(data = Burglary.highlow.graph , aes(x = Pct0to10k , y = predicted.y))

mult.plot

```

```{r}

#Reduce confounding variables to length of crime dataset

#Reduce Crime2022_tnfd and ConfVarData1 to its common observations

ConfVarData1 <- read_xlsx("/Users/steve/OneDrive/Desktop/Inequality_data/ConfVarData1.xlsx")
ConfVarData1$FIPS = formatC(ConfVarData1$FIPS, digits = 4, format = "d", flag = "0")

ConfVarData1_1 <- c("ConfVarData1" , "Crime2022")
ConfVarData1_2 <- setNames(
  lapply(ConfVarData1_1 , get),
  ConfVarData1_1
)

ConfVarData1_commonfips <- Reduce(
  intersect,
  lapply(ConfVarData1_2, \(x) x$FIPS)
)

ConfVarData1_final <- lapply(ConfVarData1_2, function(x) x[x$FIPS %in% ConfVarData1_commonfips, ])

ConfVarData <- ConfVarData1_final[["ConfVarData1"]]

ConfVarData <- ConfVarData|>
  select(FIPS, HealthInsRate, NOHealthInsRate, Malesper100Females, MedianAge, LaborForceParticipation16up, EmpRate16up, PctWhite, PctBlack, PctHispanic, PctNOHighSch25to64, PctHighSch25to64, PctSomeCollege25to64, PctCollegeMore25to64)

save(ConfVarData , file = "/Users/steve/OneDrive/Desktop/DataMaster/ConfVarData.Rda")

```

``` {r}
#multiple linear regression, 2022
CRIMETYPE.lm <- lm(formula = Crime2022_tnfd$CRIMETYPE ~ S1901Income2022$INCOMEBRACKET + CONFOUNDING VARIABLE)
summary(CRIMETPYE.lm)

Burglary_MedianAge.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + ConfVarData$MedianAge)
summary(Burglary_MedianAge.lm)

BurglaryUnemp.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ ConfVarData$Unemp16up)
summary(BurglaryUnemp.lm)

AggAssaultUnemp.lm <- lm(formula = Crime2022_tnfd$AggAssault ~ ConfVarData$Unemp16up)
summary(AggAssaultUnemp.lm)

TheftfromVehicleUnemp.lm <- lm(formula = Crime2022_tnfd$TheftFromVehicle ~ ConfVarData$Unemp16up)
summary(TheftfromVehicleUnemp.lm)

TheftfromVehicleMedianAge.lm <- lm(formula = Crime2022_tnfd$TheftFromVehicle ~ ConfVarData$MedianAge)
summary(TheftfromVehicleMedianAge.lm)

Burglary.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k)
summary(Burglary.lm)

Burglary1.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + ConfVarData$Unemp16up)
summary(Burglary1.lm)

Burglary2.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + ConfVarData$Unemp16up + ConfVarData$MedianAge)
summary(Burglary2.lm)

Burglary3.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + ConfVarData$Unemp16up + ConfVarData$MedianAge + ConfVarData$Malesper100Females)
summary(Burglary3.lm)

Burglary4.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + ConfVarData$Unemp16up + ConfVarData$MedianAge + ConfVarData$Malesper100Females + ConfVarData$PctWhite)
summary(Burglary4.lm)

Burglarywhite.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ ConfVarData$PctWhite)
summary(Burglarywhite.lm)

Burglaryblack.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ ConfVarData$PctBlack)
summary(Burglaryblack.lm)

Burglaryhispanic.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ ConfVarData$PctHispanic)
summary(Burglaryhispanic.lm)

Burglaryblack1.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ ConfVarData$PctBlack)
summary(Burglaryblack1.lm)

Burglarywhite1.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ ConfVarData$PctWhite)
summary(Burglarywhite1.lm)

Burglarysex.lm <- lm(formula = Crime2022_tnfd$BurglaryBreakingEntering ~ ConfVarData$Malesper100Females)
summary(Burglarysex.lm)
```

```{r}
#Transform crime data: multiple percentages by 100, then correlate with income data
Crime2022_tnfd <- Crime2022 |>  
  transform(TotIncidents, TotIncidents = TotIncidents * 100) |>
  transform(TotCrimeCount, TotCrimeCount = TotCrimeCount * 100) |>
  transform(MurderNonNegManslaughter, MurderNonNegManslaughter = MurderNonNegManslaughter * 100) |>
  transform(NegManslaughter , NegManslaughter = NegManslaughter * 100) |>
  transform(JustifiableHomicide , JustifiableHomicide = JustifiableHomicide * 100) |>
  transform(Kidnaping_Abduction , Kidnaping_Abduction = Kidnaping_Abduction * 100) |>
  transform(Rape , Rape = Rape * 100) |>
  transform(Sodomy , Sodomy = Sodomy * 100) |>
  transform(SexAssaultObject , SexAssaultObject = SexAssaultObject * 100) |>
  transform(Fondling_ChildMolest , Fondling_ChildMolest = Fondling_ChildMolest * 100) |>
  transform(Robbery , Robbery = Robbery * 100) |>
  transform(AggAssault , AggAssault = AggAssault * 100) |>
  transform(TotSimpleAssaults , TotSimpleAssaults = TotSimpleAssaults * 100) |>
  transform(Intimidation , Intimidation = Intimidation * 100) |>
  transform(BurglaryBreakingEntering , BurglaryBreakingEntering = BurglaryBreakingEntering * 100) |>
  transform(PocketPicking , PocketPicking = PocketPicking * 100) |>
  transform(PurseSnatching , PurseSnatching = PurseSnatching * 100) |>
  transform(Shoplifting , Shoplifting = Shoplifting * 100) |>
  transform(TheftFromBuilding , TheftFromBuilding = TheftFromBuilding * 100) |>
  transform(TheftMachineDevice , TheftMachineDevice = TheftMachineDevice * 100) |>
  transform(TheftFromVehicle , TheftFromVehicle = TheftFromVehicle * 100) |>
  transform(TheftOfVehicleOrParts , TheftOfVehicleOrParts = TheftOfVehicleOrParts * 100) |>
  transform(AllOtherLarceny , AllOtherLarceny = AllOtherLarceny * 100) |>
  transform(VehicleTheft , VehicleTheft = VehicleTheft * 100) |>
  transform(CounterfeitingForgery , CounterfeitingForgery = CounterfeitingForgery * 100) |>
  transform(SwindleConGame , SwindleConGame = SwindleConGame * 100) |>
  transform(CC_ATMFraud , CC_ATMFraud = CC_ATMFraud * 100) |>
  transform(Impersonation , Impersonation = Impersonation * 100) |>
  transform(WelfareFraud , WelfareFraud = WelfareFraud * 100) |>
  transform(IdentityTheft , IdentityTheft = IdentityTheft * 100) |>
  transform(HackingComputerInvasion , HackingComputerInvasion = HackingComputerInvasion * 100) |>
  transform(Embezzlement , Embezzlement = Embezzlement * 100) |>
  transform(StolenPropertyOffenses , StolenPropertyOffenses = StolenPropertyOffenses * 100) |>
  transform(DamageVandalismOfProperty , DamageVandalismOfProperty = DamageVandalismOfProperty * 100) |>
  transform(DrugViolations , DrugViolations = DrugViolations * 100) |>
  transform(DrugEquipmentViolations , DrugEquipmentViolations = DrugEquipmentViolations * 100) |>
  transform(Prostitution , Prostitution = Prostitution * 100) |>
  transform(AssistPromoteProstitution , AssistPromoteProstitution = AssistPromoteProstitution * 100) |>
  transform(PurchaseProstitution , PurchaseProstitution = PurchaseProstitution * 100)

save(Crime2022_tnfd, file = ("/Users/steve/OneDrive/Desktop/DataMaster/Crime2022_tnfd.Rda"))
```

``` {r}
#Multiple regression, burglary, 2022
burglary_intercept_model = lm(BurglaryBreakingEntering ~ 1 , data = Crime2022_tnfd)

#Stepwise Bayesian regression for burglary and all income brackets in 2022

burglary_income_model = lm(Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(burglary_intercept_model , direction = 'forward' , scope = formula(burglary_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

burglary_income_bestfit <-lm(formula = BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + 
    S1901Income2022$Pct15kto24999...8, data = Crime2022_tnfd)
summary(burglary_income_bestfit)

#Stepwise Bayesian regression for burglary in 2022

burglary_full_model = lm(Crime2022_tnfd$BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct15kto24999...8 + ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(burglary_intercept_model , direction = 'forward' , scope = formula(burglary_full_model) , trace = 0 , k = log(nrow(ConfVarData)))

burglary_bestfit <- lm(formula = BurglaryBreakingEntering ~ ConfVarData$PctWhite + 
    S1901Income2022$Pct15kto24999...8 + ConfVarData$Malesper100Females + 
    ConfVarData$MedianAge, data = Crime2022_tnfd)
summary(burglary_bestfit)

#Stepwise Akaike regression for burglary and all income brackets in 2022

step(burglary_intercept_model , direction = 'forward' , scope = formula(burglary_income_model) , trace = 1 , k = 2)

burglary_income_bestfit_AIC <- lm(formula = BurglaryBreakingEntering ~ S1901Income2022$Pct0to10k + 
    S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct100kto149999 + 
    S1901Income2022$Pct75kto99999 + S1901Income2022$Pct10kto14999, 
    data = Crime2022_tnfd)
summary(burglary_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(burglary_intercept_model , direction = 'forward' , scope = formula(burglary_full_model) , trace = 0 , k = 2)

burglary_bestfit_AIC <- lm(formula = BurglaryBreakingEntering ~ ConfVarData$PctWhite + 
    S1901Income2022$Pct0to10k + 
    S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct100kto149999 + 
    S1901Income2022$Pct75kto99999 + S1901Income2022$Pct10kto14999 + ConfVarData$Malesper100Females + 
    ConfVarData$MedianAge + ConfVarData$PctSomeCollege25to64 + 
    ConfVarData$LaborForceParticipation16up + ConfVarData$PctNOHighSch25to64 + 
    ConfVarData$PctHispanic + ConfVarData$PctBlack, data = Crime2022_tnfd)
summary(burglary_bestfit_AIC)
```

```{r}
#Multiple regression, prostitution, 2022
prostitution_intercept_model = lm(Prostitution ~ 1 , data = Crime2022_tnfd)

#Stepwise Bayesian regression for prostitution and all income brackets in 2022

prostitution_income_model = lm(Crime2022_tnfd$Prostitution ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(prostitution_intercept_model , direction = 'forward' , scope = formula(prostitution_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

prostitution_income_bestfit <-lm(formula = Prostitution ~ S1901Income2022$Pct0to10k + 
    S1901Income2022$Pct15kto24999...8, data = Crime2022_tnfd)
summary(prostitution_income_bestfit)

#Stepwise regression for prostitution in 2022

prostitution_full_model = lm(Crime2022_tnfd$Prostitution ~ S1901Income2022$Pct200korMore...22 + ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(prostitution_intercept_model , direction = 'forward' , scope = formula(prostitution_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

prostitution_bestfit <- lm(formula = Crime2022_tnfd$Prostitution ~ ConfVarData$PctWhite)
summary(prostitution_bestfit)

#Stepwise Akaike regression for prostitution and all income brackets in 2022

step(prostitution_intercept_model , direction = 'forward' , scope = formula(prostitution_income_model) , trace = 1 , k = 2)

prostitution_income_bestfit_AIC <- lm(formula = Prostitution ~ S1901Income2022$Pct35kto49999, data = Crime2022_tnfd)
summary(prostitution_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(prostitution_intercept_model , direction = 'forward' , scope = formula(prostitution_full_model) , trace = 0 , k = 2)

prostitution_bestfit_AIC <- lm(formula = Prostitution ~ S1901Income2022$Pct35kto49999 + ConfVarData$PctWhite + ConfVarData$EmpRate16up + 
    ConfVarData$PctSomeCollege25to64, data = Crime2022_tnfd)
summary(prostitution_bestfit_AIC)
```

```{r}
#Multiple regression, hacking/computer invasion, 2022
hacking_intercept_model = lm(HackingComputerInvasion ~ 1 , data = Crime2022_tnfd)

#Stepwise Bayesian regression for hacking and all income brackets in 2022

hacking_income_model = lm(Crime2022_tnfd$HackingComputerInvasion ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(hacking_intercept_model , direction = 'forward' , scope = formula(hacking_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

hacking_income_bestfit <-lm(formula = Crime2022_tnfd$HackingComputerInvasion ~ S1901Income2022$Pct200korMore...22)
summary(hacking_income_bestfit)

#Stepwise Bayesian regression for hacking in 2022

hacking_full_model = lm(Crime2022_tnfd$HackingComputerInvasion ~ S1901Income2022$Pct200korMore...22 + ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(hacking_intercept_model , direction = 'forward' , scope = formula(hacking_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

hacking_bestfit <- lm(formula = Crime2022_tnfd$HackingComputerInvasion ~ S1901Income2022$Pct200korMore...22)
summary(hacking_bestfit)

#Stepwise Akaike regression for hacking and all income brackets in 2022

step(hacking_intercept_model , direction = 'forward' , scope = formula(hacking_income_model) , trace = 1 , k = 2)

hacking_income_bestfit_AIC <- lm(formula = HackingComputerInvasion ~ S1901Income2022$Pct200korMore...22 + 
    S1901Income2022$Pct100kto149999 + S1901Income2022$Pct75kto99999, 
    data = Crime2022_tnfd)
summary(hacking_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(hacking_intercept_model , direction = 'forward' , scope = formula(hacking_full_model) , trace = 0 , k = 2)

hacking_bestfit_AIC <- lm(formula = HackingComputerInvasion ~ S1901Income2022$Pct200korMore...22 + 
    S1901Income2022$Pct100kto149999 + S1901Income2022$Pct75kto99999 + 
    ConfVarData$Malesper100Females + ConfVarData$PctCollegeMore25to64, 
    data = Crime2022_tnfd)
summary(hacking_bestfit_AIC)
```

```{r}
#Multiple regression, assisting prostitution, 2022
assistprostitution_intercept_model = lm(AssistPromoteProstitution ~ 1 , data = Crime2022_tnfd)

#Stepwise Bayesian regression for assiting prostitution and all income brackets in 2022

assistprostitution_income_model = lm(Crime2022_tnfd$AssistPromoteProstitution ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(assistprostitution_intercept_model , direction = 'forward' , scope = formula(assistprostitution_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

assistprostitution_income_bestfit <- lm(formula = AssistPromoteProstitution ~ 1, data = Crime2022_tnfd)
summary(assistprostitution_income_bestfit)

#Stepwise Bayesian regression for assisting prostitution in 2022

assistprostitution_full_model = lm(Crime2022_tnfd$AssistPromoteProstitution ~ ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(assistprostitution_intercept_model , direction = 'forward' , scope = formula(assistprostitution_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

assistprostitution_bestfit <- lm(formula = AssistPromoteProstitution ~ ConfVarData$LaborForceParticipation16up +  ConfVarData$EmpRate16up, data = Crime2022_tnfd)
summary(assistprostitution_bestfit)

#Stepwise Akaike regression for assisting prostitution and all income brackets in 2022

step(assistprostitution_intercept_model , direction = 'forward' , scope = formula(assistprostitution_income_model) , trace = 1 , k = 2)

assistprostitution_income_bestfit_AIC <- lm(formula = AssistPromoteProstitution ~ S1901Income2022$Pct100kto149999, 
    data = Crime2022_tnfd)
summary(assistprostitution_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(assistprostitution_intercept_model , direction = 'forward' , scope = formula(assistprostitution_full_model) , trace = 0 , k = 2)

assistprostitution_bestfit_AIC <- lm(formula = AssistPromoteProstitution ~ S1901Income2022$Pct100kto149999 + ConfVarData$LaborForceParticipation16up + 
    ConfVarData$EmpRate16up, data = Crime2022_tnfd)
summary(assistprostitution_bestfit_AIC)
```

```{r}
#Multiple regression, thefts from vehicles, 2022
theftfromvehicle_intercept_model = lm(TheftFromVehicle ~ 1 , data = Crime2022_tnfd)

#Stepwise Bayesian regression for theft from vehicle and all income brackets in 2022

theftfromvehicle_income_model = lm(Crime2022_tnfd$TheftFromVehicle ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(theftfromvehicle_intercept_model , direction = 'forward' , scope = formula(theftfromvehicle_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

theftfromvehicle_income_bestfit <- lm(formula = TheftFromVehicle ~ S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999, data = Crime2022_tnfd)
summary(theftfromvehicle_income_bestfit)

#Stepwise regression for theft from vehicle in 2022

theftfromvehicle_full_model = lm(Crime2022_tnfd$TheftFromVehicle ~ S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(theftfromvehicle_intercept_model , direction = 'forward' , scope = formula(theftfromvehicle_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

theftfromvehicle_bestfit <- lm(formula = TheftFromVehicle ~ S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + ConfVarData$PctWhite + ConfVarData$PctCollegeMore25to64 + 
    ConfVarData$MedianAge + 
    ConfVarData$Malesper100Females + ConfVarData$PctHispanic, 
    data = Crime2022_tnfd)
summary(theftfromvehicle_bestfit)

#Stepwise Akaike regression for theft from vehicle and all income brackets in 2022

step(theftfromvehicle_intercept_model , direction = 'forward' , scope = formula(theftfromvehicle_income_model) , trace = 1 , k = 2)

theftfromvehicle_income_bestfit_AIC <- lm(formula = TheftFromVehicle ~ S1901Income2022$Pct200korMore...22 + 
    S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + 
    S1901Income2022$Pct75kto99999, data = Crime2022_tnfd)
summary(theftfromvehicle_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(theftfromvehicle_intercept_model , direction = 'forward' , scope = formula(theftfromvehicle_full_model) , trace = 0 , k = 2)

theftfromvehicle_bestfit_AIC <- lm(formula = TheftFromVehicle ~ S1901Income2022$Pct200korMore...22 + 
    S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + 
    S1901Income2022$Pct75kto99999 + ConfVarData$PctWhite + ConfVarData$PctCollegeMore25to64 + 
    ConfVarData$MedianAge + 
    ConfVarData$Malesper100Females + ConfVarData$PctHispanic + 
    ConfVarData$PctBlack + ConfVarData$PctSomeCollege25to64, 
    data = Crime2022_tnfd)
summary(theftfromvehicle_bestfit_AIC)
```

```{r}
#Multiple regression, vehicle thefts, 2022
vehicletheft_intercept_model = lm(VehicleTheft ~ 1 , data = Crime2022_tnfd)

#Stepwise Bayesian regression for vehicle theft and all income brackets in 2022

vehicletheft_income_model = lm(Crime2022_tnfd$VehicleTheft ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(vehicletheft_intercept_model , direction = 'forward' , scope = formula(vehicletheft_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

vehicletheft_income_bestfit <- lm(formula = VehicleTheft ~ S1901Income2022$Pct75kto99999 + S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k, data = Crime2022_tnfd)
summary(vehicletheft_income_bestfit)

#Stepwise regression for vehicle theft in 2022

vehicletheft_full_model = lm(Crime2022_tnfd$VehicleTheft ~ S1901Income2022$Pct75kto99999 + S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k + ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(vehicletheft_intercept_model , direction = 'forward' , scope = formula(vehicletheft_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

vehicletheft_bestfit <- lm(formula = VehicleTheft ~ S1901Income2022$Pct75kto99999 + S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k + ConfVarData$PctWhite + ConfVarData$MedianAge +  ConfVarData$PctHighSch25to64 + ConfVarData$Malesper100Females, data = Crime2022_tnfd)
summary(vehicletheft_bestfit)

#Stepwise Akaike regression for vehicle theft and all income brackets in 2022

step(vehicletheft_intercept_model , direction = 'forward' , scope = formula(vehicletheft_income_model) , trace = 1 , k = 2)

vehicletheft_income_bestfit_AIC <- lm(formula = VehicleTheft ~ S1901Income2022$Pct75kto99999 + S1901Income2022$Pct200korMore...22 + 
    S1901Income2022$Pct0to10k, data = Crime2022_tnfd)
summary(vehicletheft_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(vehicletheft_intercept_model , direction = 'forward' , scope = formula(vehicletheft_full_model) , trace = 0 , k = 2)

vehicletheft_bestfit_AIC <- lm(formula = VehicleTheft ~ S1901Income2022$Pct75kto99999 + S1901Income2022$Pct200korMore...22 + 
    S1901Income2022$Pct0to10k + ConfVarData$PctWhite + ConfVarData$MedianAge + 
    ConfVarData$PctHighSch25to64 + ConfVarData$Malesper100Females + 
    S1901Income2022$Pct75kto99999 + ConfVarData$PctHispanic + 
    S1901Income2022$Pct200korMore...22 + ConfVarData$PctCollegeMore25to64, 
    data = Crime2022_tnfd)
summary(vehicletheft_bestfit_AIC)
```

```{r}
#Multiple regression, aggravated assault, 2022
aggassault_intercept_model = lm(AggAssault ~ 1 , data = Crime2022_tnfd)

#Stepwise Beyesian regression for agg assault and all income brackets in 2022

aggassault_income_model = lm(Crime2022_tnfd$AggAssault ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(aggassault_intercept_model , direction = 'forward' , scope = formula(aggassault_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

aggassault_income_bestfit <- lm(formula = AggAssault ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct100kto149999, data = Crime2022_tnfd)
summary(aggassault_income_bestfit)

#Stepwise Bayesian regression for agg assault in 2022

aggassault_full_model = lm(Crime2022_tnfd$AggAssault ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct100kto149999 + ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(aggassault_intercept_model , direction = 'forward' , scope = formula(aggassault_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

aggassault_bestfit <- lm(formula = AggAssault ~ S1901Income2022$Pct0to10k + ConfVarData$PctBlack + S1901Income2022$Pct100kto149999 + 
    ConfVarData$PctHispanic + ConfVarData$PctSomeCollege25to64 + 
    ConfVarData$MedianAge, data = Crime2022_tnfd)
summary(aggassault_bestfit)

#Stepwise Akaike regression for agg assault and all income brackets in 2022

step(aggassault_intercept_model , direction = 'forward' , scope = formula(aggassault_income_model) , trace = 1 , k = 2)

aggassault_income_bestfit_AIC <- lm(formula = AggAssault ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct100kto149999 + 
    S1901Income2022$Pct75kto99999, data = Crime2022_tnfd)
summary(aggassault_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(aggassault_intercept_model , direction = 'forward' , scope = formula(aggassault_full_model) , trace = 0 , k = 2)

aggassault_bestfit_AIC <- lm(formula = AggAssault ~ ConfVarData$PctBlack + S1901Income2022$Pct0to10k + S1901Income2022$Pct100kto149999 + 
    S1901Income2022$Pct75kto99999 + 
    ConfVarData$PctHispanic + ConfVarData$PctSomeCollege25to64 + 
    ConfVarData$MedianAge + ConfVarData$Malesper100Females, data = Crime2022_tnfd)
summary(aggassault_bestfit_AIC)
```

```{r}
#Multiple regression, pocket picking, 2022
pocketpicking_intercept_model = lm(PocketPicking ~ 1 , data = Crime2022_tnfd)

#Stepwise Bayesian regression for pocket picking and all income brackets in 2022

pocketpicking_income_model = lm(Crime2022_tnfd$PocketPicking ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(pocketpicking_intercept_model , direction = 'forward' , scope = formula(pocketpicking_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

pocketpicking_income_bestfit <- lm(formula = PocketPicking ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct100kto149999, data = Crime2022_tnfd)
summary(pocketpicking_income_bestfit)

#Stepwise Bayesian regression for pocket picking in 2022

pocketpicking_full_model = lm(Crime2022_tnfd$PocketPicking ~ ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(pocketpicking_intercept_model , direction = 'forward' , scope = formula(pocketpicking_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

pocketpicking_bestfit <- lm(formula = PocketPicking ~ ConfVarData$PctHispanic , data = Crime2022_tnfd)
summary(pocketpicking_bestfit)

#Stepwise Akaike regression for pocket picking and all income brackets in 2022

step(pocketpicking_intercept_model , direction = 'forward' , scope = formula(pocketpicking_income_model) , trace = 1 , k = 2)

pocketpicking_income_bestfit_AIC <- lm(formula = PocketPicking ~ 1, data = Crime2022_tnfd)
summary(pocketpicking_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(pocketpicking_intercept_model , direction = 'forward' , scope = formula(pocketpicking_full_model) , trace = 0 , k = 2)

pocketpicking_bestfit_AIC <- lm(formula = PocketPicking ~ ConfVarData$PctHispanic + ConfVarData$Malesper100Females + 
    ConfVarData$EmpRate16up + ConfVarData$PctBlack, data = Crime2022_tnfd)
summary(pocketpicking_bestfit_AIC)
```

```{r}
#Multiple regression, swindle, 2022
swindle_intercept_model = lm(SwindleConGame ~ 1 , data = Crime2022_tnfd)

#Stepwise Beyesian regression for swindle and all income brackets in 2022

swindle_income_model = lm(Crime2022_tnfd$SwindleConGame ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(swindle_intercept_model , direction = 'forward' , scope = formula(swindle_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

swindle_income_bestfit <- lm(formula = SwindleConGame ~ S1901Income2022$Pct10kto14999 + 
    S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k, 
    data = Crime2022_tnfd)
summary(swindle_income_bestfit)

#Stepwise Bayesian regression for swindle in 2022

swindle_full_model = lm(Crime2022_tnfd$SwindleConGame ~ S1901Income2022$Pct10kto14999 + 
    S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k + ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(swindle_intercept_model , direction = 'forward' , scope = formula(swindle_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

swindle_bestfit <- lm(formula = SwindleConGame ~ ConfVarData$PctHighSch25to64 + 
    ConfVarData$PctBlack + S1901Income2022$Pct10kto14999 + ConfVarData$Malesper100Females +
    ConfVarData$MedianAge, data = Crime2022_tnfd)
summary(swindle_bestfit)

#Stepwise Akaike regression for swindle and all income brackets in 2022

step(swindle_intercept_model , direction = 'forward' , scope = formula(swindle_income_model) , trace = 1 , k = 2)

swindle_income_bestfit_AIC <- lm(formula = SwindleConGame ~ S1901Income2022$Pct10kto14999 + 
    S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k, 
    data = Crime2022_tnfd)
summary(swindle_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(swindle_intercept_model , direction = 'forward' , scope = formula(swindle_full_model) , trace = 0 , k = 2)

swindle_bestfit_AIC <- lm(formula = SwindleConGame ~ ConfVarData$PctHighSch25to64 + 
    ConfVarData$PctBlack + S1901Income2022$Pct10kto14999 + 
    S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k + ConfVarData$Malesper100Females + 
    ConfVarData$MedianAge + 
    ConfVarData$PctWhite + ConfVarData$PctCollegeMore25to64, 
    data = Crime2022_tnfd)
summary(swindle_bestfit_AIC)
```

```{r}
#Multiple regression, impersonation, 2022
impersonation_intercept_model = lm(Impersonation ~ 1 , data = Crime2022_tnfd)

#Stepwise Bayesian regression for impersonation and all income brackets in 2022

impersonation_income_model = lm(Crime2022_tnfd$Impersonation ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(impersonation_intercept_model , direction = 'forward' , scope = formula(impersonation_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

impersonation_income_bestfit <- lm(formula = Impersonation ~ S1901Income2022$Pct200korMore...22, 
    data = Crime2022_tnfd)
summary(impersonation_income_bestfit)

#Stepwise regression for impersonation in 2022

impersonation_full_model = lm(Crime2022_tnfd$Impersonation ~ S1901Income2022$Pct200korMore...22 + ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(impersonation_intercept_model , direction = 'forward' , scope = formula(impersonation_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

impersonation_bestfit <- lm(formula = Impersonation ~ S1901Income2022$Pct200korMore...22 + 
    ConfVarData$PctWhite, data = Crime2022_tnfd)
summary(impersonation_bestfit)

#Stepwise Akaike regression for impersonation and all income brackets in 2022

step(impersonation_intercept_model , direction = 'forward' , scope = formula(impersonation_income_model) , trace = 1 , k = 2)

impersonation_income_bestfit_AIC <- lm(formula = Impersonation ~ S1901Income2022$Pct200korMore...22 + 
    S1901Income2022$Pct10kto14999 + S1901Income2022$Pct50kto74999, 
    data = Crime2022_tnfd)
summary(impersonation_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(impersonation_intercept_model , direction = 'forward' , scope = formula(impersonation_full_model) , trace = 0 , k = 2)

impersonation_bestfit_AIC <- lm(formula = Impersonation ~ S1901Income2022$Pct200korMore...22 + 
    S1901Income2022$Pct10kto14999 + S1901Income2022$Pct50kto74999 + 
    ConfVarData$PctWhite, data = Crime2022_tnfd)
summary(impersonation_bestfit_AIC)
```

```{r}
#Multiple regression, robbery, 2022
robbery_intercept_model = lm(Robbery ~ 1 , data = Crime2022_tnfd)

#Stepwise Beyesian regression for robbery and all income brackets in 2022

robbery_income_model = lm(Crime2022_tnfd$Robbery ~ S1901Income2022$Pct0to10k + S1901Income2022$Pct10kto14999 + S1901Income2022$Pct15kto24999...8 + S1901Income2022$Pct25kto34999 + S1901Income2022$Pct35kto49999 + S1901Income2022$Pct50kto74999 + S1901Income2022$Pct75kto99999 + S1901Income2022$Pct100kto149999 + S1901Income2022$Pct150kto199999 + S1901Income2022$Pct200korMore...22)

step(robbery_intercept_model , direction = 'forward' , scope = formula(robbery_income_model) , trace = 1 , k = log(nrow(S1901Income2022)))

robbery_income_bestfit <- lm(formula = Robbery ~ S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k, 
    data = Crime2022_tnfd)
summary(robbery_income_bestfit)

#Stepwise Bayesian regression for robbery in 2022

robbery_full_model = lm(Crime2022_tnfd$Robbery ~ S1901Income2022$Pct200korMore...22 + + S1901Income2022$Pct0to10k + ConfVarData$Malesper100Females + ConfVarData$MedianAge + ConfVarData$LaborForceParticipation16up + ConfVarData$PctWhite + ConfVarData$PctBlack + ConfVarData$PctHispanic + ConfVarData$PctNOHighSch25to64 + ConfVarData$PctHighSch25to64 + ConfVarData$PctSomeCollege25to64 + ConfVarData$PctCollegeMore25to64 + ConfVarData$EmpRate16up)

step(robbery_intercept_model , direction = 'forward' , scope = formula(robbery_full_model) , trace = 1 , k = log(nrow(ConfVarData)))

robbery_bestfit <- lm(formula = Robbery ~ ConfVarData$PctWhite + ConfVarData$PctCollegeMore25to64 + 
    ConfVarData$PctBlack + ConfVarData$Malesper100Females + ConfVarData$PctHispanic + 
    ConfVarData$MedianAge, data = Crime2022_tnfd)
summary(robbery_bestfit)

#Stepwise Akaike regression for robbery and all income brackets in 2022

step(robbery_intercept_model , direction = 'forward' , scope = formula(robbery_income_model) , trace = 1 , k = 2)

robbery_income_bestfit_AIC <- lm(formula = Robbery ~ S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k + 
    S1901Income2022$Pct150kto199999 + S1901Income2022$Pct35kto49999, 
    data = Crime2022_tnfd)
summary(robbery_income_bestfit_AIC)

#Stepwise Akaike regression in 2022

step(robbery_intercept_model , direction = 'forward' , scope = formula(robbery_full_model) , trace = 0 , k = 2)

robbery_bestfit_AIC <- lm(formula = Robbery ~ ConfVarData$PctWhite + ConfVarData$PctCollegeMore25to64 + 
    ConfVarData$PctBlack + ConfVarData$Malesper100Females + ConfVarData$PctHispanic + 
    ConfVarData$MedianAge + S1901Income2022$Pct200korMore...22 + S1901Income2022$Pct0to10k + 
    S1901Income2022$Pct150kto199999 + S1901Income2022$Pct35kto49999, 
    data = Crime2022_tnfd)
summary(robbery_bestfit_AIC)
```

---
title: "CrimeStudy2"
author: "Steven R. Morrison"
date: "2024-06-17"
output: html_document
---

```{r message=FALSE, warning=FALSE}
#Load packages
library(readxl)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(readr)
library(dplyr)
library(changepoint)
library(ggthemes)
library(stringr)
library(tibble)
library(correlation)
library(corrplot)
library(rcompanion)
library(GGally)
library(listviewer)
library(Hmisc)
library(corrr)
library(rstatix)
library(psych)
library(rempsyc)
library(writexl)
library(ggpubr)
library(broom)
```

```{r message=FALSE, warning=FALSE}
load("/Users/steve/OneDrive/Desktop/DataMaster/Crime2018.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/Crime2019.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/Crime2020.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/Crime2021.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/Crime2022.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/Gini.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2018.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2019.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2020.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2021.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/S1901Income2022.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2018.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2019.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2020.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2021.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/S1903Income2022.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2018.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2019.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2020.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2021.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/CrimeRace2022.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/IC2022cp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2022ck.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2022cs.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2022pp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2022pk.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2022ps.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/IC2021cp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2021ck.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2021cs.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2021pp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2021pk.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2021ps.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/IC2020cp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2020ck.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2020cs.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2020pp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2020pk.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2020ps.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/IC2019cp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2019ck.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2019cs.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2019pp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2019pk.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2019ps.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/IC2018cp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2018ck.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2018cs.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2018pp.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2018pk.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/IC2018ps.Rda")

load("/Users/steve/OneDrive/Desktop/DataMaster/ConfVarData.Rda")
load("/Users/steve/OneDrive/Desktop/DataMaster/Crime2022_tnfd.Rda")
```
